var N=Object.defineProperty;var y=(o,e,a)=>e in o?N(o,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):o[e]=a;var c=(o,e,a)=>(y(o,typeof e!="symbol"?e+"":e,a),a);import{d as B,k as L,N as $,f as I,G as f,R as w,H as P,W as b,v as U,r as t,o as h,c as S,a as s,j as T,u as V,e as r,g as m,i as p,p as H,b as R,_ as G}from"./index-406f6e18.js";import{C as W,E as n}from"./CEditItem-1a5972f4.js";import{C as A}from"./CLink-fd847659.js";import{U as M}from"./UserObj-2b6b3ba9.js";import{N as u}from"./NaiveUtils-bbfa690f.js";import{C as O}from"./CHead-4a70f31d.js";import"./Input-e62e8d1c.js";import"./TripObj-0083e4c4.js";class q{constructor(e){c(this,"email","");c(this,"password","");e&&(this.email=e.email!==void 0&&e.email!==null?e.email:"",this.password=e.password!==void 0&&e.password!==null?e.password:"")}toJsonKey(e){switch(e){case"email":return"email";case"password":return"password";default:return e}}}const x=B({components:{CEditItem:W,CLink:A,NAlert:L,NButton:$,CHead:O},data(){return{loading:!1,showError:!1,resetLink:I.password_Reset,loadingBar:f.loadingBar()}},beforeMount(){w.hasNext()&&(this.$data.showError=!0),u.init()},mounted(){n.get(n.get(this,"email"),"input").focus()},methods:{async confirm(){var i,l,d;this.$data.loading=!0,(i=this.$data.loadingBar)==null||i.start();const o=new q({email:n.getVal(this,"email"),password:n.getVal(this,"password")}),e=await P.genPOST("login",b.stringify(o));if(new M(e).ID===-1){(l=this.$data.loadingBar)==null||l.error(),this.$data.loading=!1,u.messageError("Wrong email or password. Please try again.");return}await f.genCurrentUser(),(d=this.$data.loadingBar)==null||d.finish(),this.$data.loading=!1,u.messageSuccess("You are now logged in."),await w.paramToNext(new Map,!0)},cancel(){U.back()}}}),C=o=>(H("data-v-2195b5d3"),o=o(),R(),o),D={class:"login narrow_content"},F=C(()=>r("h1",{class:"title"},"Login",-1)),J={class:"narrow_display_window"},K=C(()=>r("br",null,null,-1)),Y={class:"forgotPassword"};function z(o,e,a,i,l,d){const k=t("CHead"),E=t("n-alert"),g=t("CEditItem"),_=t("n-button"),v=t("CLink");return h(),S("div",D,[s(k,{title:"Login",description:"Login to your GlobeTrotte account."}),F,o.showError?(h(),T(E,{key:0,class:"tripPrivateAlertBar",title:"Please login to continue.",type:"error"})):V("",!0),r("form",J,[s(g,{class:"loginUsernameItem",label:"Email",ref:"email",className:"loginUsername",onEnter:o.confirm},null,8,["onEnter"]),s(g,{label:"Password",ref:"password",className:"loginPassword",type:"password",onEnter:o.confirm},null,8,["onEnter"]),K,s(_,{class:"loginConfirm left_col",type:"info",onClick:o.confirm,loading:o.loading},{default:m(()=>[p("Confirm")]),_:1},8,["onClick","loading"]),s(_,{class:"loginCancel right_col",type:"default",onClick:o.cancel},{default:m(()=>[p("Cancel")]),_:1},8,["onClick"])]),r("p",Y,[s(v,{url:o.resetLink},{default:m(()=>[p("Forgot Password?")]),_:1},8,["url"])])])}const ne=G(x,[["render",z],["__scopeId","data-v-2195b5d3"]]);export{ne as default};
