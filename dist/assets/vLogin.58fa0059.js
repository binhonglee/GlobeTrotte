var E=Object.defineProperty;var y=(s,e,a)=>e in s?E(s,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[e]=a;var c=(s,e,a)=>(y(s,typeof e!="symbol"?e+"":e,a),a);import{r as t,o as f,d as $,f as v,g as B,i as n,e as o,w as m,h as g,j as L,I as N,t as P,W as _}from"./vendor.6a882937.js";import{C as b,E as r}from"./E.4d2b08bc.js";import{C as I}from"./CLink.c6319851.js";import{_ as V,a as R,G as h,R as w,H as T,U,r as S}from"./index.265373cb.js";class x{constructor(e){c(this,"email","");c(this,"password","");e&&(this.email=e.email!==void 0&&e.email!==null?e.email:"",this.password=e.password!==void 0&&e.password!==null?e.password:"")}toJsonKey(e){switch(e){case"email":return"email";case"password":return"password";default:return e}}}const W={class:"login narrow_content"},A=n("h1",{class:"title"},"Login",-1),G={class:"loginbox"},H=n("br",null,null,-1),M=g("Confirm"),O=g("Cancel"),j={class:"forgotPassword"},q=g("Forgot Password?");function D(s,e,a,i,l,d){const C=t("n-alert"),u=t("CEditItem"),p=t("n-button"),k=t("CLink");return f(),$("div",W,[A,s.showError?(f(),v(C,{key:0,class:"tripPrivateAlertBar",title:"Please login to continue.",type:"error"})):B("",!0),n("form",G,[o(u,{class:"loginUsernameItem",label:"Email",ref:"email",className:"loginUsername",onEnter:s.confirm},null,8,["onEnter"]),o(u,{label:"Password",ref:"password",className:"loginPassword",type:"password",onEnter:s.confirm},null,8,["onEnter"]),H,o(p,{class:"loginConfirm",type:"info",onClick:s.confirm,loading:s.loading},{default:m(()=>[M]),_:1},8,["onClick","loading"]),o(p,{class:"loginCancel",type:"default",onClick:s.cancel},{default:m(()=>[O]),_:1},8,["onClick"])]),n("p",j,[o(k,{url:s.resetLink},{default:m(()=>[q]),_:1},8,["url"])])])}const F=L({components:{CEditItem:b,CLink:I,NAlert:N,NButton:P},data(){return{loading:!1,showError:!1,resetLink:R.password_Reset,loadingBar:h.loadingBar()}},beforeMount(){w.hasNext()&&(this.$data.showError=!0)},mounted(){r.get(r.get(this,"email"),"input").focus()},methods:{async confirm(){var i,l,d;this.$data.loading=!0,(i=this.$data.loadingBar)==null||i.start();const s=new x({email:r.getVal(this,"email"),password:r.getVal(this,"password")}),e=await T.genPOST("login",_.stringify(s)),a=new U(e);if(a.ID===-1){(l=this.$data.loadingBar)==null||l.error(),this.$data.loading=!1,this.$message({type:"error",message:"Wrong email or password. Please try again."});return}(d=this.$data.loadingBar)==null||d.finish(),localStorage.setItem("userobj",_.stringify(a)),this.$data.loading=!1,this.$notify(h.notifConfig("Success","You are now logged in.","success")),await w.paramToNext(new Map,!0)},cancel(){S.back()}}});var X=V(F,[["render",D]]);export{X as default};
