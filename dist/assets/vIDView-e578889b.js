import{C as j}from"./CHead-73ad5be2.js";import{d as C,o,c as r,e as i,m as M,n as q,r as s,a as e,F as b,h as I,g as p,p as N,b as L,_ as T,k as U,N as z,q as F,s as G,H as R,f as S,G as g,j as u,i as w,u as v,t as c,W as K,R as O}from"./index-147973cf.js";import{N as W,C as J}from"./CPlaces-30cfbba1.js";import{C as Q,T as X}from"./CEditTrip-1d7f79bf.js";import{C as Y}from"./CLink-fb10ae0a.js";import{C as Z}from"./CShare-934aee1f.js";import{N as tt,D as et}from"./DataProps-e6fa7ddf.js";import{T as h}from"./TripObj-b50c88ea.js";import{N as y,a as it}from"./NaiveUtils-395111c1.js";import{s as st}from"./TripUtil-47a03a53.js";import"./Input-c3c5bdea.js";import"./CEditItem-1595fc0d.js";import"./UserUtil-301ad2f7.js";import"./Select-132c3c54.js";const ot={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},at=i("circle",{cx:"256",cy:"256",r:"32",fill:"none",stroke:"currentColor","stroke-miterlimit":"10","stroke-width":"32"},null,-1),nt=i("circle",{cx:"416",cy:"256",r:"32",fill:"none",stroke:"currentColor","stroke-miterlimit":"10","stroke-width":"32"},null,-1),rt=i("circle",{cx:"96",cy:"256",r:"32",fill:"none",stroke:"currentColor","stroke-miterlimit":"10","stroke-width":"32"},null,-1),dt=[at,nt,rt],pt=C({name:"EllipsisHorizontalOutline",render:function(n,d){return o(),r("svg",ot,dt)}}),lt=C({name:"CLoadingTripInfo",components:{NCard:M,NDivider:q,NSkeleton:W}}),E=t=>(N("data-v-cba37515"),t=t(),L(),t),ct={class:"loading_trip_info narrow_display_window"},_t={class:"narrow_content"},ut={class:"row"},ht=E(()=>i("p",{class:"tripCreatorInfo"},"Author:",-1)),mt={class:"row"},ft=E(()=>i("p",{class:"tripUpdatedDate"},"Last Updated:",-1)),$t={class:"row"},wt=E(()=>i("p",{class:"tripCreatedDate"},"Created on:",-1)),vt={class:"loadingDays"};function yt(t,n,d,_,k,D){const a=s("n-skeleton"),l=s("n-divider"),m=s("n-card");return o(),r("div",ct,[i("div",_t,[e(a,{height:"40px"}),e(a,{text:""}),i("div",ut,[ht,e(a,{class:"inline_text",text:"",width:"30%"})]),i("div",mt,[ft,e(a,{class:"inline_text",text:"",width:"30%"})]),i("div",$t,[wt,e(a,{class:"inline_text",text:"",width:"30%"})]),e(a,{class:"cities",height:"28px",width:"200px"}),e(a,{class:"share",height:"35px",width:"75px"})]),i("div",vt,[(o(),r(b,null,I(3,f=>e(m,{class:"loadingDayCard",key:f,"content-style":"padding: 0"},{default:p(()=>[e(a,{class:"loadingDayTitle",height:"20px"}),e(l),e(a,{class:"loadingDayText",text:"",row:2}),e(l),e(a,{class:"loadingDayText lastLoadingDayText",text:"",row:2})]),_:2},1024)),64))])])}const Ct=T(lt,[["render",yt],["__scopeId","data-v-cba37515"]]),gt=C({name:"CViewTrip",components:{CLink:Y,CPlaces:J,CShare:Z,EllipsisHorizontalOutline:pt,NAlert:U,NButton:z,NCard:M,NDropdown:F,NIcon:G,NTag:tt},props:{trip:{type:h,required:!0},editable:{type:Boolean}},emits:{enableEditMode(){return!0}},data:()=>({days:[],cities:[],shareURL:"",created:"",lastUpdated:"",menuOptions:[]}),beforeMount(){this.$data.cities=[];for(const t of this.$props.trip.details.cities)this.$data.cities.push(t.display.valueOf()+", "+t.iso2.valueOf());this.$data.days=this.$props.trip.details.days.slice(0).map(t=>new et(t)),this.$data.shareURL=R.getAbsoluteURL(S.trip_View,this.$props.trip.ID.toString()),this.$data.created=g.getDisplayDate(this.$props.trip.timeCreated),this.$data.lastUpdated=g.getDisplayDate(this.$props.trip.lastUpdated),this.$props.editable&&this.$data.menuOptions.push({label:"Edit",key:"edit"})},methods:{handleSelectMenu(t){switch(t){case"bookmark":return this.bookmark();case"edit":return this.enableEditMode()}},enableEditMode(){this.$emit("enableEditMode")},bookmark(){}}}),Tt={key:0,class:"view_trip"},kt={class:"narrow_content"},Dt={class:"tripName left_col"},bt={key:2,class:"tripDescription"},It={class:"tripCreatorInfo"},St={class:"tripUpdatedDate"},Et={class:"tripCreatedDate"},Ot={class:"tripCities"},Mt={class:"viewDays"},Nt={class:"viewDayCardContent"},Lt={class:"dayTitle"};function Ut(t,n,d,_,k,D){const a=s("n-alert"),l=s("ellipsis-horizontal-outline"),m=s("n-icon"),f=s("n-button"),P=s("n-dropdown"),V=s("CLink"),x=s("n-tag"),B=s("CShare"),H=s("CPlaces"),A=s("n-card");return t.trip!==void 0?(o(),r("div",Tt,[i("div",kt,[t.trip.details.private?(o(),u(a,{key:0,class:"tripPrivateAlertBar",title:"Trip is private",type:"info"},{default:p(()=>[w("Only you can see this trip.")]),_:1})):v("",!0),i("h2",Dt,c(t.trip.details.name),1),t.menuOptions.length>0?(o(),u(P,{key:1,trigger:"click",options:t.menuOptions,"show-arrow":!0,onSelect:t.handleSelectMenu},{default:p(()=>[e(f,{class:"right_col tripMenu"},{default:p(()=>[e(m,null,{default:p(()=>[e(l)]),_:1})]),_:1})]),_:1},8,["options","onSelect"])):v("",!0),t.trip.details.description!==""?(o(),r("p",bt,c(t.trip.details.description),1)):v("",!0),i("p",It,[w("Author: "),e(V,{url:"/user/"+(t.trip.user.username.valueOf()===""?t.trip.user.ID.toString():t.trip.user.username.toString())},{default:p(()=>[w(c(t.trip.user.name),1)]),_:1},8,["url"])]),i("p",St,"Last Updated: "+c(t.lastUpdated),1),i("p",Et,"Created on: "+c(t.created),1),i("div",Ot,[(o(!0),r(b,null,I(t.cities,$=>(o(),u(x,{class:"tripCity",type:"info"},{default:p(()=>[w(c($),1)]),_:2},1024))),256))]),e(B,{shareURL:t.shareURL},null,8,["shareURL"])]),i("div",Mt,[(o(!0),r(b,null,I(t.days,$=>(o(),u(A,{class:"viewDayCard",key:$.ID.valueOf(),"content-style":"padding: 0"},{default:p(()=>[i("div",Nt,[i("h3",Lt,"Day "+c($.dayOf),1),e(H,{propPlaces:$.propPlaces},null,8,["propPlaces"])])]),_:2},1024))),128))])])):v("",!0)}const Rt=T(gt,[["render",Ut],["__scopeId","data-v-1ae2c911"]]),Pt=C({name:"CTripInfo",components:{CViewTrip:Rt,CEditTrip:Q},props:{trip:{type:h,required:!0},editable:{type:Boolean}},data:()=>({editMode:!1,dtrip:new h}),beforeMount(){this.$data.editMode=!1,this.$data.dtrip=this.$props.trip,y.init()},methods:{async save(t){const n=this.$props.trip;n.details=t;const d=await R.genPOST("v2/trip/"+t.ID,K.stringify(n));if(d){const _=new h(d);_.ID!==-1?(this.$data.dtrip=_,this.$data.editMode=!1):y.dialogError({title:"Error",content:"Save was unsuccessful. Please try again later.",positiveText:"OK"})}else y.dialogError({title:"Error",content:"Save was unsuccessful. Please try again later.",positiveText:"OK"})},cancel(){this.$data.editMode=!1},enableEditMode(){this.$data.editMode=!0}}}),Vt={class:"trip_info narrow_display_window"},xt={key:0,class:"view_trip_info"},Bt={key:1,class:"edit_trip_info"};function Ht(t,n,d,_,k,D){const a=s("CViewTrip"),l=s("CEditTrip");return o(),r("div",Vt,[t.editMode?(o(),r("div",Bt,[e(l,{trip:t.dtrip,isNew:!1,onSave:t.save,onCancel:t.cancel},null,8,["trip","onSave","onCancel"])])):(o(),r("div",xt,[e(a,{trip:t.dtrip,editable:t.editable,onEnableEditMode:t.enableEditMode},null,8,["trip","editable","onEnableEditMode"])]))])}const At=T(Pt,[["render",Ht]]),jt=C({components:{CHead:j,CLoadingTripInfo:Ct,CTripInfo:At,NAlert:U},data(){return{inputID:"",trip:new h,updated:null,owner:!1}},beforeMount(){y.init()},async mounted(){await this.init()},methods:{async init(){const t=g.paramID();if(t===void 0){this.$data.trip=new h,await O.genRedirectTo(S.trip_Search);return}this.$data.inputID=t;const n=await X.genObj(t);if(n.completed!==null&&(this.$data.trip=n.completed),n.promise!==null){const d=await n.promise;d!==null&&!st(d,this.$data.trip)&&(this.$data.updated=d)}if(this.$data.trip.ID!==-1){this.$data.owner=g.getIsCurrentUser(this.$data.trip.user.ID.valueOf());return}y.notifyTrigger("Error","Trip not found.",it.ERROR),await O.genRedirectTo(S.trip_Search)},update(){this.$data.updated!==null&&(this.$data.trip=this.$data.updated),this.$data.updated=null}}}),qt=t=>(N("data-v-c201b12f"),t=t(),L(),t),zt={class:"get_view_trip"},Ft={key:0,class:"narrow_content tapToUpdate"},Gt=qt(()=>i("h1",{class:"title"},"Trip",-1));function Kt(t,n,d,_,k,D){const a=s("CHead"),l=s("n-alert"),m=s("CLoadingTripInfo"),f=s("CTripInfo");return o(),r("div",zt,[e(a,{title:t.trip.details.name.valueOf(),description:t.trip.details.description.valueOf(),type:"article"},null,8,["title","description"]),t.updated!==null?(o(),r("div",Ft,[e(l,{title:"There's an update!",type:"warning",onClick:t.update},{default:p(()=>[w("Press here to view latest version of this profile.")]),_:1},8,["onClick"])])):v("",!0),Gt,t.trip.ID===-1?(o(),u(m,{key:1})):(o(),u(f,{key:2,trip:t.trip,editable:t.owner},null,8,["trip","editable"]))])}const de=T(jt,[["render",Kt],["__scopeId","data-v-c201b12f"]]);export{de as default};
