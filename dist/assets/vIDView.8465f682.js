import{C as A}from"./CHead.db963fd0.js";import{d as g,l as N,m as j,r as o,o as a,c as r,e as i,a as e,F as I,i as k,w as c,p as U,b as M,_ as T,aX as O,N as q,f as R,g as E,G as w,k as h,j as u,q as y,t as l,aS as H,R as L}from"./index.2186fee5.js";import{N as F,C as G}from"./CPlaces.14368084.js";import{C as K,T as x}from"./CEditTrip.9cd7a053.js";import{C as W}from"./CLink.00d7a50f.js";import{C as X}from"./CShare.0dccf875.js";import{N as z,D as J}from"./DataProps.eb38d2f3.js";import{T as f}from"./TripObj.2f043067.js";import{N as C,a as Q}from"./NaiveUtils.5e1e4e64.js";import{s as Y}from"./TripUtil.d8663c84.js";import"./Input.b4d6024c.js";import"./CEditItem.7c74b965.js";import"./UserUtil.2d17a227.js";import"./Select.945449d9.js";const Z=g({name:"CLoadingTripInfo",components:{NCard:N,NDivider:j,NSkeleton:F}}),S=t=>(U("data-v-cba37515"),t=t(),M(),t),tt={class:"loading_trip_info narrow_display_window"},et={class:"narrow_content"},it={class:"row"},at=S(()=>i("p",{class:"tripCreatorInfo"},"Author:",-1)),st={class:"row"},ot=S(()=>i("p",{class:"tripUpdatedDate"},"Last Updated:",-1)),nt={class:"row"},rt=S(()=>i("p",{class:"tripCreatedDate"},"Created on:",-1)),dt={class:"loadingDays"};function pt(t,n,d,_,D,b){const s=o("n-skeleton"),p=o("n-divider"),m=o("n-card");return a(),r("div",tt,[i("div",et,[e(s,{height:"40px"}),e(s,{text:""}),i("div",it,[at,e(s,{class:"inline_text",text:"",width:"30%"})]),i("div",st,[ot,e(s,{class:"inline_text",text:"",width:"30%"})]),i("div",nt,[rt,e(s,{class:"inline_text",text:"",width:"30%"})]),e(s,{class:"cities",height:"28px",width:"200px"}),e(s,{class:"share",height:"35px",width:"75px"})]),i("div",dt,[(a(),r(I,null,k(3,$=>e(m,{class:"loadingDayCard",key:$,"content-style":"padding: 0"},{default:c(()=>[e(s,{class:"loadingDayTitle",height:"20px"}),e(p),e(s,{class:"loadingDayText",text:"",row:2}),e(p),e(s,{class:"loadingDayText lastLoadingDayText",text:"",row:2})]),_:2},1024)),64))])])}const lt=T(Z,[["render",pt],["__scopeId","data-v-cba37515"]]),ct=g({name:"CViewTrip",components:{CLink:W,CPlaces:G,CShare:X,NAlert:O,NButton:q,NCard:N,NTag:z},props:{trip:{type:f,required:!0},editable:{type:Boolean}},emits:{enableEditMode(){return!0}},data:()=>({days:[],cities:[],shareURL:"",created:"",lastUpdated:""}),beforeMount(){this.$data.cities=[];for(const t of this.$props.trip.details.cities)this.$data.cities.push(t.display.valueOf()+", "+t.iso2.valueOf());this.$data.days=this.$props.trip.details.days.slice(0).map(t=>new J(t)),this.$data.shareURL=R.getAbsoluteURL(E.trip_View,this.$props.trip.ID.toString()),this.$data.created=w.getDisplayDate(this.$props.trip.timeCreated),this.$data.lastUpdated=w.getDisplayDate(this.$props.trip.lastUpdated)},methods:{enableEditMode(){this.$emit("enableEditMode")}}}),_t={key:0,class:"view_trip"},ut={class:"narrow_content"},ht={class:"tripName left_col"},ft={key:1,class:"tripDescription"},mt={class:"tripCreatorInfo"},$t={class:"tripUpdatedDate"},vt={class:"tripCreatedDate"},yt={class:"tripCities"},Ct={class:"viewDays"},wt={class:"viewDayCardContent"},gt={class:"dayTitle"},Tt={class:"narrow_content enableTripEdit"};function Dt(t,n,d,_,D,b){const s=o("n-alert"),p=o("CLink"),m=o("n-tag"),$=o("CShare"),P=o("CPlaces"),V=o("n-card"),B=o("n-button");return t.trip!==void 0?(a(),r("div",_t,[i("div",ut,[t.trip.details.private?(a(),h(s,{key:0,class:"tripPrivateAlertBar",title:"Trip is private",type:"info"},{default:c(()=>[u("Only you can see this trip.")]),_:1})):y("",!0),i("h2",ht,l(t.trip.details.name),1),t.trip.details.description!==""?(a(),r("p",ft,l(t.trip.details.description),1)):y("",!0),i("p",mt,[u("Author: "),e(p,{url:"/user/"+(t.trip.user.username.valueOf()===""?t.trip.user.ID.toString():t.trip.user.username.toString())},{default:c(()=>[u(l(t.trip.user.name),1)]),_:1},8,["url"])]),i("p",$t,"Last Updated: "+l(t.lastUpdated),1),i("p",vt,"Created on: "+l(t.created),1),i("div",yt,[(a(!0),r(I,null,k(t.cities,v=>(a(),h(m,{class:"tripCity",type:"info"},{default:c(()=>[u(l(v),1)]),_:2},1024))),256))]),e($,{shareURL:t.shareURL},null,8,["shareURL"])]),i("div",Ct,[(a(!0),r(I,null,k(t.days,v=>(a(),h(V,{class:"viewDayCard",key:v.ID.valueOf(),"content-style":"padding: 0"},{default:c(()=>[i("div",wt,[i("h3",gt,"Day "+l(v.dayOf),1),e(P,{propPlaces:v.propPlaces},null,8,["propPlaces"])])]),_:2},1024))),128))]),i("div",Tt,[t.editable?(a(),h(B,{key:0,class:"editTripButton right_col",onClick:t.enableEditMode},{default:c(()=>[u("Edit")]),_:1},8,["onClick"])):y("",!0)])])):y("",!0)}const bt=T(ct,[["render",Dt],["__scopeId","data-v-29810b41"]]),It=g({name:"CTripInfo",components:{CViewTrip:bt,CEditTrip:K},props:{trip:{type:f,required:!0},editable:{type:Boolean}},data:()=>({editMode:!1,dtrip:new f}),beforeMount(){this.$data.editMode=!1,this.$data.dtrip=this.$props.trip,C.init()},methods:{async save(t){const n=this.$props.trip;n.details=t;const d=await R.genPOST("v2/trip/"+t.ID,H.stringify(n));if(d){const _=new f(d);_.ID!==-1?(this.$data.dtrip=_,this.$data.editMode=!1):C.dialogError({title:"Error",content:"Save was unsuccessful. Please try again later.",positiveText:"OK"})}else C.dialogError({title:"Error",content:"Save was unsuccessful. Please try again later.",positiveText:"OK"})},cancel(){this.$data.editMode=!1},enableEditMode(){this.$data.editMode=!0}}}),kt={class:"trip_info narrow_display_window"},Et={key:0,class:"view_trip_info"},St={key:1,class:"edit_trip_info"};function Lt(t,n,d,_,D,b){const s=o("CViewTrip"),p=o("CEditTrip");return a(),r("div",kt,[t.editMode?(a(),r("div",St,[e(p,{trip:t.dtrip,isNew:!1,onSave:t.save,onCancel:t.cancel},null,8,["trip","onSave","onCancel"])])):(a(),r("div",Et,[e(s,{trip:t.dtrip,editable:t.editable,onEnableEditMode:t.enableEditMode},null,8,["trip","editable","onEnableEditMode"])]))])}const Nt=T(It,[["render",Lt]]),Ut=g({components:{CHead:A,CLoadingTripInfo:lt,CTripInfo:Nt,NAlert:O},data(){return{inputID:"",trip:new f,updated:null,owner:!1}},beforeMount(){C.init()},async mounted(){await this.init()},methods:{async init(){const t=w.paramID();if(t===void 0){this.$data.trip=new f,await L.genRedirectTo(E.trip_Search);return}this.$data.inputID=t;const n=await x.genObj(t);if(n.completed!==null&&(this.$data.trip=n.completed),n.promise!==null){const d=await n.promise;d!==null&&!Y(d,this.$data.trip)&&(this.$data.updated=d)}if(this.$data.trip.ID!==-1){this.$data.owner=w.getIsCurrentUser(this.$data.trip.user.ID.valueOf());return}C.notifyTrigger("Error","Trip not found.",Q.ERROR),await L.genRedirectTo(E.trip_Search)},update(){this.$data.updated!==null&&(this.$data.trip=this.$data.updated),this.$data.updated=null}}}),Mt=t=>(U("data-v-c201b12f"),t=t(),M(),t),Ot={class:"get_view_trip"},Rt={key:0,class:"narrow_content tapToUpdate"},Pt=Mt(()=>i("h1",{class:"title"},"Trip",-1));function Vt(t,n,d,_,D,b){const s=o("CHead"),p=o("n-alert"),m=o("CLoadingTripInfo"),$=o("CTripInfo");return a(),r("div",Ot,[e(s,{title:t.trip.details.name.valueOf(),description:t.trip.details.description.valueOf(),type:"article"},null,8,["title","description"]),t.updated!==null?(a(),r("div",Rt,[e(p,{title:"There's an update!",type:"warning",onClick:t.update},{default:c(()=>[u("Press here to view latest version of this profile.")]),_:1},8,["onClick"])])):y("",!0),Pt,t.trip.ID===-1?(a(),h(m,{key:1})):(a(),h($,{key:2,trip:t.trip,editable:t.owner},null,8,["trip","editable"]))])}const Yt=T(Ut,[["render",Vt],["__scopeId","data-v-c201b12f"]]);export{Yt as default};
