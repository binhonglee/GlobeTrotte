var v=Object.defineProperty;var y=(o,e,a)=>e in o?v(o,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):o[e]=a;var c=(o,e,a)=>(y(o,typeof e!="symbol"?e+"":e,a),a);import{d as B,aX as L,N as $,g as I,G as f,R as w,f as P,aS as b,b3 as S,r as t,o as h,c as U,a as s,j as T,q as V,e as r,w as m,p as R,b as H,k as _,_ as G}from"./index.c74f9166.js";import{C as q,E as n}from"./CEditItem.5ac1921b.js";import{C as A}from"./CLink.5b200109.js";import{U as M}from"./UserObj.f15546c4.js";import{N as p}from"./NaiveUtils.632d4605.js";import{C as O}from"./CHead.e9fd289b.js";import"./Input.a7711bb2.js";import"./TripObj.7f17e106.js";class W{constructor(e){c(this,"email","");c(this,"password","");e&&(this.email=e.email!==void 0&&e.email!==null?e.email:"",this.password=e.password!==void 0&&e.password!==null?e.password:"")}toJsonKey(e){switch(e){case"email":return"email";case"password":return"password";default:return e}}}const x=B({components:{CEditItem:q,CLink:A,NAlert:L,NButton:$,CHead:O},data(){return{loading:!1,showError:!1,resetLink:I.password_Reset,loadingBar:f.loadingBar()}},beforeMount(){w.hasNext()&&(this.$data.showError=!0),p.init()},mounted(){n.get(n.get(this,"email"),"input").focus()},methods:{async confirm(){var i,l,d;this.$data.loading=!0,(i=this.$data.loadingBar)==null||i.start();const o=new W({email:n.getVal(this,"email"),password:n.getVal(this,"password")}),e=await P.genPOST("login",b.stringify(o));if(new M(e).ID===-1){(l=this.$data.loadingBar)==null||l.error(),this.$data.loading=!1,p.messageError("Wrong email or password. Please try again.");return}await f.genCurrentUser(),(d=this.$data.loadingBar)==null||d.finish(),this.$data.loading=!1,p.messageSuccess("You are now logged in."),await w.paramToNext(new Map,!0)},cancel(){S.back()}}}),C=o=>(R("data-v-2195b5d3"),o=o(),H(),o),D={class:"login narrow_content"},F=C(()=>r("h1",{class:"title"},"Login",-1)),J={class:"narrow_display_window"},K=C(()=>r("br",null,null,-1)),X=_("Confirm"),Y=_("Cancel"),z={class:"forgotPassword"},Q=_("Forgot Password?");function Z(o,e,a,i,l,d){const k=t("CHead"),E=t("n-alert"),u=t("CEditItem"),g=t("n-button"),N=t("CLink");return h(),U("div",D,[s(k,{title:"Login",description:"Login to your GlobeTrotte account."}),F,o.showError?(h(),T(E,{key:0,class:"tripPrivateAlertBar",title:"Please login to continue.",type:"error"})):V("",!0),r("form",J,[s(u,{class:"loginUsernameItem",label:"Email",ref:"email",className:"loginUsername",onEnter:o.confirm},null,8,["onEnter"]),s(u,{label:"Password",ref:"password",className:"loginPassword",type:"password",onEnter:o.confirm},null,8,["onEnter"]),K,s(g,{class:"loginConfirm left_col",type:"info",onClick:o.confirm,loading:o.loading},{default:m(()=>[X]),_:1},8,["onClick","loading"]),s(g,{class:"loginCancel right_col",type:"default",onClick:o.cancel},{default:m(()=>[Y]),_:1},8,["onClick"])]),r("p",z,[s(N,{url:o.resetLink},{default:m(()=>[Q]),_:1},8,["url"])])])}const le=G(x,[["render",Z],["__scopeId","data-v-2195b5d3"]]);export{le as default};
