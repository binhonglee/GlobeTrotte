import{resolveComponent as a,openBlock as g,createElementBlock as k,createVNode as t,createBlock as y,createCommentVNode as N,createElementVNode as n,withCtx as c,pushScopeId as L,popScopeId as $,createTextVNode as p,defineComponent as B}from"vue";import{_ as I,at as P,N as S,b as T,G as V,R as f,a as b,ao as h,aC as R,aA as U}from"./index.18ba2282.js";import{C as H,E as s}from"./E.7cace6b2.js";import{C as A}from"./CLink.ec785f29.js";import{N as m}from"./NaiveUtils.2ea9fd11.js";import{C as G}from"./CHead.51847178.js";import"workbox-window";import"./Input.6596a750.js";class M{constructor(o){this.email="",this.password="",o&&(this.email=o.email!==void 0&&o.email!==null?o.email:"",this.password=o.password!==void 0&&o.password!==null?o.password:"")}toJsonKey(o){switch(o){case"email":return"email";case"password":return"password";default:return o}}}const w=e=>(L("data-v-18162fa0"),e=e(),$(),e),O={class:"login narrow_content"},W=w(()=>n("h1",{class:"title"},"Login",-1)),q={class:"narrow_display_window"},x=w(()=>n("br",null,null,-1)),D=p("Confirm"),F=p("Cancel"),J={class:"forgotPassword"},K=p("Forgot Password?");function Y(e,o,r,i,l,d){const C=a("CHead"),E=a("n-alert"),_=a("CEditItem"),u=a("n-button"),v=a("CLink");return g(),k("div",O,[t(C,{title:"Login",description:"Login to your GlobeTrotte account."}),W,e.showError?(g(),y(E,{key:0,class:"tripPrivateAlertBar",title:"Please login to continue.",type:"error"})):N("",!0),n("form",q,[t(_,{class:"loginUsernameItem",label:"Email",ref:"email",className:"loginUsername",onEnter:e.confirm},null,8,["onEnter"]),t(_,{label:"Password",ref:"password",className:"loginPassword",type:"password",onEnter:e.confirm},null,8,["onEnter"]),x,t(u,{class:"loginConfirm left_col",type:"info",onClick:e.confirm,loading:e.loading},{default:c(()=>[D]),_:1},8,["onClick","loading"]),t(u,{class:"loginCancel right_col",type:"default",onClick:e.cancel},{default:c(()=>[F]),_:1},8,["onClick"])]),n("p",J,[t(v,{url:e.resetLink},{default:c(()=>[K]),_:1},8,["url"])])])}const z=B({components:{CEditItem:H,CLink:A,NAlert:P,NButton:S,CHead:G},data(){return{loading:!1,showError:!1,resetLink:T.password_Reset,loadingBar:V.loadingBar()}},beforeMount(){f.hasNext()&&(this.$data.showError=!0),m.init()},mounted(){s.get(s.get(this,"email"),"input").focus()},methods:{async confirm(){var i,l,d;this.$data.loading=!0,(i=this.$data.loadingBar)==null||i.start();const e=new M({email:s.getVal(this,"email"),password:s.getVal(this,"password")}),o=await b.genPOST("login",h.stringify(e)),r=new R(o);if(r.ID===-1){(l=this.$data.loadingBar)==null||l.error(),this.$data.loading=!1,m.messageError("Wrong email or password. Please try again.");return}(d=this.$data.loadingBar)==null||d.finish(),localStorage.setItem("userobj",h.stringify(r)),this.$data.loading=!1,m.messageSuccess("You are now logged in."),await f.paramToNext(new Map,!0)},cancel(){U.back()}}});var se=I(z,[["render",Y],["__scopeId","data-v-18162fa0"]]);export{se as default};
