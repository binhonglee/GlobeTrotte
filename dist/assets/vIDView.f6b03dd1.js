import{r as s,o as t,d as a,i,f as p,w as l,g as c,z as r,F as b,s as g,h as _,e as v,j as C,I as N,t as S,A as V,C as j,W as B}from"./vendor.fa904ddd.js";import{C as O}from"./CEditTrip.c237403d.js";import{C as P}from"./CityUtil.29b25352.js";import{C as U}from"./CPlaces.21745dc4.js";import{T as u,_ as y,H as R,G as f,R as D,a as I}from"./index.6f78a032.js";import"./E.c663a55f.js";import"./CLink.3f71e955.js";const A={key:0,class:"view_trip"},q={class:"narrow_content"},F=_("Only you can see this trip."),L={class:"tripName"},G={key:1,class:"tripDescription"},H={class:"tripCreatorInfo"},W=_("Author: "),z=["href"],K={class:"tripCreatedDate"},J={class:"tripUpdatedDate"},Q={class:"tripCities"},X={class:"viewDays"},Y={class:"viewDayCardContent"},Z={class:"dayTitle"},x={class:"narrow_content"},ee=_("Edit");function te(e,n,h,$,T,w){const o=s("n-alert"),m=s("n-tag"),E=s("CPlaces"),M=s("n-card"),k=s("n-button");return e.trip!==void 0?(t(),a("div",A,[i("div",q,[e.trip.details.private?(t(),p(o,{key:0,class:"tripPrivateAlertBar",title:"Trip is private",type:"info"},{default:l(()=>[F]),_:1})):c("",!0),i("h2",L,r(e.trip.details.name),1),e.trip.details.description!==""?(t(),a("p",G,r(e.trip.details.description),1)):c("",!0),i("p",H,[W,i("a",{href:"/user/"+e.trip.user.ID},r(e.trip.user.name),9,z)]),i("p",K,"Created on: "+r(e.trip.timeCreated.toDateString()),1),i("p",J,"Last Updated: "+r(e.trip.lastUpdated.toDateString()),1),i("div",Q,[(t(!0),a(b,null,g(e.cities,d=>(t(),p(m,{class:"tripCity",type:"info"},{default:l(()=>[_(r(d),1)]),_:2},1024))),256))])]),i("div",X,[(t(!0),a(b,null,g(e.trip.details.days,d=>(t(),p(M,{class:"viewDayCard",key:d.ID.valueOf(),"content-style":"padding: 0"},{default:l(()=>[i("div",Y,[i("h3",Z,"Day "+r(d.dayOf),1),v(E,{places:d.places},null,8,["places"])])]),_:2},1024))),128))]),i("div",x,[e.editable?(t(),p(k,{key:0,class:"enableTripEdit",onClick:e.enableEditMode},{default:l(()=>[ee]),_:1},8,["onClick"])):c("",!0)])])):c("",!0)}const ie=C({name:"CViewTrip",components:{CPlaces:U,NAlert:N,NButton:S,NCard:V,NTag:j},props:{trip:{type:u,required:!0},editable:{type:Boolean}},emits:{enableEditMode(){return!0}},data:()=>({cities:[]}),async beforeMount(){if(this.$data.cities=[],this.$props.trip!==void 0)for(let e of this.$props.trip.details.cities)this.$data.cities.push(P.toString(e))},methods:{enableEditMode(){this.$emit("enableEditMode")}}});var se=y(ie,[["render",te],["__scopeId","data-v-1c80fb93"]]);const ae={class:"trip_info"},re={key:0,class:"view_trip_info"},ne={key:1,class:"edit_trip_info"};function oe(e,n,h,$,T,w){const o=s("CViewTrip"),m=s("CEditTrip");return t(),a("div",ae,[e.editMode?(t(),a("div",ne,[v(m,{trip:e.trip,isNew:!1,onSave:e.save,onCancel:e.cancel},null,8,["trip","onSave","onCancel"])])):(t(),a("div",re,[v(o,{trip:e.trip,editable:e.editable,onEnableEditMode:e.enableEditMode},null,8,["trip","editable","onEnableEditMode"])]))])}const de=C({name:"CTripInfo",components:{CViewTrip:se,CEditTrip:O},props:{trip:{type:u,required:!0},editable:{type:Boolean}},data:()=>({editMode:!1}),beforeMount(){this.$data.editMode=!1},methods:{async save(e){const n=this.$props.trip;n.details=e,await R.genPOST("v2/trip/"+e.ID,B.stringify(n))?this.$data.editMode=!1:this.$alert("Save was unsuccessful. Please try again later.","Fail",{confirmButtonText:"OK"})},cancel(){this.$data.editMode=!1},enableEditMode(){this.$data.editMode=!0}}});var pe=y(de,[["render",oe]]);const ce={class:"get_view_trip"},le=i("h1",{class:"title"},"Trip",-1);function _e(e,n,h,$,T,w){const o=s("CTripInfo");return t(),a("div",ce,[le,e.trip.ID!==-1?(t(),p(o,{key:0,trip:e.trip,editable:e.owner},null,8,["trip","editable"])):c("",!0)])}const ue=C({components:{CTripInfo:pe},data(){return{inputID:"",trip:new u,owner:!1}},async beforeMount(){await this.init()},methods:{async init(){const e=f.paramID();if(e===void 0){this.$data.trip=new u,await D.genRedirectTo(I.trip_Search);return}if(this.$data.inputID=e,this.$data.trip=await f.genTrip(Number(e)),this.$data.trip.ID!==-1){this.$data.owner=f.getIsCurrentUser(this.$data.trip.user.ID.valueOf());return}this.$notify(f.notifConfig("Error","Trip not found.","error")),await D.genRedirectTo(I.trip_Search)}}});var Te=y(ue,[["render",_e]]);export{Te as default};
