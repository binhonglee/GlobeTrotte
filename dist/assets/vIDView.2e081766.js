import{r as i,o as t,d as s,f as p,g as l,i as a,t as r,F as T,n as g,w as h,h as m,e as v,j as C,W as M}from"./vendor.819410da.js";import{C as k}from"./CEditTrip.8b513f2f.js";import{C as V}from"./CityUtil.fac2f87d.js";import{C as j}from"./CPlaces.59119a34.js";import{T as c,_ as $,H as B,G as _,R as O,a as P}from"./index.90da0008.js";import"./E.68c119b5.js";const S={key:0,class:"view_trip narrow_content"},N={class:"tripName"},R={key:1,class:"tripDescription"},U={class:"tripCreatorInfo"},q=m("Author: "),F=["href"],A={class:"tripCreatedDate"},G={class:"tripCities"},H={class:"viewDayCardContent"},L={class:"dayTitle"},W=m("Edit");function K(e,o,u,y,w,b){const n=i("el-alert"),f=i("el-tag"),E=i("CPlaces"),I=i("el-card"),D=i("el-button");return e.trip!==void 0?(t(),s("div",S,[e.trip.details.private?(t(),p(n,{key:0,class:"tripPrivateAlertBar",title:"Trip is private",description:"Only you can see this trip.",type:"info",closable:!1,"show-icon":""})):l("",!0),a("h2",N,r(e.trip.details.name),1),e.trip.details.description!==""?(t(),s("p",R,r(e.trip.details.description),1)):l("",!0),a("p",U,[q,a("a",{href:"/user/"+e.trip.user.ID},r(e.trip.user.name),9,F)]),a("p",A,"Created on: "+r(e.trip.timeCreated.toLocaleDateString()),1),a("div",G,[(t(!0),s(T,null,g(e.cities,d=>(t(),p(f,{class:"tripCity"},{default:h(()=>[m(r(d),1)]),_:2},1024))),256))]),(t(!0),s(T,null,g(e.trip.details.days,d=>(t(),p(I,{class:"viewDayCard",key:d.ID.valueOf()},{default:h(()=>[a("div",H,[a("h3",L,"Day "+r(d.dayOf),1),v(E,{places:d.places},null,8,["places"])])]),_:2},1024))),128)),e.editable?(t(),p(D,{key:2,class:"enableTripEdit",onClick:e.enableEditMode},{default:h(()=>[W]),_:1},8,["onClick"])):l("",!0)])):l("",!0)}const z=C({name:"CViewTrip",components:{CPlaces:j},emits:{enableEditMode(){return!0}},data:()=>({cities:[]}),props:{trip:{type:c,required:!0},editable:{type:Boolean}},methods:{enableEditMode(){this.$emit("enableEditMode")}},async beforeMount(){if(this.$data.cities=[],this.$props.trip!==void 0)for(let e of this.$props.trip.details.cities)this.$data.cities.push(V.toString(e))}});var J=$(z,[["render",K],["__scopeId","data-v-b1492de8"]]);const Q={class:"trip_info"},X={key:0,class:"view_trip_info"},Y={key:1,class:"edit_trip_info"};function Z(e,o,u,y,w,b){const n=i("CViewTrip"),f=i("CEditTrip");return t(),s("div",Q,[e.editMode?(t(),s("div",Y,[v(f,{trip:e.trip,isNew:!1,onSave:e.save,onCancel:e.cancel},null,8,["trip","onSave","onCancel"])])):(t(),s("div",X,[v(n,{trip:e.trip,editable:e.editable,onEnableEditMode:e.enableEditMode},null,8,["trip","editable","onEnableEditMode"])]))])}const x=C({name:"CTripInfo",components:{CViewTrip:J,CEditTrip:k},data:()=>({editMode:!1}),props:{trip:{type:c,required:!0},editable:{type:Boolean}},methods:{async save(e){const o=this.$props.trip;o.details=e,await B.genPOST("v2/trip/"+e.ID,M.stringify(o))?this.$data.editMode=!1:this.$alert("Save was unsuccessful. Please try again later.","Fail",{confirmButtonText:"OK"})},cancel(){this.$data.editMode=!1},enableEditMode(){this.$data.editMode=!0}},beforeMount(){this.$data.editMode=!1}});var ee=$(x,[["render",Z]]);const te={class:"get_view_trip narrow_content"},ie=a("h1",{class:"title"},"Trip",-1);function se(e,o,u,y,w,b){const n=i("CTripInfo");return t(),s("div",te,[ie,e.trip.ID!==-1?(t(),p(n,{key:0,trip:e.trip,editable:e.owner},null,8,["trip","editable"])):l("",!0)])}const ae=C({components:{CTripInfo:ee},data(){return{inputID:"",trip:new c,owner:!1}},methods:{async init(){const e=_.paramID();if(e===void 0){this.$data.trip=new c;return}if(this.$data.inputID=e,this.$data.trip=await _.genTrip(Number(e)),this.$data.trip.ID!==-1){this.$data.owner=_.getIsCurrentUser(this.$data.trip.user.ID.valueOf());return}this.$notify(_.notifConfig("Error","Trip not found.","error")),await O.genRedirectTo(P.trip_View)}},async beforeMount(){await this.init()},watch:{"$route.path":async function(){await this.init()}}});var ce=$(ae,[["render",se]]);export{ce as default};
