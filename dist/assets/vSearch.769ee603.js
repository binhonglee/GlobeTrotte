import{d as f,o as s,c as n,e as d,b7 as N,r as i,a,f as q,w as l,F as k,g as I,l as x,p as P,b as B,h as M,i as u,_ as F,a_ as R,N as U,b2 as A,R as L,j as Q,aV as V,T as _}from"./index.ddc3f2ba.js";import{C as H}from"./CHead.697158f6.js";import{C as K,a as b}from"./CLoadingTripPreviewCard.8bf5570a.js";import{a as z,C as p}from"./CityUtil.bfa224ec.js";import{a as O}from"./TripUtil.eb3ebdea.js";import{N as W}from"./Input.08a00163.js";import{N as E}from"./Select.f680fe56.js";import"./CLink.dc4255c8.js";import"./CPlaces.9dd276b2.js";import"./DataProps.7f2e17ac.js";const J={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},D=d("path",{d:"M456.69 421.39L362.6 327.3a173.81 173.81 0 0 0 34.84-104.58C397.44 126.38 319.06 48 222.72 48S48 126.38 48 222.72s78.38 174.72 174.72 174.72A173.81 173.81 0 0 0 327.3 362.6l94.09 94.09a25 25 0 0 0 35.3-35.3zM97.92 222.72a124.8 124.8 0 1 1 124.8 124.8a124.95 124.95 0 0 1-124.8-124.8z",fill:"currentColor"},null,-1),G=[D];var X=f({name:"Search",render:function(e,r){return s(),n("svg",J,G)}});class Y{constructor(e){this.cities=[],this.length=0,this.query="",e&&(this.cities=e.cities!==void 0&&e.cities!==null?N(z,e.cities):[],this.length=e.length!==void 0&&e.length!==null?e.length:0,this.query=e.query!==void 0&&e.query!==null?e.query:"")}toJsonKey(e){switch(e){case"cities":return"cities";case"length":return"length";case"query":return"query";default:return e}}}const Z=t=>(P("data-v-242f0c2d"),t=t(),B(),t),j={class:"search_trip"},tt=Z(()=>d("h1",{class:"title"},"Search Trip",-1)),et={class:"tripSearchForm"},it=u("Find"),at={key:0,class:"tripSearchResultCarousel"},st={key:1,class:"tripSearching"},rt={key:2,class:"tripSearchInitialMessage"},nt={class:"narrow_content"},ot=u('Try searching for "weekend"'),ct={key:3,class:"tripSearchNoResultFound"},lt={class:"narrow_content accountUnconfirmedAlertBar"},dt=u("We could not find any trips that matches your search parameters. Please try again.");function ht(t,e,r,o,h,ut){const m=i("CHead"),y=i("n-input"),C=i("n-select"),v=i("n-button"),w=i("CTripPreviewCard"),S=i("CLoadingTripPreviewCard"),$=i("search"),T=i("n-icon"),g=i("n-alert");return s(),n("div",j,[a(m,{title:"Search Trip",description:"Search for a trip"}),tt,d("form",et,[a(y,{class:"tripSearchQueryInput",placeholder:"weekend",value:t.query,"onUpdate:value":e[0]||(e[0]=c=>t.query=c),onKeyup:q(t.search,["enter","native"])},null,8,["value","onKeyup"]),a(C,{class:"tripSearchCityInput",value:t.selectedCities,"onUpdate:value":e[1]||(e[1]=c=>t.selectedCities=c),options:t.possibleCities,filterable:"",multiple:"",placeholder:"City"},null,8,["value","options"]),a(v,{class:"tripSearchButton",onClick:t.search},{default:l(()=>[it]),_:1},8,["onClick"])]),t.trips.length>0?(s(),n("div",at,[(s(!0),n(k,null,I(t.trips,c=>(s(),M(w,{trip:c,"limit-height":t.trips.length!==1,wide:t.trips.length===1},null,8,["trip","limit-height","wide"]))),256))])):t.searching?(s(),n("div",st,[a(S,{"limit-height":!1,wide:!0})])):t.init?(s(),n("div",rt,[d("div",nt,[a(g,{title:"Search for a trip!",type:"default"},{icon:l(()=>[a(T,null,{default:l(()=>[a($)]),_:1})]),default:l(()=>[ot]),_:1})])])):!t.searching&&!t.init?(s(),n("div",ct,[d("div",lt,[a(g,{title:"No results",type:"error"},{default:l(()=>[dt]),_:1})])])):x("",!0)])}const pt=f({components:{Search:X,NAlert:R,NButton:U,NIcon:A,NInput:W,NSelect:E,CTripPreviewCard:K,CHead:H,CLoadingTripPreviewCard:b},data:()=>({length:0,possibleCities:[],query:"",searching:!1,selectedCities:[],trips:[],init:!1}),async beforeMount(){var r,o,h;this.$data.searching=!0,this.$data.possibleCities=p.sortedCityOptions();const t=L.getParamMap();if(t.size===0){this.$data.init=!0,this.$data.searching=!1;return}const e=+((r=t.get("length"))!=null?r:"");this.$data.length=isNaN(e)?0:e,this.$data.query=(o=t.get("query"))!=null?o:"",this.$data.selectedCities=p.stringToCityStringArray((h=t.get("cities"))!=null?h:""),await this.search(),this.$data.searching=!1},methods:{async search(){if(this.$data.init=!1,this.$data.selectedCities.length<1&&this.$data.query.length<1)return;const t=p.stringToCities(this.$data.selectedCities.join(",")),e=new Y({cities:t,length:this.$data.length,query:this.$data.query});this.$data.searching=!0;const r=await Q.genPOST("trip/search",V.stringify(e));if(this.$data.trips=[],r===null){this.$data.searching=!1;return}for(const o of r)new _(o).details.days.length>0&&this.$data.trips.push(new _(o));O(this.$data.trips),this.$data.searching=!1}}});var Tt=F(pt,[["render",ht],["__scopeId","data-v-242f0c2d"]]);export{Tt as default};
