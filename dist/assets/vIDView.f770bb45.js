import{C as j}from"./CHead.e6ab87e1.js";import{d as C,o as a,c as r,e as i,l as M,m as q,r as s,a as e,F as b,i as I,w as p,p as N,b as L,_ as T,aX as U,N as z,aZ as F,a_ as G,f as R,g as S,G as g,k as u,j as w,q as v,t as c,aS as K,R as O}from"./index.64fb5940.js";import{N as W,C as X}from"./CPlaces.cf723137.js";import{C as Z,T as J}from"./CEditTrip.64c397ba.js";import{C as Q}from"./CLink.b71a6999.js";import{C as Y}from"./CShare.2e2b4a96.js";import{N as tt,D as et}from"./DataProps.babc9bf5.js";import{T as h}from"./TripObj.33e5ae7f.js";import{N as y,a as it}from"./NaiveUtils.dd5f3ab6.js";import{s as st}from"./TripUtil.dfd80ffa.js";import"./Input.b6fe7ed4.js";import"./CEditItem.c5314bf9.js";import"./UserUtil.155dd445.js";import"./Select.dbffb9e4.js";const at={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},ot=i("circle",{cx:"256",cy:"256",r:"32",fill:"none",stroke:"currentColor","stroke-miterlimit":"10","stroke-width":"32"},null,-1),nt=i("circle",{cx:"416",cy:"256",r:"32",fill:"none",stroke:"currentColor","stroke-miterlimit":"10","stroke-width":"32"},null,-1),rt=i("circle",{cx:"96",cy:"256",r:"32",fill:"none",stroke:"currentColor","stroke-miterlimit":"10","stroke-width":"32"},null,-1),dt=[ot,nt,rt],pt=C({name:"EllipsisHorizontalOutline",render:function(n,d){return a(),r("svg",at,dt)}}),lt=C({name:"CLoadingTripInfo",components:{NCard:M,NDivider:q,NSkeleton:W}}),E=t=>(N("data-v-cba37515"),t=t(),L(),t),ct={class:"loading_trip_info narrow_display_window"},_t={class:"narrow_content"},ut={class:"row"},ht=E(()=>i("p",{class:"tripCreatorInfo"},"Author:",-1)),mt={class:"row"},ft=E(()=>i("p",{class:"tripUpdatedDate"},"Last Updated:",-1)),$t={class:"row"},wt=E(()=>i("p",{class:"tripCreatedDate"},"Created on:",-1)),vt={class:"loadingDays"};function yt(t,n,d,_,k,D){const o=s("n-skeleton"),l=s("n-divider"),m=s("n-card");return a(),r("div",ct,[i("div",_t,[e(o,{height:"40px"}),e(o,{text:""}),i("div",ut,[ht,e(o,{class:"inline_text",text:"",width:"30%"})]),i("div",mt,[ft,e(o,{class:"inline_text",text:"",width:"30%"})]),i("div",$t,[wt,e(o,{class:"inline_text",text:"",width:"30%"})]),e(o,{class:"cities",height:"28px",width:"200px"}),e(o,{class:"share",height:"35px",width:"75px"})]),i("div",vt,[(a(),r(b,null,I(3,f=>e(m,{class:"loadingDayCard",key:f,"content-style":"padding: 0"},{default:p(()=>[e(o,{class:"loadingDayTitle",height:"20px"}),e(l),e(o,{class:"loadingDayText",text:"",row:2}),e(l),e(o,{class:"loadingDayText lastLoadingDayText",text:"",row:2})]),_:2},1024)),64))])])}const Ct=T(lt,[["render",yt],["__scopeId","data-v-cba37515"]]),gt=C({name:"CViewTrip",components:{CLink:Q,CPlaces:X,CShare:Y,EllipsisHorizontalOutline:pt,NAlert:U,NButton:z,NCard:M,NDropdown:F,NIcon:G,NTag:tt},props:{trip:{type:h,required:!0},editable:{type:Boolean}},emits:{enableEditMode(){return!0}},data:()=>({days:[],cities:[],shareURL:"",created:"",lastUpdated:"",menuOptions:[]}),beforeMount(){this.$data.cities=[];for(const t of this.$props.trip.details.cities)this.$data.cities.push(t.display.valueOf()+", "+t.iso2.valueOf());this.$data.days=this.$props.trip.details.days.slice(0).map(t=>new et(t)),this.$data.shareURL=R.getAbsoluteURL(S.trip_View,this.$props.trip.ID.toString()),this.$data.created=g.getDisplayDate(this.$props.trip.timeCreated),this.$data.lastUpdated=g.getDisplayDate(this.$props.trip.lastUpdated),this.$props.editable&&this.$data.menuOptions.push({label:"Edit",key:"edit"})},methods:{handleSelectMenu(t){switch(t){case"bookmark":return this.save();case"edit":return this.enableEditMode()}},enableEditMode(){this.$emit("enableEditMode")},save(){}}}),Tt={key:0,class:"view_trip"},kt={class:"narrow_content"},Dt={class:"tripName left_col"},bt={key:2,class:"tripDescription"},It={class:"tripCreatorInfo"},St={class:"tripUpdatedDate"},Et={class:"tripCreatedDate"},Ot={class:"tripCities"},Mt={class:"viewDays"},Nt={class:"viewDayCardContent"},Lt={class:"dayTitle"};function Ut(t,n,d,_,k,D){const o=s("n-alert"),l=s("ellipsis-horizontal-outline"),m=s("n-icon"),f=s("n-button"),P=s("n-dropdown"),V=s("CLink"),x=s("n-tag"),B=s("CShare"),H=s("CPlaces"),A=s("n-card");return t.trip!==void 0?(a(),r("div",Tt,[i("div",kt,[t.trip.details.private?(a(),u(o,{key:0,class:"tripPrivateAlertBar",title:"Trip is private",type:"info"},{default:p(()=>[w("Only you can see this trip.")]),_:1})):v("",!0),i("h2",Dt,c(t.trip.details.name),1),t.menuOptions.length>0?(a(),u(P,{key:1,trigger:"click",options:t.menuOptions,"show-arrow":!0,onSelect:t.handleSelectMenu},{default:p(()=>[e(f,{class:"right_col tripMenu"},{default:p(()=>[e(m,null,{default:p(()=>[e(l)]),_:1})]),_:1})]),_:1},8,["options","onSelect"])):v("",!0),t.trip.details.description!==""?(a(),r("p",bt,c(t.trip.details.description),1)):v("",!0),i("p",It,[w("Author: "),e(V,{url:"/user/"+(t.trip.user.username.valueOf()===""?t.trip.user.ID.toString():t.trip.user.username.toString())},{default:p(()=>[w(c(t.trip.user.name),1)]),_:1},8,["url"])]),i("p",St,"Last Updated: "+c(t.lastUpdated),1),i("p",Et,"Created on: "+c(t.created),1),i("div",Ot,[(a(!0),r(b,null,I(t.cities,$=>(a(),u(x,{class:"tripCity",type:"info"},{default:p(()=>[w(c($),1)]),_:2},1024))),256))]),e(B,{shareURL:t.shareURL},null,8,["shareURL"])]),i("div",Mt,[(a(!0),r(b,null,I(t.days,$=>(a(),u(A,{class:"viewDayCard",key:$.ID.valueOf(),"content-style":"padding: 0"},{default:p(()=>[i("div",Nt,[i("h3",Lt,"Day "+c($.dayOf),1),e(H,{propPlaces:$.propPlaces},null,8,["propPlaces"])])]),_:2},1024))),128))])])):v("",!0)}const Rt=T(gt,[["render",Ut],["__scopeId","data-v-2eab2450"]]),Pt=C({name:"CTripInfo",components:{CViewTrip:Rt,CEditTrip:Z},props:{trip:{type:h,required:!0},editable:{type:Boolean}},data:()=>({editMode:!1,dtrip:new h}),beforeMount(){this.$data.editMode=!1,this.$data.dtrip=this.$props.trip,y.init()},methods:{async save(t){const n=this.$props.trip;n.details=t;const d=await R.genPOST("v2/trip/"+t.ID,K.stringify(n));if(d){const _=new h(d);_.ID!==-1?(this.$data.dtrip=_,this.$data.editMode=!1):y.dialogError({title:"Error",content:"Save was unsuccessful. Please try again later.",positiveText:"OK"})}else y.dialogError({title:"Error",content:"Save was unsuccessful. Please try again later.",positiveText:"OK"})},cancel(){this.$data.editMode=!1},enableEditMode(){this.$data.editMode=!0}}}),Vt={class:"trip_info narrow_display_window"},xt={key:0,class:"view_trip_info"},Bt={key:1,class:"edit_trip_info"};function Ht(t,n,d,_,k,D){const o=s("CViewTrip"),l=s("CEditTrip");return a(),r("div",Vt,[t.editMode?(a(),r("div",Bt,[e(l,{trip:t.dtrip,isNew:!1,onSave:t.save,onCancel:t.cancel},null,8,["trip","onSave","onCancel"])])):(a(),r("div",xt,[e(o,{trip:t.dtrip,editable:t.editable,onEnableEditMode:t.enableEditMode},null,8,["trip","editable","onEnableEditMode"])]))])}const At=T(Pt,[["render",Ht]]),jt=C({components:{CHead:j,CLoadingTripInfo:Ct,CTripInfo:At,NAlert:U},data(){return{inputID:"",trip:new h,updated:null,owner:!1}},beforeMount(){y.init()},async mounted(){await this.init()},methods:{async init(){const t=g.paramID();if(t===void 0){this.$data.trip=new h,await O.genRedirectTo(S.trip_Search);return}this.$data.inputID=t;const n=await J.genObj(t);if(n.completed!==null&&(this.$data.trip=n.completed),n.promise!==null){const d=await n.promise;d!==null&&!st(d,this.$data.trip)&&(this.$data.updated=d)}if(this.$data.trip.ID!==-1){this.$data.owner=g.getIsCurrentUser(this.$data.trip.user.ID.valueOf());return}y.notifyTrigger("Error","Trip not found.",it.ERROR),await O.genRedirectTo(S.trip_Search)},update(){this.$data.updated!==null&&(this.$data.trip=this.$data.updated),this.$data.updated=null}}}),qt=t=>(N("data-v-c201b12f"),t=t(),L(),t),zt={class:"get_view_trip"},Ft={key:0,class:"narrow_content tapToUpdate"},Gt=qt(()=>i("h1",{class:"title"},"Trip",-1));function Kt(t,n,d,_,k,D){const o=s("CHead"),l=s("n-alert"),m=s("CLoadingTripInfo"),f=s("CTripInfo");return a(),r("div",zt,[e(o,{title:t.trip.details.name.valueOf(),description:t.trip.details.description.valueOf(),type:"article"},null,8,["title","description"]),t.updated!==null?(a(),r("div",Ft,[e(l,{title:"There's an update!",type:"warning",onClick:t.update},{default:p(()=>[w("Press here to view latest version of this profile.")]),_:1},8,["onClick"])])):v("",!0),Gt,t.trip.ID===-1?(a(),u(m,{key:1})):(a(),u(f,{key:2,trip:t.trip,editable:t.owner},null,8,["trip","editable"]))])}const de=T(jt,[["render",Kt],["__scopeId","data-v-c201b12f"]]);export{de as default};
