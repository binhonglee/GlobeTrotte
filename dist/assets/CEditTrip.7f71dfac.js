import{P as pe,a as et,D as fe}from"./DataProps.d76f329e.js";import{d as M,x as $,A as tt,z as nt,S as at,U as $e,X as st,V as F,E as it,W as lt,Y as O,ac as ot,a2 as rt,v as dt,a$ as he,J as me,a7 as ve,b0 as ut,aa as P,b1 as ct,o as D,c as R,e as f,r as h,F as De,g as Te,a as l,w as y,h as te,l as Ne,n as Ie,i as S,N as ne,q as pt,b2 as ke,_ as ae,t as ft,m as ht,aS as mt,T as se,aV as Re,j as ee,b3 as vt,b4 as gt,b5 as ge,R as _t,k as yt}from"./index.87670501.js";import{u as bt,N as Se}from"./Input.582732a7.js";import{C as wt,D as Y,E as V,N as Ct,a as _e}from"./CEditItem.6c2862fc.js";import{N as j,a as ye}from"./NaiveUtils.345304fd.js";import{C as $t,F as Dt,a as Tt,b as Nt,P as It}from"./CacheStorage.3773b082.js";import{N as kt}from"./Select.2028a5a2.js";var Rt=M({name:"Add",render(){return $("svg",{width:"512",height:"512",viewBox:"0 0 512 512",fill:"none",xmlns:"http://www.w3.org/2000/svg"},$("path",{d:"M256 112V400M400 256H112",stroke:"currentColor","stroke-width":"32","stroke-linecap":"round","stroke-linejoin":"round"}))}}),St=M({name:"Remove",render(){return $("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},$("line",{x1:"400",y1:"256",x2:"112",y2:"256",style:`
        fill: none;
        stroke: currentColor;
        stroke-linecap: round;
        stroke-linejoin: round;
        stroke-width: 32px;
      `}))}});function Mt(e){return e==null||typeof e=="string"&&e.trim()===""?null:Number(e)}function Ot(e){return e.includes(".")&&(/^(-)?\d+.*(\.|0)$/.test(e)||/^\.\d+$/.test(e))}function Q(e){return e==null?!0:!Number.isNaN(e)}function Pt(e){return e==null?"":String(e)}function Z(e){if(e===null)return null;if(typeof e=="number")return e;{const n=Number(e);return Number.isNaN(n)?null:n}}var Vt=tt([nt("input-number-suffix",`
 display: inline-block;
 margin-right: 10px;
 `)]);const be=800,we=100,xt=Object.assign(Object.assign({},$e.props),{autofocus:Boolean,loading:{type:Boolean,default:void 0},placeholder:String,defaultValue:{type:Number,default:null},value:Number,step:{type:[Number,String],default:1},min:[Number,String],max:[Number,String],size:String,disabled:{type:Boolean,default:void 0},validator:Function,bordered:{type:Boolean,default:void 0},showButton:{type:Boolean,default:!0},readonly:Boolean,clearable:Boolean,keyboard:{type:Object,default:{}},updateValueOnInput:{type:Boolean,default:!0},status:String,"onUpdate:value":[Function,Array],onUpdateValue:[Function,Array],onFocus:[Function,Array],onBlur:[Function,Array],onClear:[Function,Array],onChange:[Function,Array]});var Et=M({name:"InputNumber",props:xt,setup(e){const{mergedBorderedRef:n,mergedClsPrefixRef:a,mergedRtlRef:d}=at(e),o=$e("InputNumber","-input-number",Vt,ut,e,a),{localeRef:u}=bt("InputNumber"),m=st(e),{mergedSizeRef:b,mergedDisabledRef:c,mergedStatusRef:v}=m,g=F(null),N=F(null),I=F(null),_=F(e.defaultValue),w=it(e,"value"),p=lt(w,_),x=F(""),Ee=t=>{const s=[e.min,e.max,e.step,t].map(i=>{const r=String(i).split(".")[1];return r?r.length:0});return Math.max(...s)},Ae=O(()=>{const{placeholder:t}=e;return t!==void 0?t:u.value.placeholder}),H=O(()=>{const t=Z(e.step);return t!==null?t===0?1:Math.abs(t):1}),ie=O(()=>{const t=Z(e.min);return t!==null?t:null}),le=O(()=>{const t=Z(e.max);return t!==null?t:null}),E=t=>{const{value:s}=p;if(t===s){A();return}const{"onUpdate:value":i,onUpdateValue:r,onChange:T}=e,{nTriggerFormInput:L,nTriggerFormChange:C}=m;T&&P(T,t),r&&P(r,t),i&&P(i,t),_.value=t,L(),C()},k=(t=0,s=!0,i=!1)=>{const{value:r}=x;if(i&&Ot(r))return!1;const T=Mt(r);if(T===null)return s&&E(null),null;if(Q(T)){const L=Ee(T);let C=parseFloat((T+t).toFixed(L));if(Q(C)){const{value:J}=le,{value:X}=ie;if(J!==null&&C>J){if(!s||i)return!1;C=J}if(X!==null&&C<X){if(!s||i)return!1;C=X}return e.validator&&!e.validator(C)?!1:(s&&E(C),C)}}return!1},A=()=>{const{value:t}=p;Q(t)?x.value=Pt(t):x.value=String(t)};A();const Be=O(()=>k(0,!1)===!1),oe=O(()=>{const{value:t}=p;if(e.validator&&t===null)return!1;const{value:s}=H;return k(-s,!1)!==!1}),re=O(()=>{const{value:t}=p;if(e.validator&&t===null)return!1;const{value:s}=H;return k(+s,!1)!==!1});function Ue(t){const{onFocus:s}=e,{nTriggerFormFocus:i}=m;s&&P(s,t),i()}function Le(t){var s,i;if(t.target===((s=g.value)===null||s===void 0?void 0:s.wrapperElRef))return;const r=k();if(r!==!1){const C=(i=g.value)===null||i===void 0?void 0:i.inputElRef;C&&(C.value=String(r||"")),p.value===r&&A()}else A();const{onBlur:T}=e,{nTriggerFormBlur:L}=m;T&&P(T,t),L()}function Fe(t){const{onClear:s}=e;s&&P(s,t)}function q(){const{value:t}=re;if(!t){ce();return}const{value:s}=p;if(s===null)e.validator||E(de());else{const{value:i}=H;k(i)}}function K(){const{value:t}=oe;if(!t){ue();return}const{value:s}=p;if(s===null)e.validator||E(de());else{const{value:i}=H;k(-i)}}const je=Ue,He=Le;function de(){if(e.validator)return null;const{value:t}=ie,{value:s}=le;return t!==null?Math.max(0,t):s!==null?Math.min(0,s):0}function ze(t){Fe(t),E(null)}function Ge(t){var s,i,r;!((s=I.value)===null||s===void 0)&&s.$el.contains(t.target)&&t.preventDefault(),!((i=N.value)===null||i===void 0)&&i.$el.contains(t.target)&&t.preventDefault(),(r=g.value)===null||r===void 0||r.activate()}let B=null,U=null,z=null;function ue(){z&&(window.clearTimeout(z),z=null),B&&(window.clearInterval(B),B=null)}function ce(){G&&(window.clearTimeout(G),G=null),U&&(window.clearInterval(U),U=null)}function We(){z=window.setTimeout(()=>{B=window.setInterval(()=>{K()},we)},be),ve("mouseup",document,()=>{window.setTimeout(ue,0)})}let G=null;function qe(){G=window.setTimeout(()=>{U=window.setInterval(()=>{q()},we)},be),ve("mouseup",document,()=>{window.setTimeout(ce,0)})}const Ke=()=>{U||q()},Je=()=>{B||K()};function Xe(t){var s,i;if(t.code==="Enter"||t.code==="NumpadEnter"){if(t.target===((s=g.value)===null||s===void 0?void 0:s.wrapperElRef))return;k()!==!1&&((i=g.value)===null||i===void 0||i.deactivate())}else if(t.code==="ArrowUp"){if(e.keyboard.ArrowUp===!1)return;t.preventDefault(),k()!==!1&&q()}else if(t.code==="ArrowDown"){if(e.keyboard.ArrowDown===!1)return;t.preventDefault(),k()!==!1&&K()}}function Ye(t){x.value=t,e.updateValueOnInput&&k(0,!0,!0)}ot(p,()=>{A()});const Qe={focus:()=>{var t;return(t=g.value)===null||t===void 0?void 0:t.focus()},blur:()=>{var t;return(t=g.value)===null||t===void 0?void 0:t.blur()}},Ze=rt("InputNumber",d,a);return Object.assign(Object.assign({},Qe),{rtlEnabled:Ze,inputInstRef:g,minusButtonInstRef:N,addButtonInstRef:I,mergedClsPrefix:a,mergedBordered:n,uncontrolledValue:_,mergedValue:p,mergedPlaceholder:Ae,displayedValueInvalid:Be,mergedSize:b,mergedDisabled:c,displayedValue:x,addable:re,minusable:oe,mergedStatus:v,handleFocus:je,handleBlur:He,handleClear:ze,handleMouseDown:Ge,handleAddClick:Ke,handleMinusClick:Je,handleAddMousedown:qe,handleMinusMousedown:We,handleKeyDown:Xe,handleUpdateDisplayedValue:Ye,mergedTheme:o,inputThemeOverrides:{paddingSmall:"0 8px 0 10px",paddingMedium:"0 8px 0 12px",paddingLarge:"0 8px 0 14px"},buttonThemeOverrides:dt(()=>{const{self:{iconColorDisabled:t}}=o.value,[s,i,r,T]=ct(t);return{textColorTextDisabled:`rgb(${s}, ${i}, ${r})`,opacityDisabled:`${T}`}})})},render(){const{mergedClsPrefix:e}=this;return $("div",{class:[`${e}-input-number`,this.rtlEnabled&&`${e}-input-number--rtl`]},$(Se,{ref:"inputInstRef",autofocus:this.autofocus,status:this.mergedStatus,bordered:this.mergedBordered,loading:this.loading,value:this.displayedValue,onUpdateValue:this.handleUpdateDisplayedValue,theme:this.mergedTheme.peers.Input,themeOverrides:this.mergedTheme.peerOverrides.Input,builtinThemeOverrides:this.inputThemeOverrides,size:this.mergedSize,placeholder:this.mergedPlaceholder,disabled:this.mergedDisabled,readonly:this.readonly,textDecoration:this.displayedValueInvalid?"line-through":void 0,onFocus:this.handleFocus,onBlur:this.handleBlur,onKeydown:this.handleKeyDown,onMousedown:this.handleMouseDown,onClear:this.handleClear,clearable:this.clearable,internalLoadingBeforeSuffix:!0},{prefix:()=>{var n,a;return(a=(n=this.$slots).prefix)===null||a===void 0?void 0:a.call(n)},suffix:()=>{var n,a;return this.showButton?[this.$slots.suffix&&$("span",{class:`${e}-input-number-suffix`},{default:this.$slots.suffix}),$(he,{text:!0,disabled:!this.minusable||this.mergedDisabled||this.readonly,focusable:!1,builtinThemeOverrides:this.buttonThemeOverrides,onClick:this.handleMinusClick,onMousedown:this.handleMinusMousedown,ref:"minusButtonInstRef"},{default:()=>$(me,{clsPrefix:e,"aria-disabled":!0},{default:()=>$(St,null)})}),$(he,{text:!0,disabled:!this.addable||this.mergedDisabled||this.readonly,focusable:!1,builtinThemeOverrides:this.buttonThemeOverrides,onClick:this.handleAddClick,onMousedown:this.handleAddMousedown,ref:"addButtonInstRef"},{default:()=>$(me,{clsPrefix:e},{default:()=>$(Rt,null)})})]:(a=(n=this.$slots).suffix)===null||a===void 0?void 0:a.call(n)}}))}});const At={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Bt=f("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M256 112v288"},null,-1),Ut=f("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M400 256H112"},null,-1),Lt=[Bt,Ut];var Me=M({name:"Add",render:function(n,a){return D(),R("svg",At,Lt)}});const Ft={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},jt=f("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M368 368L144 144"},null,-1),Ht=f("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M368 144L144 368"},null,-1),zt=[jt,Ht];var Oe=M({name:"CloseOutline",render:function(n,a){return D(),R("svg",Ft,zt)}});const Gt={class:"edit_places"},Wt={class:"places"},qt={key:0,class:"editTravelTime"},Kt={key:0,class:"travelTimeInput"},Jt=f("div",{class:"travelTimeLabel"},"Travel time",-1),Xt=S("minutes"),Yt=S("Set travel time"),Qt=f("br",null,null,-1),Zt=S("Delete this place"),en=S("Add another place");function tn(e,n,a,d,o,u){const m=h("n-divider"),b=h("n-input-number"),c=h("n-button"),v=h("n-input"),g=h("close-outline"),N=h("n-icon"),I=h("add");return D(),R("div",Gt,[f("ul",Wt,[(D(!0),R(De,null,Te(e.propPlaces,(_,w)=>(D(),R("li",{class:"place",key:w},[w>0?(D(),R("div",qt,[l(m,{class:"editPlaceDivider"}),_.travelTime!==void 0?(D(),R("div",Kt,[Jt,l(b,{placeholder:"Travel time (in minutes)",type:"text",min:0,value:_.travelTime.timeInMinutes,"onUpdate:value":p=>_.travelTime.timeInMinutes=p},{suffix:y(()=>[Xt]),_:2},1032,["value","onUpdate:value"])])):(D(),te(c,{key:1,class:"setTravelTime",type:"default",onClick:p=>e.setTravelTime(w)},{default:y(()=>[Yt]),_:2},1032,["onClick"])),l(m,{class:"editPlaceDivider"})])):Ne("",!0),f("div",{class:Ie(["editPlace","place"+w])},[l(v,{class:"inputPlaceLabel",value:_.place.label,"onUpdate:value":p=>_.place.label=p,type:"text",placeholder:"Place Name"+(w!==0?"":" (eg. Golden Gate Bridge)")},null,8,["value","onUpdate:value","placeholder"]),l(v,{class:"inputPlaceLink",value:_.place.URL,"onUpdate:value":p=>_.place.URL=p,type:"text",placeholder:"Link"+(w!==0?"":" (eg. Google Map link)")},null,8,["value","onUpdate:value","placeholder"]),Qt,l(v,{class:"inputPlaceDesc",value:_.place.description,"onUpdate:value":p=>_.place.description=p,type:"textarea",placeholder:w!==0?"Description":"Elaborate more about why you include this place in the trip!",rows:3},null,8,["value","onUpdate:value","placeholder"]),l(c,{class:"removePlace wide_button",type:"error",secondary:"",onClick:p=>e.removePlace(w)},{default:y(()=>[l(N,null,{default:y(()=>[l(g)]),_:1}),Zt]),_:2},1032,["onClick"])],2)]))),128))]),l(m,{class:"editPlaceDivider"}),l(c,{class:"addPlace wide_button",onClick:e.pushPlace},{default:y(()=>[l(N,null,{default:y(()=>[l(I)]),_:1}),en]),_:1},8,["onClick"])])}const nn=M({name:"CEditPlaces",components:{Add:Me,CloseOutline:Oe,NButton:ne,NDivider:pt,NIcon:ke,NInput:Se,NInputNumber:Et},model:{props:{propPlaces:Array()},emits:["update:propPlaces"]},props:{propPlaces:{type:Array,default:()=>[],validator:function(e){return Array.isArray(e)?(e.forEach(n=>{if(!(n instanceof pe))return!1}),!0):!1}}},methods:{pushPlace(){this.$props.propPlaces.push(new pe)},removePlace(e){this.$props.propPlaces.splice(e,1)},setTravelTime(e){const n=new et;n.toPlaceIndex=e,this.$props.propPlaces[e].travelTime=n}}});var Pe=ae(nn,[["render",tn]]);const an={class:"edit_days narrow_content"},sn={class:"editDayCardContent"},ln={class:"editDayTitle"},on=S("Delete this day"),rn=S("Add another day");function dn(e,n,a,d,o,u){const m=h("close-outline"),b=h("n-icon"),c=h("n-button"),v=h("CEditPlaces"),g=h("n-card"),N=h("add");return D(),R("div",an,[(D(!0),R(De,null,Te(e.days,(I,_)=>(D(),te(g,{class:Ie(["editDay","day"+I.dayOf]),key:I.dayOf,hoverable:"","content-style":"padding: 0"},{default:y(()=>[f("div",sn,[f("div",ln,[f("b",null,"Day "+ft(I.dayOf),1),l(c,{class:"removeDay right_button",secondary:"",type:"error",onClick:w=>e.removeDay(_)},{default:y(()=>[l(b,null,{default:y(()=>[l(m)]),_:1}),on]),_:2},1032,["onClick"])]),l(v,{class:"editPlaces",ref_for:!0,ref:"places"+_,propPlaces:I.propPlaces,"onUpdate:propPlaces":w=>I.propPlaces=w},null,8,["propPlaces","onUpdate:propPlaces"])])]),_:2},1032,["class"]))),128)),l(c,{class:"addDay right_button",onClick:n[0]||(n[0]=I=>e.pushDay())},{default:y(()=>[l(b,null,{default:y(()=>[l(N)]),_:1}),rn]),_:1})])}const un=M({components:{Add:Me,CEditPlaces:Pe,CloseOutline:Oe,NButton:ne,NCard:ht,NIcon:ke},props:{givenDays:{type:Array,required:!0}},data:()=>({days:[]}),beforeMount(){this.$data.days=this.$props.givenDays.slice(0).map(e=>new fe(e))},methods:{pushDay(){let e=new fe(new mt({places:[{}]}));e.dayOf=this.$data.days.length+1,this.$data.days.push(e)},removeDay(e){this.$data.days.splice(e,1);let n={};for(let o of this.$data.days)n[o.dayOf]=o;const a=this.$data.days.length;this.$data.days=[];let d=0;for(let o=0;o<a;o++){let u=n[o+d];for(;u==null&&o+d<a+5;)d++,u=n[o+d];u.dayOf=o+1,this.$data.days.push(u)}}}});var cn=ae(un,[["render",dn],["__scopeId","data-v-a3944dc6"]]);class pn{static getAllTypes(){return["name","description"]}constructor(n,a){this.type=n,this.label=this.getLabel(),this.value=a}getLabel(){switch(this.type){case"name":return"Name";case"description":return"Description";default:return"unknown_type"}}}class W extends $t{static fromJSON(n){return new W(n)}getObj(){return new se(JSON.parse(this.obj))}}class Ce extends Dt{}class Ve extends Tt{constructor(){super(...arguments),this.storage=Nt.TRIP,this.storeCount=10}async genFetch(n){const a=await xe(n);return It.isPWA()?a.ID!==-1?(this.storeObj(Ce,W,a.ID.toString(),Re.stringify(a)),a):null:a}static genObj(n){return new Ve().genObjImpl(Ce,W,n)}}async function xe(e){const n=await ee.genGET("v2/trip/"+e);return new se(n)}const fn={class:"edit_trip"},hn={class:"edit_form"},mn={class:"narrow_content"},vn={class:"editTripPrivacy"},gn=f("span",{class:"editLabel"},"Private:",-1),_n={class:"editInput"},yn={class:"editCity"},bn=f("span",{class:"editLabel"},"Cities:",-1),wn={class:"confirmationButtons narrow_content"},Cn=S("Save"),$n=S("Cancel"),Dn=S("Delete");function Tn(e,n,a,d,o,u){const m=h("CEditItem"),b=h("n-switch"),c=h("n-select"),v=h("CEditDays"),g=h("n-button");return D(),R("div",fn,[f("form",hn,[f("div",mn,[l(m,{className:"editTripName",label:"Name",ref:"name",val:e.trip.details.name.valueOf()},null,8,["val"]),l(m,{className:"editTripDescription",label:"Description",ref:"description",type:"textarea",val:e.trip.details.description.valueOf(),"val-max-count":e.descriptionMaxCharCount,"row-min-count":e.descriptionRowMinCount},null,8,["val","val-max-count","row-min-count"]),f("div",vn,[gn,f("div",_n,[l(b,{class:"editPrivacyToggle",value:e.private,"onUpdate:value":n[0]||(n[0]=N=>e.private=N)},null,8,["value"])])]),f("div",yn,[bn,l(c,{class:"editInput",value:e.cities,"onUpdate:value":n[1]||(n[1]=N=>e.cities=N),options:e.possibleCities,loading:e.cityLoading,filterable:"",multiple:"",placeholder:"",onSearch:e.searchCity,onUpdateValue:e.onSelect},null,8,["value","options","loading","onSearch","onUpdateValue"])])]),l(v,{ref:"days",givenDays:e.trip.details.days},null,8,["givenDays"]),f("div",wn,[l(g,{class:"saveEditTrip left_col",type:"info",onClick:e.save,loading:e.saving},{default:y(()=>[Cn]),_:1},8,["onClick","loading"]),l(g,{class:"cancelEditTrip right_col",type:"default",onClick:e.cancel},{default:y(()=>[$n]),_:1},8,["onClick"]),e.isNew?Ne("",!0):(D(),te(g,{key:0,class:"deleteTrip right_col",onClick:e.confirmDelete,type:"error",loading:e.deleting},{default:y(()=>[Dn]),_:1},8,["onClick","loading"]))])])])}const Nn=3,In=M({components:{NButton:ne,NSelect:kt,NSwitch:vt,CEditDays:cn,CEditItem:wt,CEditPlaces:Pe},props:{trip:{type:se,required:!0},isNew:{type:Boolean,required:!0}},emits:{save(e){return e.ID!==-1},cancel(){return!0}},data:()=>({cities:[],cityLoading:!1,parsedCities:[],parsedCitiesMap:new Map,possibleCities:[],private:!1,saving:!1,deleting:!1}),computed:{descriptionMaxCharCount(){return Y},descriptionRowMinCount(){return Nn}},async beforeMount(){j.init(),this.update(),await this.searchCity("")},mounted(){V.get(V.get(this,"name"),"input").focus()},methods:{cancel(){var e;V.get(this,"days").$data.days=((e=this.$props.trip.details.days)!=null?e:[]).slice(0),this.$emit("cancel")},save(){let e=new gt;if(this.$data.cities.length<1){this.showAlert("Cities cannot be empty");return}this.$data.saving=!0;let n=[];for(const b of this.$data.cities){const c=this.$data.parsedCitiesMap.get(b);if(c!==void 0)n.push(c);else{const v=new ge;v.ID=+b,n.push(v)}}e.cities=n;const a=V.getVal(this,"name"),d=V.getVal(this,"description").split(`
`).join(" ");if(!this.checkValidNameDescription(a,d)){this.$data.saving=!1;return}e.name=a,e.description=d,e.days=[];const u=V.get(this,"days");let m=0;for(const b in u.days){const c=u.days[b].toDay(),v=this.filterPlaces(c.places);if(v===null){j.dialogError({title:"Invalid Link",content:"We currently only support links to limited websites including OpenStreetMap, Google Map, Bing Maps and Yelp.",positiveText:"OK"}),this.$data.saving=!1;return}v.length>0?(c.places=v,c.dayOf=c.dayOf-m,e.days.push(c)):m++}e.private=this.$data.private,e.ID=this.$props.trip.ID,this.$emit("save",e),this.$data.saving=!1},filterPlaces(e){let n=[];for(let a of e)if(a.label=a.label.trim(),a.URL=a.URL.trim(),a.label!=="")if(a.URL===""||this.filterPlace(a))a.description=a.description.split(`
`).join(" "),n.push(a);else return null;return n},filterPlace(e){const n=["https://goo.gl/maps/","https://google.com/maps/","https://www.google.com/maps/","https://maps.google.com/","https://www.openstreetmap.org/way/","https://www.bing.com/maps?","https://www.yelp.com/biz/"];for(const a of n)if(e.URL.startsWith(a))return!0;return!1},confirmDelete(){j.dialogWarning({title:"Delete trip",content:"Are you sure you want to delete this trip? THIS PROCESS IS IRREVERSIBLE.",positiveText:"Confirm",negativeText:"Cancel",onPositiveClick:async()=>{await this.del()},onNegativeClick:async()=>{}})},async del(){this.$data.deleting=!0;let e=Boolean(await ee.genDELETE("v2/trip/"+this.$props.trip.ID,Re.stringify(this.$props.trip)));e||(e=(await xe(this.$props.trip.ID.toString())).ID===-1),this.$data.deleting=!1,j.notifyTrigger("Trip Deletion",e?"Trip is successfully deleted!":"Trip deletion attempt failed.",e?ye.SUCCESS:ye.ERROR),e&&_t.genRedirectTo(yt.Landing)},tripToItem(e){return new pn(e,this.$props.trip[e])},update(){const e=[];for(const n of this.$props.trip.details.cities)e.push(n.ID.toString());this.$data.cities=e;for(const n of this.$props.trip.details.cities)this.$data.parsedCitiesMap.set(n.ID.toString(),n),this.$data.parsedCities.push(n);this.$data.private=this.$props.trip.details.private.valueOf()},checkValidNameDescription(e,n){return!e||e.length<Ct?(this.showAlert("Trip name is too short."),!1):e.length>_e?(this.showAlert(`Trip name cannot be longer than ${_e}.`),!1):!n||n.length>Y?(this.showAlert(`Trip description cannot be longer than ${Y}.`),!1):!0},showAlert(e){j.dialogError({title:"Error",content:e,positiveText:"OK"})},async searchCity(e){this.$data.possibleCities=[];const n=[];for(const o of this.$data.parsedCities)this.$data.possibleCities.push({label:o.display.valueOf()+", "+o.iso2.valueOf(),value:o.ID.toString()}),n.push(o.ID.valueOf());this.$data.cityLoading=!0;const a=JSON.stringify(e),d=await ee.genPOST("cities",a);if(d===null){this.$data.cityLoading=!1;return}for(const o of d){const u=new ge(o);this.$data.parsedCitiesMap.set(u.ID.toString(),u),n.includes(u.ID.valueOf())||this.$data.possibleCities.push({label:u.display.valueOf()+", "+u.iso2.valueOf(),value:u.ID.toString()})}this.$data.cityLoading=!1},onSelect(e){for(const n of e){let a=!0;for(const d of this.$data.parsedCities)d.ID.toString()===n&&(a=!1);if(a){const d=this.$data.parsedCitiesMap.get(n);d!==void 0&&this.$data.parsedCities.push(d)}}for(const n of this.$data.parsedCities)for(const a of e)n.ID.toString()}}});var xn=ae(In,[["render",Tn]]);export{xn as C,Ve as T};
