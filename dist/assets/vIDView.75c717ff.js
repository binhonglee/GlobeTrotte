import{r as s,o as e,d as a,i,f as _,w as c,g as u,D as r,e as m,h,F as b,y as D,j as C,M as S,z as V,E as P,H as B,W as O}from"./vendor.7e76ed18.js";import{C as R}from"./CEditTrip.888b2a9c.js";import{C as U}from"./CPlaces.185e0ca0.js";import{C as L}from"./CLink.12667bf2.js";import{C as j,D as q}from"./DataProps.7b6fceb6.js";import{T as o,_ as v,H as A,G as f,R as g,a as E}from"./index.5f7d8ff2.js";import"./E.318fca05.js";import"./NaiveUtils.f685e1b2.js";const F={key:0,class:"view_trip"},H={class:"narrow_content"},G=h("Only you can see this trip."),W={class:"tripName left_col"},z={key:1,class:"tripDescription"},K={class:"tripCreatorInfo"},J=h("Author: "),Q={class:"tripCreatedDate"},X={class:"tripUpdatedDate"},Y={class:"tripCities"},Z={class:"viewDays"},x={class:"viewDayCardContent"},tt={class:"dayTitle"},et={class:"narrow_content"},it=h("Edit");function st(t,n,d,y,w,T){const p=s("n-alert"),$=s("CLink"),I=s("n-tag"),M=s("CPlaces"),k=s("n-card"),N=s("n-button");return t.trip!==void 0?(e(),a("div",F,[i("div",H,[t.trip.details.private?(e(),_(p,{key:0,class:"tripPrivateAlertBar",title:"Trip is private",type:"info"},{default:c(()=>[G]),_:1})):u("",!0),i("h2",W,r(t.trip.details.name),1),t.trip.details.description!==""?(e(),a("p",z,r(t.trip.details.description),1)):u("",!0),i("p",K,[J,m($,{url:"/user/"+t.trip.user.ID},{default:c(()=>[h(r(t.trip.user.name),1)]),_:1},8,["url"])]),i("p",Q,"Created on: "+r(t.trip.timeCreated.toDateString()),1),i("p",X,"Last Updated: "+r(t.trip.lastUpdated.toDateString()),1),i("div",Y,[(e(!0),a(b,null,D(t.cities,l=>(e(),_(I,{class:"tripCity",type:"info"},{default:c(()=>[h(r(l),1)]),_:2},1024))),256))])]),i("div",Z,[(e(!0),a(b,null,D(t.days,l=>(e(),_(k,{class:"viewDayCard",key:l.ID.valueOf(),"content-style":"padding: 0"},{default:c(()=>[i("div",x,[i("h3",tt,"Day "+r(l.dayOf),1),m(M,{propPlaces:l.propPlaces},null,8,["propPlaces"])])]),_:2},1024))),128))]),i("div",et,[t.editable?(e(),_(N,{key:0,class:"enableTripEdit right_col",onClick:t.enableEditMode},{default:c(()=>[it]),_:1},8,["onClick"])):u("",!0)])])):u("",!0)}const at=C({name:"CViewTrip",components:{CLink:L,CPlaces:U,NAlert:S,NButton:V,NCard:P,NTag:B},props:{trip:{type:o,required:!0},editable:{type:Boolean}},emits:{enableEditMode(){return!0}},data:()=>({days:[],cities:[]}),beforeMount(){if(this.$data.cities=[],this.$props.trip!==void 0){for(let t of this.$props.trip.details.cities)this.$data.cities.push(j.toString(t));this.$data.days=this.$props.trip.details.days.slice(0).map(t=>new q(t))}},methods:{enableEditMode(){this.$emit("enableEditMode")}}});var rt=v(at,[["render",st],["__scopeId","data-v-432d0304"]]);const ot={class:"trip_info narrow_display_window"},nt={key:0,class:"view_trip_info"},dt={key:1,class:"edit_trip_info"};function pt(t,n,d,y,w,T){const p=s("CViewTrip"),$=s("CEditTrip");return e(),a("div",ot,[t.editMode?(e(),a("div",dt,[m($,{trip:t.dtrip,isNew:!1,onSave:t.save,onCancel:t.cancel},null,8,["trip","onSave","onCancel"])])):(e(),a("div",nt,[m(p,{trip:t.dtrip,editable:t.editable,onEnableEditMode:t.enableEditMode},null,8,["trip","editable","onEnableEditMode"])]))])}const lt=C({name:"CTripInfo",components:{CViewTrip:rt,CEditTrip:R},props:{trip:{type:o,required:!0},editable:{type:Boolean}},data:()=>({editMode:!1,dtrip:new o}),beforeMount(){this.$data.editMode=!1,this.$data.dtrip=this.$props.trip},methods:{async save(t){const n=this.$props.trip;n.details=t;const d=await A.genPOST("v2/trip/"+t.ID,O.stringify(n));d?(this.$data.dtrip=new o(d),this.$data.editMode=!1):this.$alert("Save was unsuccessful. Please try again later.","Fail",{confirmButtonText:"OK"})},cancel(){this.$data.editMode=!1},enableEditMode(){this.$data.editMode=!0}}});var ct=v(lt,[["render",pt]]);const _t={class:"get_view_trip"},ut=i("h1",{class:"title"},"Trip",-1);function ht(t,n,d,y,w,T){const p=s("CTripInfo");return e(),a("div",_t,[ut,t.trip.ID!==-1?(e(),_(p,{key:0,trip:t.trip,editable:t.owner},null,8,["trip","editable"])):u("",!0)])}const ft=C({components:{CTripInfo:ct},data(){return{inputID:"",trip:new o,owner:!1}},async beforeMount(){await this.init()},methods:{async init(){const t=f.paramID();if(t===void 0){this.$data.trip=new o,await g.genRedirectTo(E.trip_Search);return}if(this.$data.inputID=t,this.$data.trip=await f.genTrip(Number(t)),this.$data.trip.ID!==-1){this.$data.owner=f.getIsCurrentUser(this.$data.trip.user.ID.valueOf());return}this.$notify(f.notifConfig("Error","Trip not found.","error")),await g.genRedirectTo(E.trip_Search)}}});var Dt=v(ft,[["render",ht]]);export{Dt as default};
