import{r as s,o as g,c as E,a as o,h as y,l as N,e as n,w as c,p as B,b as L,i as p,_ as $,d as I,aY as b,N as P,k as S,G as T,R as f,j as V,aX as h,b9 as R,b7 as U}from"./index.52ef9f93.js";import{C as H,E as t}from"./E.071947bd.js";import{C as G}from"./CLink.777a1a87.js";import{N as m}from"./NaiveUtils.455af69d.js";import{C as A}from"./CHead.affcb33d.js";import"./Input.1804a610.js";class M{constructor(a){this.email="",this.password="",a&&(this.email=a.email!==void 0&&a.email!==null?a.email:"",this.password=a.password!==void 0&&a.password!==null?a.password:"")}toJsonKey(a){switch(a){case"email":return"email";case"password":return"password";default:return a}}}const w=e=>(B("data-v-db068dfa"),e=e(),L(),e),O={class:"login narrow_content"},W=w(()=>n("h1",{class:"title"},"Login",-1)),Y={class:"narrow_display_window"},q=w(()=>n("br",null,null,-1)),x=p("Confirm"),D=p("Cancel"),F={class:"forgotPassword"},J=p("Forgot Password?");function K(e,a,r,i,l,d){const C=s("CHead"),k=s("n-alert"),_=s("CEditItem"),u=s("n-button"),v=s("CLink");return g(),E("div",O,[o(C,{title:"Login",description:"Login to your GlobeTrotte account."}),W,e.showError?(g(),y(k,{key:0,class:"tripPrivateAlertBar",title:"Please login to continue.",type:"error"})):N("",!0),n("form",Y,[o(_,{class:"loginUsernameItem",label:"Email",ref:"email",className:"loginUsername",onEnter:e.confirm},null,8,["onEnter"]),o(_,{label:"Password",ref:"password",className:"loginPassword",type:"password",onEnter:e.confirm},null,8,["onEnter"]),q,o(u,{class:"loginConfirm left_col",type:"info",onClick:e.confirm,loading:e.loading},{default:c(()=>[x]),_:1},8,["onClick","loading"]),o(u,{class:"loginCancel right_col",type:"default",onClick:e.cancel},{default:c(()=>[D]),_:1},8,["onClick"])]),n("p",F,[o(v,{url:e.resetLink},{default:c(()=>[J]),_:1},8,["url"])])])}const X=I({components:{CEditItem:H,CLink:G,NAlert:b,NButton:P,CHead:A},data(){return{loading:!1,showError:!1,resetLink:S.password_Reset,loadingBar:T.loadingBar()}},beforeMount(){f.hasNext()&&(this.$data.showError=!0),m.init()},mounted(){t.get(t.get(this,"email"),"input").focus()},methods:{async confirm(){var i,l,d;this.$data.loading=!0,(i=this.$data.loadingBar)==null||i.start();const e=new M({email:t.getVal(this,"email"),password:t.getVal(this,"password")}),a=await V.genPOST("login",h.stringify(e)),r=new R(a);if(r.ID===-1){(l=this.$data.loadingBar)==null||l.error(),this.$data.loading=!1,m.messageError("Wrong email or password. Please try again.");return}(d=this.$data.loadingBar)==null||d.finish(),localStorage.setItem("userobj",h.stringify(r)),this.$data.loading=!1,m.messageSuccess("You are now logged in."),await f.paramToNext(new Map,!0)},cancel(){U.back()}}});var oe=$(X,[["render",K],["__scopeId","data-v-db068dfa"]]);export{oe as default};
