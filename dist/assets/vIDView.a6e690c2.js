import{C as R}from"./CHead.45115d84.js";import{r as a,o as e,c as s,e as i,h as f,w as h,l as m,t as r,a as n,i as C,F as b,g,d as y,N as V,m as L,T as d,j as k,k as $,G as o,_ as v,aW as B,R as I}from"./index.df8f32b6.js";import{C as O}from"./CEditTrip.b6ef916f.js";import{C as P}from"./CPlaces.77bc7894.js";import{C as A}from"./CLink.81ee42b8.js";import{C as H}from"./CShare.9d268dbd.js";import{N as j,C as q,D as F}from"./DataProps.75455f2e.js";import{N as G}from"./Alert.33716964.js";import"./Input.33705439.js";import"./E.66cd6ce1.js";import"./NaiveUtils.465b9ff5.js";import"./Select.e71cd79d.js";const W={key:0,class:"view_trip"},K={class:"narrow_content"},z=C("Only you can see this trip."),J={class:"tripName left_col"},Q={key:1,class:"tripDescription"},X={class:"tripCreatorInfo"},Y=C("Author: "),Z={class:"tripUpdatedDate"},x={class:"tripCreatedDate"},tt={class:"tripCities"},et={class:"viewDays"},it={class:"viewDayCardContent"},at={class:"dayTitle"},st={class:"narrow_content enableTripEdit"},rt=C("Edit");function ot(t,p,l,w,T,D){const c=a("n-alert"),_=a("CLink"),E=a("n-tag"),M=a("CShare"),U=a("CPlaces"),N=a("n-card"),S=a("n-button");return t.trip!==void 0?(e(),s("div",W,[i("div",K,[t.trip.details.private?(e(),f(c,{key:0,class:"tripPrivateAlertBar",title:"Trip is private",type:"info"},{default:h(()=>[z]),_:1})):m("",!0),i("h2",J,r(t.trip.details.name),1),t.trip.details.description!==""?(e(),s("p",Q,r(t.trip.details.description),1)):m("",!0),i("p",X,[Y,n(_,{url:"/user/"+t.trip.user.ID},{default:h(()=>[C(r(t.trip.user.name),1)]),_:1},8,["url"])]),i("p",Z,"Last Updated: "+r(t.lastUpdated),1),i("p",x,"Created on: "+r(t.created),1),i("div",tt,[(e(!0),s(b,null,g(t.cities,u=>(e(),f(E,{class:"tripCity",type:"info"},{default:h(()=>[C(r(u),1)]),_:2},1024))),256))]),n(M,{shareURL:t.shareURL},null,8,["shareURL"])]),i("div",et,[(e(!0),s(b,null,g(t.days,u=>(e(),f(N,{class:"viewDayCard",key:u.ID.valueOf(),"content-style":"padding: 0"},{default:h(()=>[i("div",it,[i("h3",at,"Day "+r(u.dayOf),1),n(U,{propPlaces:u.propPlaces},null,8,["propPlaces"])])]),_:2},1024))),128))]),i("div",st,[t.editable?(e(),f(S,{key:0,class:"editTripButton right_col",onClick:t.enableEditMode},{default:h(()=>[rt]),_:1},8,["onClick"])):m("",!0)])])):m("",!0)}const nt=y({name:"CViewTrip",components:{CLink:A,CPlaces:P,CShare:H,NAlert:G,NButton:V,NCard:L,NTag:j},props:{trip:{type:d,required:!0},editable:{type:Boolean}},emits:{enableEditMode(){return!0}},data:()=>({days:[],cities:[],shareURL:"",created:"",lastUpdated:""}),beforeMount(){this.$data.cities=[];for(let t of this.$props.trip.details.cities)this.$data.cities.push(q.toString(t));this.$data.days=this.$props.trip.details.days.slice(0).map(t=>new F(t)),this.$data.shareURL=k.getAbsoluteURL($.trip_View,this.$props.trip.ID.toString()),this.$data.created=o.getDisplayDate(this.$props.trip.timeCreated),this.$data.lastUpdated=o.getDisplayDate(this.$props.trip.lastUpdated)},methods:{enableEditMode(){this.$emit("enableEditMode")}}});var dt=v(nt,[["render",ot],["__scopeId","data-v-d171f4f6"]]);const pt={class:"trip_info narrow_display_window"},lt={key:0,class:"view_trip_info"},ct={key:1,class:"edit_trip_info"};function _t(t,p,l,w,T,D){const c=a("CViewTrip"),_=a("CEditTrip");return e(),s("div",pt,[t.editMode?(e(),s("div",ct,[n(_,{trip:t.dtrip,isNew:!1,onSave:t.save,onCancel:t.cancel},null,8,["trip","onSave","onCancel"])])):(e(),s("div",lt,[n(c,{trip:t.dtrip,editable:t.editable,onEnableEditMode:t.enableEditMode},null,8,["trip","editable","onEnableEditMode"])]))])}const ut=y({name:"CTripInfo",components:{CViewTrip:dt,CEditTrip:O},props:{trip:{type:d,required:!0},editable:{type:Boolean}},data:()=>({editMode:!1,dtrip:new d}),beforeMount(){this.$data.editMode=!1,this.$data.dtrip=this.$props.trip},methods:{async save(t){const p=this.$props.trip;p.details=t;const l=await k.genPOST("v2/trip/"+t.ID,B.stringify(p));l?(this.$data.dtrip=new d(l),this.$data.editMode=!1):this.$alert("Save was unsuccessful. Please try again later.","Fail",{confirmButtonText:"OK"})},cancel(){this.$data.editMode=!1},enableEditMode(){this.$data.editMode=!0}}});var ht=v(ut,[["render",_t]]);const ft={class:"get_view_trip"},mt=i("h1",{class:"title"},"Trip",-1);function Ct(t,p,l,w,T,D){const c=a("CHead"),_=a("CTripInfo");return e(),s("div",ft,[n(c,{title:t.trip.details.name.valueOf(),description:t.trip.details.description.valueOf(),type:"article"},null,8,["title","description"]),mt,t.trip.ID!==-1?(e(),f(_,{key:0,trip:t.trip,editable:t.owner},null,8,["trip","editable"])):m("",!0)])}const $t=y({components:{CHead:R,CTripInfo:ht},data(){return{inputID:"",trip:new d,owner:!1}},async beforeMount(){await this.init()},methods:{async init(){const t=o.paramID();if(t===void 0){this.$data.trip=new d,await I.genRedirectTo($.trip_Search);return}if(this.$data.inputID=t,this.$data.trip=await o.genTrip(Number(t)),this.$data.trip.ID!==-1){this.$data.owner=o.getIsCurrentUser(this.$data.trip.user.ID.valueOf());return}this.$notify(o.notifConfig("Error","Trip not found.","error")),await I.genRedirectTo($.trip_Search)}}});var Nt=v($t,[["render",Ct]]);export{Nt as default};
