import{d as y,a_ as N,N as v,g as B,G as L,R as u,f as $,aV as f,b8 as I,b6 as P,r as a,o as h,c as b,a as s,j as S,q as V,e as n,w as c,p as T,b as R,k as p,_ as U}from"./index.880ce31d.js";import{C as H,E as t}from"./CEditItem.cba84675.js";import{C as G}from"./CLink.48361ed1.js";import{N as m}from"./NaiveUtils.8a94fd3c.js";import{C as q}from"./CHead.4b0784a2.js";import"./Input.e30776b5.js";class A{constructor(o){this.email="",this.password="",o&&(this.email=o.email!==void 0&&o.email!==null?o.email:"",this.password=o.password!==void 0&&o.password!==null?o.password:"")}toJsonKey(o){switch(o){case"email":return"email";case"password":return"password";default:return o}}}const M=y({components:{CEditItem:H,CLink:G,NAlert:N,NButton:v,CHead:q},data(){return{loading:!1,showError:!1,resetLink:B.password_Reset,loadingBar:L.loadingBar()}},beforeMount(){u.hasNext()&&(this.$data.showError=!0),m.init()},mounted(){t.get(t.get(this,"email"),"input").focus()},methods:{async confirm(){var i,l,d;this.$data.loading=!0,(i=this.$data.loadingBar)==null||i.start();const e=new A({email:t.getVal(this,"email"),password:t.getVal(this,"password")}),o=await $.genPOST("login",f.stringify(e)),r=new I(o);if(r.ID===-1){(l=this.$data.loadingBar)==null||l.error(),this.$data.loading=!1,m.messageError("Wrong email or password. Please try again.");return}(d=this.$data.loadingBar)==null||d.finish(),localStorage.setItem("userobj",f.stringify(r)),this.$data.loading=!1,m.messageSuccess("You are now logged in."),await u.paramToNext(new Map,!0)},cancel(){P.back()}}}),w=e=>(T("data-v-1d669480"),e=e(),R(),e),O={class:"login narrow_content"},W=w(()=>n("h1",{class:"title"},"Login",-1)),x={class:"narrow_display_window"},D=w(()=>n("br",null,null,-1)),F=p("Confirm"),J=p("Cancel"),K={class:"forgotPassword"},Y=p("Forgot Password?");function z(e,o,r,i,l,d){const C=a("CHead"),k=a("n-alert"),_=a("CEditItem"),g=a("n-button"),E=a("CLink");return h(),b("div",O,[s(C,{title:"Login",description:"Login to your GlobeTrotte account."}),W,e.showError?(h(),S(k,{key:0,class:"tripPrivateAlertBar",title:"Please login to continue.",type:"error"})):V("",!0),n("form",x,[s(_,{class:"loginUsernameItem",label:"Email",ref:"email",className:"loginUsername",onEnter:e.confirm},null,8,["onEnter"]),s(_,{label:"Password",ref:"password",className:"loginPassword",type:"password",onEnter:e.confirm},null,8,["onEnter"]),D,s(g,{class:"loginConfirm left_col",type:"info",onClick:e.confirm,loading:e.loading},{default:c(()=>[F]),_:1},8,["onClick","loading"]),s(g,{class:"loginCancel right_col",type:"default",onClick:e.cancel},{default:c(()=>[J]),_:1},8,["onClick"])]),n("p",K,[s(E,{url:e.resetLink},{default:c(()=>[Y]),_:1},8,["url"])])])}const se=U(M,[["render",z],["__scopeId","data-v-1d669480"]]);export{se as default};
