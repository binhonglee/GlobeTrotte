import{C as V}from"./CHead.6815b5d8.js";import{r as o,o as a,c as n,e as i,a as e,F as b,g as I,w as l,p as B,b as O,d as v,m as N,q as P,_ as y,h as _,l as C,t as d,i as $,N as A,T as u,j as S,k,G as h,aX as q,R as E}from"./index.7468df66.js";import{N as H,C as j}from"./CPlaces.46261685.js";import{C as x}from"./CEditTrip.7f6b1bdf.js";import{C as F}from"./CLink.b96becef.js";import{C as G}from"./CShare.bd7282d6.js";import{N as K,C as W,D as X}from"./DataProps.5928c7a8.js";import{N as z}from"./Alert.97d966d1.js";import"./Input.1981449a.js";import"./E.8edf71d6.js";import"./NaiveUtils.4ae151f9.js";import"./Select.8dffc0b0.js";const L=t=>(B("data-v-da09f6ba"),t=t(),O(),t),J={class:"loading_trip_info narrow_display_window"},Q={class:"narrow_content"},Y={class:"row"},Z=L(()=>i("p",{class:"tripCreatorInfo"},"Author:",-1)),tt={class:"row"},et=L(()=>i("p",{class:"tripUpdatedDate"},"Last Updated:",-1)),it={class:"row"},st=L(()=>i("p",{class:"tripCreatedDate"},"Created on:",-1)),at={class:"loadingDays"};function ot(t,p,c,w,g,T){const s=o("n-skeleton"),r=o("n-divider"),f=o("n-card");return a(),n("div",J,[i("div",Q,[e(s,{height:"40px"}),e(s,{text:""}),i("div",Y,[Z,e(s,{class:"inline_text",text:"",width:"30%"})]),i("div",tt,[et,e(s,{class:"inline_text",text:"",width:"30%"})]),i("div",it,[st,e(s,{class:"inline_text",text:"",width:"30%"})]),e(s,{class:"cities",height:"28px",width:"200px"}),e(s,{class:"share",height:"35px",width:"75px"})]),i("div",at,[(a(),n(b,null,I(3,D=>e(f,{class:"loadingDayCard",key:D,"content-style":"padding: 0"},{default:l(()=>[e(s,{class:"loadingDayTitle",height:"20px"}),e(r),e(s,{class:"loadingDayText",text:"",row:2}),e(r),e(s,{class:"loadingDayText lastLoadingDayText",text:"",row:2})]),_:2},1024)),64))])])}const nt=v({name:"CLoadingTripInfo",components:{NCard:N,NDivider:P,NSkeleton:H}});var rt=y(nt,[["render",ot],["__scopeId","data-v-da09f6ba"]]);const dt={key:0,class:"view_trip"},pt={class:"narrow_content"},ct=$("Only you can see this trip."),lt={class:"tripName left_col"},_t={key:1,class:"tripDescription"},ht={class:"tripCreatorInfo"},ut=$("Author: "),ft={class:"tripUpdatedDate"},mt={class:"tripCreatedDate"},$t={class:"tripCities"},Ct={class:"viewDays"},vt={class:"viewDayCardContent"},yt={class:"dayTitle"},wt={class:"narrow_content enableTripEdit"},gt=$("Edit");function Tt(t,p,c,w,g,T){const s=o("n-alert"),r=o("CLink"),f=o("n-tag"),D=o("CShare"),U=o("CPlaces"),M=o("n-card"),R=o("n-button");return t.trip!==void 0?(a(),n("div",dt,[i("div",pt,[t.trip.details.private?(a(),_(s,{key:0,class:"tripPrivateAlertBar",title:"Trip is private",type:"info"},{default:l(()=>[ct]),_:1})):C("",!0),i("h2",lt,d(t.trip.details.name),1),t.trip.details.description!==""?(a(),n("p",_t,d(t.trip.details.description),1)):C("",!0),i("p",ht,[ut,e(r,{url:"/user/"+t.trip.user.ID},{default:l(()=>[$(d(t.trip.user.name),1)]),_:1},8,["url"])]),i("p",ft,"Last Updated: "+d(t.lastUpdated),1),i("p",mt,"Created on: "+d(t.created),1),i("div",$t,[(a(!0),n(b,null,I(t.cities,m=>(a(),_(f,{class:"tripCity",type:"info"},{default:l(()=>[$(d(m),1)]),_:2},1024))),256))]),e(D,{shareURL:t.shareURL},null,8,["shareURL"])]),i("div",Ct,[(a(!0),n(b,null,I(t.days,m=>(a(),_(M,{class:"viewDayCard",key:m.ID.valueOf(),"content-style":"padding: 0"},{default:l(()=>[i("div",vt,[i("h3",yt,"Day "+d(m.dayOf),1),e(U,{propPlaces:m.propPlaces},null,8,["propPlaces"])])]),_:2},1024))),128))]),i("div",wt,[t.editable?(a(),_(R,{key:0,class:"editTripButton right_col",onClick:t.enableEditMode},{default:l(()=>[gt]),_:1},8,["onClick"])):C("",!0)])])):C("",!0)}const Dt=v({name:"CViewTrip",components:{CLink:F,CPlaces:j,CShare:G,NAlert:z,NButton:A,NCard:N,NTag:K},props:{trip:{type:u,required:!0},editable:{type:Boolean}},emits:{enableEditMode(){return!0}},data:()=>({days:[],cities:[],shareURL:"",created:"",lastUpdated:""}),beforeMount(){this.$data.cities=[];for(let t of this.$props.trip.details.cities)this.$data.cities.push(W.toString(t));this.$data.days=this.$props.trip.details.days.slice(0).map(t=>new X(t)),this.$data.shareURL=S.getAbsoluteURL(k.trip_View,this.$props.trip.ID.toString()),this.$data.created=h.getDisplayDate(this.$props.trip.timeCreated),this.$data.lastUpdated=h.getDisplayDate(this.$props.trip.lastUpdated)},methods:{enableEditMode(){this.$emit("enableEditMode")}}});var bt=y(Dt,[["render",Tt],["__scopeId","data-v-d171f4f6"]]);const It={class:"trip_info narrow_display_window"},kt={key:0,class:"view_trip_info"},Lt={key:1,class:"edit_trip_info"};function Et(t,p,c,w,g,T){const s=o("CViewTrip"),r=o("CEditTrip");return a(),n("div",It,[t.editMode?(a(),n("div",Lt,[e(r,{trip:t.dtrip,isNew:!1,onSave:t.save,onCancel:t.cancel},null,8,["trip","onSave","onCancel"])])):(a(),n("div",kt,[e(s,{trip:t.dtrip,editable:t.editable,onEnableEditMode:t.enableEditMode},null,8,["trip","editable","onEnableEditMode"])]))])}const Nt=v({name:"CTripInfo",components:{CViewTrip:bt,CEditTrip:x},props:{trip:{type:u,required:!0},editable:{type:Boolean}},data:()=>({editMode:!1,dtrip:new u}),beforeMount(){this.$data.editMode=!1,this.$data.dtrip=this.$props.trip},methods:{async save(t){const p=this.$props.trip;p.details=t;const c=await S.genPOST("v2/trip/"+t.ID,q.stringify(p));c?(this.$data.dtrip=new u(c),this.$data.editMode=!1):this.$alert("Save was unsuccessful. Please try again later.","Fail",{confirmButtonText:"OK"})},cancel(){this.$data.editMode=!1},enableEditMode(){this.$data.editMode=!0}}});var St=y(Nt,[["render",Et]]);const Ut={class:"get_view_trip"},Mt=i("h1",{class:"title"},"Trip",-1);function Rt(t,p,c,w,g,T){const s=o("CHead"),r=o("CLoadingTripInfo"),f=o("CTripInfo");return a(),n("div",Ut,[e(s,{title:t.trip.details.name.valueOf(),description:t.trip.details.description.valueOf(),type:"article"},null,8,["title","description"]),Mt,t.trip.ID===-1?(a(),_(r,{key:0})):(a(),_(f,{key:1,trip:t.trip,editable:t.owner},null,8,["trip","editable"]))])}const Vt=v({components:{CHead:V,CLoadingTripInfo:rt,CTripInfo:St},data(){return{inputID:"",trip:new u,owner:!1}},async created(){await this.init()},methods:{async init(){const t=h.paramID();if(t===void 0){this.$data.trip=new u,await E.genRedirectTo(k.trip_Search);return}if(this.$data.inputID=t,this.$data.trip=await h.genTrip(Number(t)),this.$data.trip.ID!==-1){this.$data.owner=h.getIsCurrentUser(this.$data.trip.user.ID.valueOf());return}this.$notify(h.notifConfig("Error","Trip not found.","error")),await E.genRedirectTo(k.trip_Search)}}});var Xt=y(Vt,[["render",Rt]]);export{Xt as default};
