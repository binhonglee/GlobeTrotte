import{C as x}from"./CHead-DB__Oa_T.js";import{d as v,c as d,b as s,o as n,l as H,m as M,a as i,r as o,F as b,g as I,f as p,_ as T,n as A,p as j,B as q,N,H as S,e as E,G as g,q as $,i as _,t as c,h as y,j as z,R as O}from"./index-CVwEz7sZ.js";import{N as F,C as G}from"./CPlaces-DBdQOhbq.js";import{C as K,T as W}from"./CEditTrip-DKAK3eyx.js";import{C as J}from"./CLink-BZ5D-za9.js";import{C as Q}from"./CShare-BGpHMHTP.js";import{N as X,D as Y}from"./DataProps-DCopCXR4.js";import{T as h}from"./TripObj-B2zgwhZc.js";import{N as C,a as Z}from"./NaiveUtils-CaBEIltk.js";import{s as tt}from"./TripUtil-DgNcC7ap.js";import"./Input-B0b2FwEY.js";import"./CEditItem-CkORRj5K.js";import"./UserUtil-BfIc5bHd.js";import"./Select-BH-AmpZh.js";const et={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},it=v({name:"EllipsisHorizontalOutline",render:function(e,r){return n(),d("svg",et,r[0]||(r[0]=[s("circle",{cx:"256",cy:"256",r:"32",fill:"none",stroke:"currentColor","stroke-miterlimit":"10","stroke-width":"32"},null,-1),s("circle",{cx:"416",cy:"256",r:"32",fill:"none",stroke:"currentColor","stroke-miterlimit":"10","stroke-width":"32"},null,-1),s("circle",{cx:"96",cy:"256",r:"32",fill:"none",stroke:"currentColor","stroke-miterlimit":"10","stroke-width":"32"},null,-1)]))}}),st=v({name:"CLoadingTripInfo",components:{NCard:M,NDivider:H,NSkeleton:F}}),ot={class:"loading_trip_info narrow_display_window"},nt={class:"narrow_content"},at={class:"row"},rt={class:"row"},dt={class:"row"},pt={class:"loadingDays"};function lt(t,e,r,u,k,D){const a=o("n-skeleton"),l=o("n-divider"),m=o("n-card");return n(),d("div",ot,[s("div",nt,[i(a,{height:"40px"}),i(a,{text:""}),s("div",at,[e[0]||(e[0]=s("p",{class:"tripCreatorInfo"},"Author:",-1)),i(a,{class:"inline_text",text:"",width:"30%"})]),s("div",rt,[e[1]||(e[1]=s("p",{class:"tripUpdatedDate"},"Last Updated:",-1)),i(a,{class:"inline_text",text:"",width:"30%"})]),s("div",dt,[e[2]||(e[2]=s("p",{class:"tripCreatedDate"},"Created on:",-1)),i(a,{class:"inline_text",text:"",width:"30%"})]),i(a,{class:"cities",height:"28px",width:"200px"}),i(a,{class:"share",height:"35px",width:"75px"})]),s("div",pt,[(n(),d(b,null,I(3,f=>i(m,{class:"loadingDayCard",key:f,"content-style":"padding: 0"},{default:p(()=>[i(a,{class:"loadingDayTitle",height:"20px"}),i(l),i(a,{class:"loadingDayText",text:"",row:2}),i(l),i(a,{class:"loadingDayText lastLoadingDayText",text:"",row:2})]),_:2},1024)),64))])])}const ct=T(st,[["render",lt],["__scopeId","data-v-cba37515"]]),ut=v({name:"CViewTrip",components:{CLink:J,CPlaces:G,CShare:Q,EllipsisHorizontalOutline:it,NAlert:N,NButton:q,NCard:M,NDropdown:j,NIcon:A,NTag:X},props:{trip:{type:h,required:!0},editable:{type:Boolean}},emits:{enableEditMode(){return!0}},data:()=>({days:[],cities:[],shareURL:"",created:"",lastUpdated:"",menuOptions:[]}),beforeMount(){this.$data.cities=[];for(const t of this.$props.trip.details.cities)this.$data.cities.push(t.display.valueOf()+", "+t.iso2.valueOf());this.$data.days=this.$props.trip.details.days.slice(0).map(t=>new Y(t)),this.$data.shareURL=S.getAbsoluteURL(E.trip_View,this.$props.trip.ID.toString()),this.$data.created=g.getDisplayDate(this.$props.trip.timeCreated),this.$data.lastUpdated=g.getDisplayDate(this.$props.trip.lastUpdated),this.$props.editable&&this.$data.menuOptions.push({label:"Edit",key:"edit"})},methods:{handleSelectMenu(t){switch(t){case"bookmark":return this.bookmark();case"edit":return this.enableEditMode()}},enableEditMode(){this.$emit("enableEditMode")},bookmark(){}}}),_t={key:0,class:"view_trip"},ht={class:"narrow_content"},mt={class:"tripName left_col"},ft={key:2,class:"tripDescription"},wt={class:"tripCreatorInfo"},$t={class:"tripUpdatedDate"},yt={class:"tripCreatedDate"},Ct={class:"tripCities"},vt={class:"viewDays"},gt={class:"viewDayCardContent"},Tt={class:"dayTitle"};function kt(t,e,r,u,k,D){const a=o("n-alert"),l=o("ellipsis-horizontal-outline"),m=o("n-icon"),f=o("n-button"),U=o("n-dropdown"),L=o("CLink"),R=o("n-tag"),P=o("CShare"),B=o("CPlaces"),V=o("n-card");return t.trip!==void 0?(n(),d("div",_t,[s("div",ht,[t.trip.details.private?(n(),_(a,{key:0,class:"tripPrivateAlertBar",title:"Trip is private",type:"info"},{default:p(()=>e[0]||(e[0]=[y("Only you can see this trip.")])),_:1})):$("",!0),s("h2",mt,c(t.trip.details.name),1),t.menuOptions.length>0?(n(),_(U,{key:1,trigger:"click",options:t.menuOptions,"show-arrow":!0,onSelect:t.handleSelectMenu},{default:p(()=>[i(f,{class:"right_col tripMenu"},{default:p(()=>[i(m,null,{default:p(()=>[i(l)]),_:1})]),_:1})]),_:1},8,["options","onSelect"])):$("",!0),t.trip.details.description!==""?(n(),d("p",ft,c(t.trip.details.description),1)):$("",!0),s("p",wt,[e[1]||(e[1]=y("Author: ")),i(L,{url:"/user/"+(t.trip.user.username.valueOf()===""?t.trip.user.ID.toString():t.trip.user.username.toString())},{default:p(()=>[y(c(t.trip.user.name),1)]),_:1},8,["url"])]),s("p",$t,"Last Updated: "+c(t.lastUpdated),1),s("p",yt,"Created on: "+c(t.created),1),s("div",Ct,[(n(!0),d(b,null,I(t.cities,w=>(n(),_(R,{class:"tripCity",type:"info"},{default:p(()=>[y(c(w),1)]),_:2},1024))),256))]),i(P,{shareURL:t.shareURL},null,8,["shareURL"])]),s("div",vt,[(n(!0),d(b,null,I(t.days,w=>(n(),_(V,{class:"viewDayCard",key:w.ID.valueOf(),"content-style":"padding: 0"},{default:p(()=>[s("div",gt,[s("h3",Tt,"Day "+c(w.dayOf),1),i(B,{propPlaces:w.propPlaces},null,8,["propPlaces"])])]),_:2},1024))),128))])])):$("",!0)}const Dt=T(ut,[["render",kt],["__scopeId","data-v-1ae2c911"]]),bt=v({name:"CTripInfo",components:{CViewTrip:Dt,CEditTrip:K},props:{trip:{type:h,required:!0},editable:{type:Boolean}},data:()=>({editMode:!1,dtrip:new h}),beforeMount(){this.$data.editMode=!1,this.$data.dtrip=this.$props.trip,C.init()},methods:{async save(t){const e=this.$props.trip;e.details=t;const r=await S.genPOST("v2/trip/"+t.ID,z.WingsStructUtil.stringify(e));if(r){const u=new h(r);u.ID!==-1?(this.$data.dtrip=u,this.$data.editMode=!1):C.dialogError({title:"Error",content:"Save was unsuccessful. Please try again later.",positiveText:"OK"})}else C.dialogError({title:"Error",content:"Save was unsuccessful. Please try again later.",positiveText:"OK"})},cancel(){this.$data.editMode=!1},enableEditMode(){this.$data.editMode=!0}}}),It={class:"trip_info narrow_display_window"},Et={key:0,class:"view_trip_info"},Ot={key:1,class:"edit_trip_info"};function Mt(t,e,r,u,k,D){const a=o("CViewTrip"),l=o("CEditTrip");return n(),d("div",It,[t.editMode?(n(),d("div",Ot,[i(l,{trip:t.dtrip,isNew:!1,onSave:t.save,onCancel:t.cancel},null,8,["trip","onSave","onCancel"])])):(n(),d("div",Et,[i(a,{trip:t.dtrip,editable:t.editable,onEnableEditMode:t.enableEditMode},null,8,["trip","editable","onEnableEditMode"])]))])}const Nt=T(bt,[["render",Mt]]),St=v({components:{CHead:x,CLoadingTripInfo:ct,CTripInfo:Nt,NAlert:N},data(){return{inputID:"",trip:new h,updated:null,owner:!1}},beforeMount(){C.init()},async mounted(){await this.init()},methods:{async init(){const t=g.paramID();if(t===void 0){this.$data.trip=new h,await O.genRedirectTo(E.trip_Search);return}this.$data.inputID=t;const e=await W.genObj(t);if(e.completed!==null&&(this.$data.trip=e.completed),e.promise!==null){const r=await e.promise;r!==null&&!tt(r,this.$data.trip)&&(this.$data.updated=r)}if(this.$data.trip.ID!==-1){this.$data.owner=g.getIsCurrentUser(this.$data.trip.user.ID.valueOf());return}C.notifyTrigger("Error","Trip not found.",Z.ERROR),await O.genRedirectTo(E.trip_Search)},update(){this.$data.updated!==null&&(this.$data.trip=this.$data.updated),this.$data.updated=null}}}),Ut={class:"get_view_trip"},Lt={key:0,class:"narrow_content tapToUpdate"};function Rt(t,e,r,u,k,D){const a=o("CHead"),l=o("n-alert"),m=o("CLoadingTripInfo"),f=o("CTripInfo");return n(),d("div",Ut,[i(a,{title:t.trip.details.name.valueOf(),description:t.trip.details.description.valueOf(),type:"article"},null,8,["title","description"]),t.updated!==null?(n(),d("div",Lt,[i(l,{title:"There's an update!",type:"warning",onClick:t.update},{default:p(()=>e[0]||(e[0]=[y("Press here to view latest version of this profile.")])),_:1},8,["onClick"])])):$("",!0),e[1]||(e[1]=s("h1",{class:"title"},"Trip",-1)),t.trip.ID===-1?(n(),_(m,{key:1})):(n(),_(f,{key:2,trip:t.trip,editable:t.owner},null,8,["trip","editable"]))])}const Qt=T(St,[["render",Rt],["__scopeId","data-v-c201b12f"]]);export{Qt as default};
