var k=Object.defineProperty;var y=(a,e,s)=>e in a?k(a,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[e]=s;var c=(a,e,s)=>(y(a,typeof e!="symbol"?e+"":e,s),s);import{r as t,o as f,d as N,f as B,g as $,i as r,e as o,w as m,t as I,v as L,h as _,j as P,M as S,z as U,W as h}from"./vendor.c4defc2a.js";import{C as V,E as n}from"./E.3472039f.js";import{C as R}from"./CLink.aec7ba0a.js";import{_ as T,a as b,G as M,R as w,H as W,U as A,r as G}from"./index.999f971f.js";import{N as p}from"./NaiveUtils.ad19d5d6.js";class H{constructor(e){c(this,"email","");c(this,"password","");e&&(this.email=e.email!==void 0&&e.email!==null?e.email:"",this.password=e.password!==void 0&&e.password!==null?e.password:"")}toJsonKey(e){switch(e){case"email":return"email";case"password":return"password";default:return e}}}const C=a=>(I("data-v-678f4aae"),a=a(),L(),a),O={class:"login narrow_content"},q=C(()=>r("h1",{class:"title"},"Login",-1)),x={class:"narrow_display_window"},z=C(()=>r("br",null,null,-1)),D=_("Confirm"),F=_("Cancel"),J={class:"forgotPassword"},K=_("Forgot Password?");function Y(a,e,s,i,l,d){const v=t("n-alert"),u=t("CEditItem"),g=t("n-button"),E=t("CLink");return f(),N("div",O,[q,a.showError?(f(),B(v,{key:0,class:"tripPrivateAlertBar",title:"Please login to continue.",type:"error"})):$("",!0),r("form",x,[o(u,{class:"loginUsernameItem",label:"Email",ref:"email",className:"loginUsername",onEnter:a.confirm},null,8,["onEnter"]),o(u,{label:"Password",ref:"password",className:"loginPassword",type:"password",onEnter:a.confirm},null,8,["onEnter"]),z,o(g,{class:"loginConfirm left_col",type:"info",onClick:a.confirm,loading:a.loading},{default:m(()=>[D]),_:1},8,["onClick","loading"]),o(g,{class:"loginCancel right_col",type:"default",onClick:a.cancel},{default:m(()=>[F]),_:1},8,["onClick"])]),r("p",J,[o(E,{url:a.resetLink},{default:m(()=>[K]),_:1},8,["url"])])])}const Q=P({components:{CEditItem:V,CLink:R,NAlert:S,NButton:U},data(){return{loading:!1,showError:!1,resetLink:b.password_Reset,loadingBar:M.loadingBar()}},beforeMount(){w.hasNext()&&(this.$data.showError=!0),p.init()},mounted(){n.get(n.get(this,"email"),"input").focus()},methods:{async confirm(){var i,l,d;this.$data.loading=!0,(i=this.$data.loadingBar)==null||i.start();const a=new H({email:n.getVal(this,"email"),password:n.getVal(this,"password")}),e=await W.genPOST("login",h.stringify(a)),s=new A(e);if(s.ID===-1){(l=this.$data.loadingBar)==null||l.error(),this.$data.loading=!1,p.messageError("Wrong email or password. Please try again.");return}(d=this.$data.loadingBar)==null||d.finish(),localStorage.setItem("userobj",h.stringify(s)),this.$data.loading=!1,p.messageSuccess("You are now logged in."),await w.paramToNext(new Map,!0)},cancel(){G.back()}}});var oe=T(Q,[["render",Y],["__scopeId","data-v-678f4aae"]]);export{oe as default};
