import{P as pe,a as et,D as fe}from"./DataProps.28132299.js";import{d as R,x as $,A as tt,z as nt,S as at,U as $e,X as it,V as F,E as st,W as lt,Y as S,ac as ot,a2 as rt,v as dt,a$ as he,J as me,a7 as ve,b0 as ut,aa as M,b1 as ct,o as D,c as k,e as f,r as h,F as De,g as Te,a as l,w as _,h as te,l as xe,n as Ne,i as P,N as ne,q as pt,b2 as Ie,_ as ae,t as ft,m as ht,aS as mt,T as ie,aV as ke,j as ee,b3 as vt,b4 as gt,b5 as ge,R as yt,k as _t}from"./index.c97a04a9.js";import{u as bt,N as Pe}from"./Input.3740b4e3.js";import{C as wt,D as Y,E as O,N as Ct,a as ye}from"./CEditItem.eaeab295.js";import{N as j,a as _e}from"./NaiveUtils.44ff875d.js";import{C as $t,F as Dt,a as Tt,b as xt,P as Nt}from"./CacheStorage.3773b082.js";import{N as It}from"./Select.b13982d7.js";var kt=R({name:"Add",render(){return $("svg",{width:"512",height:"512",viewBox:"0 0 512 512",fill:"none",xmlns:"http://www.w3.org/2000/svg"},$("path",{d:"M256 112V400M400 256H112",stroke:"currentColor","stroke-width":"32","stroke-linecap":"round","stroke-linejoin":"round"}))}}),Pt=R({name:"Remove",render(){return $("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},$("line",{x1:"400",y1:"256",x2:"112",y2:"256",style:`
        fill: none;
        stroke: currentColor;
        stroke-linecap: round;
        stroke-linejoin: round;
        stroke-width: 32px;
      `}))}});function Rt(e){return e==null||typeof e=="string"&&e.trim()===""?null:Number(e)}function St(e){return e.includes(".")&&(/^(-)?\d+.*(\.|0)$/.test(e)||/^\.\d+$/.test(e))}function Q(e){return e==null?!0:!Number.isNaN(e)}function Mt(e){return e==null?"":String(e)}function Z(e){if(e===null)return null;if(typeof e=="number")return e;{const n=Number(e);return Number.isNaN(n)?null:n}}var Ot=tt([nt("input-number-suffix",`
 display: inline-block;
 margin-right: 10px;
 `)]);const be=800,we=100,Vt=Object.assign(Object.assign({},$e.props),{autofocus:Boolean,loading:{type:Boolean,default:void 0},placeholder:String,defaultValue:{type:Number,default:null},value:Number,step:{type:[Number,String],default:1},min:[Number,String],max:[Number,String],size:String,disabled:{type:Boolean,default:void 0},validator:Function,bordered:{type:Boolean,default:void 0},showButton:{type:Boolean,default:!0},readonly:Boolean,clearable:Boolean,keyboard:{type:Object,default:{}},updateValueOnInput:{type:Boolean,default:!0},status:String,"onUpdate:value":[Function,Array],onUpdateValue:[Function,Array],onFocus:[Function,Array],onBlur:[Function,Array],onClear:[Function,Array],onChange:[Function,Array]});var Et=R({name:"InputNumber",props:Vt,setup(e){const{mergedBorderedRef:n,mergedClsPrefixRef:a,mergedRtlRef:d}=at(e),o=$e("InputNumber","-input-number",Ot,ut,e,a),{localeRef:u}=bt("InputNumber"),m=it(e),{mergedSizeRef:b,mergedDisabledRef:c,mergedStatusRef:v}=m,g=F(null),x=F(null),N=F(null),y=F(e.defaultValue),w=st(e,"value"),p=lt(w,y),V=F(""),Ee=t=>{const i=[e.min,e.max,e.step,t].map(s=>{const r=String(s).split(".")[1];return r?r.length:0});return Math.max(...i)},Ae=S(()=>{const{placeholder:t}=e;return t!==void 0?t:u.value.placeholder}),H=S(()=>{const t=Z(e.step);return t!==null?t===0?1:Math.abs(t):1}),se=S(()=>{const t=Z(e.min);return t!==null?t:null}),le=S(()=>{const t=Z(e.max);return t!==null?t:null}),E=t=>{const{value:i}=p;if(t===i){A();return}const{"onUpdate:value":s,onUpdateValue:r,onChange:T}=e,{nTriggerFormInput:U,nTriggerFormChange:C}=m;T&&M(T,t),r&&M(r,t),s&&M(s,t),y.value=t,U(),C()},I=(t=0,i=!0,s=!1)=>{const{value:r}=V;if(s&&St(r))return!1;const T=Rt(r);if(T===null)return i&&E(null),null;if(Q(T)){const U=Ee(T);let C=parseFloat((T+t).toFixed(U));if(Q(C)){const{value:J}=le,{value:X}=se;if(J!==null&&C>J){if(!i||s)return!1;C=J}if(X!==null&&C<X){if(!i||s)return!1;C=X}return e.validator&&!e.validator(C)?!1:(i&&E(C),C)}}return!1},A=()=>{const{value:t}=p;Q(t)?V.value=Mt(t):V.value=String(t)};A();const Be=S(()=>I(0,!1)===!1),oe=S(()=>{const{value:t}=p;if(e.validator&&t===null)return!1;const{value:i}=H;return I(-i,!1)!==!1}),re=S(()=>{const{value:t}=p;if(e.validator&&t===null)return!1;const{value:i}=H;return I(+i,!1)!==!1});function Le(t){const{onFocus:i}=e,{nTriggerFormFocus:s}=m;i&&M(i,t),s()}function Ue(t){var i,s;if(t.target===((i=g.value)===null||i===void 0?void 0:i.wrapperElRef))return;const r=I();if(r!==!1){const C=(s=g.value)===null||s===void 0?void 0:s.inputElRef;C&&(C.value=String(r||"")),p.value===r&&A()}else A();const{onBlur:T}=e,{nTriggerFormBlur:U}=m;T&&M(T,t),U()}function Fe(t){const{onClear:i}=e;i&&M(i,t)}function q(){const{value:t}=re;if(!t){ce();return}const{value:i}=p;if(i===null)e.validator||E(de());else{const{value:s}=H;I(s)}}function K(){const{value:t}=oe;if(!t){ue();return}const{value:i}=p;if(i===null)e.validator||E(de());else{const{value:s}=H;I(-s)}}const je=Le,He=Ue;function de(){if(e.validator)return null;const{value:t}=se,{value:i}=le;return t!==null?Math.max(0,t):i!==null?Math.min(0,i):0}function ze(t){Fe(t),E(null)}function Ge(t){var i,s,r;!((i=N.value)===null||i===void 0)&&i.$el.contains(t.target)&&t.preventDefault(),!((s=x.value)===null||s===void 0)&&s.$el.contains(t.target)&&t.preventDefault(),(r=g.value)===null||r===void 0||r.activate()}let B=null,L=null,z=null;function ue(){z&&(window.clearTimeout(z),z=null),B&&(window.clearInterval(B),B=null)}function ce(){G&&(window.clearTimeout(G),G=null),L&&(window.clearInterval(L),L=null)}function We(){z=window.setTimeout(()=>{B=window.setInterval(()=>{K()},we)},be),ve("mouseup",document,()=>{window.setTimeout(ue,0)})}let G=null;function qe(){G=window.setTimeout(()=>{L=window.setInterval(()=>{q()},we)},be),ve("mouseup",document,()=>{window.setTimeout(ce,0)})}const Ke=()=>{L||q()},Je=()=>{B||K()};function Xe(t){var i,s;if(t.code==="Enter"||t.code==="NumpadEnter"){if(t.target===((i=g.value)===null||i===void 0?void 0:i.wrapperElRef))return;I()!==!1&&((s=g.value)===null||s===void 0||s.deactivate())}else if(t.code==="ArrowUp"){if(e.keyboard.ArrowUp===!1)return;t.preventDefault(),I()!==!1&&q()}else if(t.code==="ArrowDown"){if(e.keyboard.ArrowDown===!1)return;t.preventDefault(),I()!==!1&&K()}}function Ye(t){V.value=t,e.updateValueOnInput&&I(0,!0,!0)}ot(p,()=>{A()});const Qe={focus:()=>{var t;return(t=g.value)===null||t===void 0?void 0:t.focus()},blur:()=>{var t;return(t=g.value)===null||t===void 0?void 0:t.blur()}},Ze=rt("InputNumber",d,a);return Object.assign(Object.assign({},Qe),{rtlEnabled:Ze,inputInstRef:g,minusButtonInstRef:x,addButtonInstRef:N,mergedClsPrefix:a,mergedBordered:n,uncontrolledValue:y,mergedValue:p,mergedPlaceholder:Ae,displayedValueInvalid:Be,mergedSize:b,mergedDisabled:c,displayedValue:V,addable:re,minusable:oe,mergedStatus:v,handleFocus:je,handleBlur:He,handleClear:ze,handleMouseDown:Ge,handleAddClick:Ke,handleMinusClick:Je,handleAddMousedown:qe,handleMinusMousedown:We,handleKeyDown:Xe,handleUpdateDisplayedValue:Ye,mergedTheme:o,inputThemeOverrides:{paddingSmall:"0 8px 0 10px",paddingMedium:"0 8px 0 12px",paddingLarge:"0 8px 0 14px"},buttonThemeOverrides:dt(()=>{const{self:{iconColorDisabled:t}}=o.value,[i,s,r,T]=ct(t);return{textColorTextDisabled:`rgb(${i}, ${s}, ${r})`,opacityDisabled:`${T}`}})})},render(){const{mergedClsPrefix:e}=this;return $("div",{class:[`${e}-input-number`,this.rtlEnabled&&`${e}-input-number--rtl`]},$(Pe,{ref:"inputInstRef",autofocus:this.autofocus,status:this.mergedStatus,bordered:this.mergedBordered,loading:this.loading,value:this.displayedValue,onUpdateValue:this.handleUpdateDisplayedValue,theme:this.mergedTheme.peers.Input,themeOverrides:this.mergedTheme.peerOverrides.Input,builtinThemeOverrides:this.inputThemeOverrides,size:this.mergedSize,placeholder:this.mergedPlaceholder,disabled:this.mergedDisabled,readonly:this.readonly,textDecoration:this.displayedValueInvalid?"line-through":void 0,onFocus:this.handleFocus,onBlur:this.handleBlur,onKeydown:this.handleKeyDown,onMousedown:this.handleMouseDown,onClear:this.handleClear,clearable:this.clearable,internalLoadingBeforeSuffix:!0},{prefix:()=>{var n,a;return(a=(n=this.$slots).prefix)===null||a===void 0?void 0:a.call(n)},suffix:()=>{var n,a;return this.showButton?[this.$slots.suffix&&$("span",{class:`${e}-input-number-suffix`},{default:this.$slots.suffix}),$(he,{text:!0,disabled:!this.minusable||this.mergedDisabled||this.readonly,focusable:!1,builtinThemeOverrides:this.buttonThemeOverrides,onClick:this.handleMinusClick,onMousedown:this.handleMinusMousedown,ref:"minusButtonInstRef"},{default:()=>$(me,{clsPrefix:e,"aria-disabled":!0},{default:()=>$(Pt,null)})}),$(he,{text:!0,disabled:!this.addable||this.mergedDisabled||this.readonly,focusable:!1,builtinThemeOverrides:this.buttonThemeOverrides,onClick:this.handleAddClick,onMousedown:this.handleAddMousedown,ref:"addButtonInstRef"},{default:()=>$(me,{clsPrefix:e},{default:()=>$(kt,null)})})]:(a=(n=this.$slots).suffix)===null||a===void 0?void 0:a.call(n)}}))}});const At={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Bt=f("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M256 112v288"},null,-1),Lt=f("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M400 256H112"},null,-1),Ut=[Bt,Lt];var Re=R({name:"Add",render:function(n,a){return D(),k("svg",At,Ut)}});const Ft={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},jt=f("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M368 368L144 144"},null,-1),Ht=f("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M368 144L144 368"},null,-1),zt=[jt,Ht];var Se=R({name:"CloseOutline",render:function(n,a){return D(),k("svg",Ft,zt)}});const Gt={class:"edit_places"},Wt={class:"places"},qt={key:0,class:"editTravelTime"},Kt={key:0,class:"travelTimeInput"},Jt=f("div",{class:"travelTimeLabel"},"Travel time",-1),Xt=P("minutes"),Yt=P("Set travel time"),Qt=f("br",null,null,-1),Zt=P("Delete this place"),en=P("Add another place");function tn(e,n,a,d,o,u){const m=h("n-divider"),b=h("n-input-number"),c=h("n-button"),v=h("n-input"),g=h("close-outline"),x=h("n-icon"),N=h("add");return D(),k("div",Gt,[f("ul",Wt,[(D(!0),k(De,null,Te(e.propPlaces,(y,w)=>(D(),k("li",{class:"place",key:w},[w>0?(D(),k("div",qt,[l(m,{class:"editPlaceDivider"}),y.travelTime!==void 0?(D(),k("div",Kt,[Jt,l(b,{placeholder:"Travel time (in minutes)",type:"text",min:0,value:y.travelTime.timeInMinutes,"onUpdate:value":p=>y.travelTime.timeInMinutes=p},{suffix:_(()=>[Xt]),_:2},1032,["value","onUpdate:value"])])):(D(),te(c,{key:1,class:"setTravelTime",type:"default",onClick:p=>e.setTravelTime(w)},{default:_(()=>[Yt]),_:2},1032,["onClick"])),l(m,{class:"editPlaceDivider"})])):xe("",!0),f("div",{class:Ne(["editPlace","place"+w])},[l(v,{class:"inputPlaceLabel",value:y.place.label,"onUpdate:value":p=>y.place.label=p,type:"text",placeholder:"Place Name"+(w!==0?"":" (eg. Golden Gate Bridge)")},null,8,["value","onUpdate:value","placeholder"]),l(v,{class:"inputPlaceLink",value:y.place.URL,"onUpdate:value":p=>y.place.URL=p,type:"text",placeholder:"Link"+(w!==0?"":" (eg. Google Map link)")},null,8,["value","onUpdate:value","placeholder"]),Qt,l(v,{class:"inputPlaceDesc",value:y.place.description,"onUpdate:value":p=>y.place.description=p,type:"textarea",placeholder:w!==0?"Description":"Elaborate more about why you include this place in the trip!",rows:3},null,8,["value","onUpdate:value","placeholder"]),l(c,{class:"removePlace wide_button",type:"error",secondary:"",onClick:p=>e.removePlace(w)},{default:_(()=>[l(x,null,{default:_(()=>[l(g)]),_:1}),Zt]),_:2},1032,["onClick"])],2)]))),128))]),l(m,{class:"editPlaceDivider"}),l(c,{class:"addPlace wide_button",onClick:e.pushPlace},{default:_(()=>[l(x,null,{default:_(()=>[l(N)]),_:1}),en]),_:1},8,["onClick"])])}const nn=R({name:"CEditPlaces",components:{Add:Re,CloseOutline:Se,NButton:ne,NDivider:pt,NIcon:Ie,NInput:Pe,NInputNumber:Et},model:{props:{propPlaces:Array()},emits:["update:propPlaces"]},props:{propPlaces:{type:Array,default:()=>[],validator:function(e){return Array.isArray(e)?(e.forEach(n=>{if(!(n instanceof pe))return!1}),!0):!1}}},methods:{pushPlace(){this.$props.propPlaces.push(new pe)},removePlace(e){this.$props.propPlaces.splice(e,1)},setTravelTime(e){const n=new et;n.toPlaceIndex=e,this.$props.propPlaces[e].travelTime=n}}});var Me=ae(nn,[["render",tn]]);const an={class:"edit_days narrow_content"},sn={class:"editDayCardContent"},ln={class:"editDayTitle"},on=P("Delete this day"),rn=P("Add another day");function dn(e,n,a,d,o,u){const m=h("close-outline"),b=h("n-icon"),c=h("n-button"),v=h("CEditPlaces"),g=h("n-card"),x=h("add");return D(),k("div",an,[(D(!0),k(De,null,Te(e.days,(N,y)=>(D(),te(g,{class:Ne(["editDay","day"+N.dayOf]),key:N.dayOf,hoverable:"","content-style":"padding: 0"},{default:_(()=>[f("div",sn,[f("div",ln,[f("b",null,"Day "+ft(N.dayOf),1),l(c,{class:"removeDay right_button",secondary:"",type:"error",onClick:w=>e.removeDay(y)},{default:_(()=>[l(b,null,{default:_(()=>[l(m)]),_:1}),on]),_:2},1032,["onClick"])]),l(v,{class:"editPlaces",ref_for:!0,ref:"places"+y,propPlaces:N.propPlaces,"onUpdate:propPlaces":w=>N.propPlaces=w},null,8,["propPlaces","onUpdate:propPlaces"])])]),_:2},1032,["class"]))),128)),l(c,{class:"addDay right_button",onClick:n[0]||(n[0]=N=>e.pushDay())},{default:_(()=>[l(b,null,{default:_(()=>[l(x)]),_:1}),rn]),_:1})])}const un=R({components:{Add:Re,CEditPlaces:Me,CloseOutline:Se,NButton:ne,NCard:ht,NIcon:Ie},props:{givenDays:{type:Array,required:!0}},data:()=>({days:[]}),beforeMount(){this.$data.days=this.$props.givenDays.slice(0).map(e=>new fe(e))},methods:{pushDay(){let e=new fe(new mt({places:[{}]}));e.dayOf=this.$data.days.length+1,this.$data.days.push(e)},removeDay(e){this.$data.days.splice(e,1);let n={};for(let o of this.$data.days)n[o.dayOf]=o;const a=this.$data.days.length;this.$data.days=[];let d=0;for(let o=0;o<a;o++){let u=n[o+d];for(;u==null&&o+d<a+5;)d++,u=n[o+d];u.dayOf=o+1,this.$data.days.push(u)}}}});var cn=ae(un,[["render",dn],["__scopeId","data-v-a3944dc6"]]);class pn{static getAllTypes(){return["name","description"]}constructor(n,a){this.type=n,this.label=this.getLabel(),this.value=a}getLabel(){switch(this.type){case"name":return"Name";case"description":return"Description";default:return"unknown_type"}}}class W extends $t{static fromJSON(n){return new W(n)}getObj(){return new ie(JSON.parse(this.obj))}}class Ce extends Dt{}class Oe extends Tt{constructor(){super(...arguments),this.storage=xt.TRIP,this.storeCount=10}async genFetch(n){const a=await Ve(n);return Nt.isPWA()?a.ID!==-1?(this.storeObj(Ce,W,a.ID.toString(),ke.stringify(a)),a):null:a}static genObj(n){return new Oe().genObjImpl(Ce,W,n)}}async function Ve(e){const n=await ee.genGET("v2/trip/"+e);return new ie(n)}const fn={class:"edit_trip"},hn={class:"edit_form"},mn={class:"narrow_content"},vn={class:"editTripPrivacy"},gn=f("span",{class:"editLabel"},"Private:",-1),yn={class:"editInput"},_n={class:"editCity"},bn=f("span",{class:"editLabel"},"Cities:",-1),wn={class:"confirmationButtons narrow_content"},Cn=P("Save"),$n=P("Cancel"),Dn=P("Delete");function Tn(e,n,a,d,o,u){const m=h("CEditItem"),b=h("n-switch"),c=h("n-select"),v=h("CEditDays"),g=h("n-button");return D(),k("div",fn,[f("form",hn,[f("div",mn,[l(m,{className:"editTripName",label:"Name",ref:"name",val:e.trip.details.name.valueOf()},null,8,["val"]),l(m,{className:"editTripDescription",label:"Description",ref:"description",type:"textarea",val:e.trip.details.description.valueOf(),"val-max-count":e.descriptionMaxCharCount,"row-min-count":e.descriptionRowMinCount},null,8,["val","val-max-count","row-min-count"]),f("div",vn,[gn,f("div",yn,[l(b,{class:"editPrivacyToggle",value:e.private,"onUpdate:value":n[0]||(n[0]=x=>e.private=x)},null,8,["value"])])]),f("div",_n,[bn,l(c,{class:"editInput",value:e.cities,"onUpdate:value":n[1]||(n[1]=x=>e.cities=x),options:e.possibleCities,loading:e.cityLoading,filterable:"",multiple:"",placeholder:"",onSearch:e.searchCity,onUpdateValue:e.onSelect},null,8,["value","options","loading","onSearch","onUpdateValue"])])]),l(v,{ref:"days",givenDays:e.trip.details.days},null,8,["givenDays"]),f("div",wn,[l(g,{class:"saveEditTrip left_col",type:"info",onClick:e.save,loading:e.saving},{default:_(()=>[Cn]),_:1},8,["onClick","loading"]),l(g,{class:"cancelEditTrip right_col",type:"default",onClick:e.cancel},{default:_(()=>[$n]),_:1},8,["onClick"]),e.isNew?xe("",!0):(D(),te(g,{key:0,class:"deleteTrip right_col",onClick:e.confirmDelete,type:"error",loading:e.deleting},{default:_(()=>[Dn]),_:1},8,["onClick","loading"]))])])])}const xn=3,Nn=R({components:{NButton:ne,NSelect:It,NSwitch:vt,CEditDays:cn,CEditItem:wt,CEditPlaces:Me},props:{trip:{type:ie,required:!0},isNew:{type:Boolean,required:!0}},emits:{save(e){return e.ID!==-1},cancel(){return!0}},data:()=>({cities:[],cityLoading:!1,parsedCities:[],parsedCitiesMap:new Map,possibleCities:[],private:!1,saving:!1,deleting:!1}),computed:{descriptionMaxCharCount(){return Y},descriptionRowMinCount(){return xn}},async beforeMount(){j.init(),this.update(),await this.searchCity("")},mounted(){O.get(O.get(this,"name"),"input").focus()},methods:{cancel(){var e;O.get(this,"days").$data.days=((e=this.$props.trip.details.days)!=null?e:[]).slice(0),this.$emit("cancel")},save(){let e=new gt;if(this.$data.cities.length<1){this.showAlert("Cities cannot be empty");return}this.$data.saving=!0;let n=[];for(const b of this.$data.cities){const c=this.$data.parsedCitiesMap.get(b);if(c!==void 0)n.push(c);else{const v=new ge;v.ID=+b,n.push(v)}}e.cities=n;const a=O.getVal(this,"name"),d=O.getVal(this,"description").split(`
`).join(" ");if(!this.checkValidNameDescription(a,d)){this.$data.saving=!1;return}e.name=a,e.description=d,e.days=[];const u=O.get(this,"days");let m=0;for(const b in u.days){const c=u.days[b].toDay(),v=this.filterPlaces(c.places);if(v===null){j.dialogError({title:"Invalid Link",content:"We currently only support links to limited websites including OpenStreetMap, Google Map, Bing Maps and Yelp.",positiveText:"OK"}),this.$data.saving=!1;return}v.length>0?(c.places=v,c.dayOf=c.dayOf-m,e.days.push(c)):m++}e.private=this.$data.private,e.ID=this.$props.trip.ID,this.$emit("save",e),this.$data.saving=!1},filterPlaces(e){let n=[];for(let a of e)if(a.label=a.label.trim(),a.URL=a.URL.trim(),a.label!=="")if(a.URL===""||this.filterPlace(a))a.description=a.description.split(`
`).join(" "),n.push(a);else return null;return n},filterPlace(e){const n=["https://goo.gl/maps/","https://google.com/maps/","https://www.google.com/maps/","https://maps.google.com/","https://www.openstreetmap.org/way/","https://www.bing.com/maps?","https://www.yelp.com/biz/"];for(const a of n)if(e.URL.startsWith(a))return!0;return!1},confirmDelete(){j.dialogWarning({title:"Delete trip",content:"Are you sure you want to delete this trip? THIS PROCESS IS IRREVERSIBLE.",positiveText:"Confirm",negativeText:"Cancel",onPositiveClick:async()=>{await this.del()},onNegativeClick:async()=>{}})},async del(){this.$data.deleting=!0;let e=Boolean(await ee.genDELETE("v2/trip/"+this.$props.trip.ID,ke.stringify(this.$props.trip)));e||(e=(await Ve(this.$props.trip.ID.toString())).ID===-1),this.$data.deleting=!1,j.notifyTrigger("Trip Deletion",e?"Trip is successfully deleted!":"Trip deletion attempt failed.",e?_e.SUCCESS:_e.ERROR),e&&yt.genRedirectTo(_t.Landing)},tripToItem(e){return new pn(e,this.$props.trip[e])},update(){const e=[];for(const n of this.$props.trip.details.cities)e.push(n.ID.toString());this.$data.cities=e;for(const n of this.$props.trip.details.cities)this.$data.parsedCitiesMap.set(n.ID.toString(),n),this.$data.parsedCities.push(n);this.$data.private=this.$props.trip.details.private.valueOf()},checkValidNameDescription(e,n){return!e||e.length<Ct?(this.showAlert("Trip name is too short."),!1):e.length>ye?(this.showAlert(`Trip name cannot be longer than ${ye}.`),!1):!n||n.length>Y?(this.showAlert(`Trip description cannot be longer than ${Y}.`),!1):!0},showAlert(e){j.dialogError({title:"Error",content:e,positiveText:"OK"})},async searchCity(e){this.$data.possibleCities=[];const n=[];for(const o of this.$data.parsedCities)this.$data.possibleCities.push({label:o.display.valueOf()+", "+o.iso2.valueOf(),value:o.ID.toString()}),n.push(o.ID.valueOf());this.$data.cityLoading=!0;const a=JSON.stringify(e),d=await ee.genPOST("cities",a);if(d===null){this.$data.cityLoading=!1;return}for(const o of d){const u=new ge(o);this.$data.parsedCitiesMap.set(u.ID.toString(),u),n.includes(u.ID.valueOf())||this.$data.possibleCities.push({label:u.display.valueOf()+", "+u.iso2.valueOf(),value:u.ID.toString()})}this.$data.cityLoading=!1},onSelect(e){for(const n of e){let a=!0;for(const d of this.$data.parsedCities)d.ID.toString()===n&&(a=!1);if(a){const d=this.$data.parsedCitiesMap.get(n);d!==void 0&&this.$data.parsedCities.push(d)}}for(const n of this.$data.parsedCities)for(const a of e)n.ID.toString()}}});var Vn=ae(Nn,[["render",Tn]]);export{Vn as C,Oe as T};
