var w=Object.defineProperty;var C=(s,e,a)=>e in s?w(s,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[e]=a;var r=(s,e,a)=>(C(s,typeof e!="symbol"?e+"":e,a),a);import{r as n,v,o as i,d as y,f as m,g as E,i as o,e as l,x as $,w as g,h as u,j as k,u as B,W as f}from"./vendor.7b9428fe.js";import{C as P,E as t}from"./E.0486ff15.js";import{_ as N,a as L,H as b,U as I,G as V,R as p,r as R}from"./index.a4de7a58.js";class T{constructor(e){r(this,"email","");r(this,"password","");e&&(this.email=e.email!==void 0&&e.email!==null?e.email:"",this.password=e.password!==void 0&&e.password!==null?e.password:"")}toJsonKey(e){switch(e){case"email":return"email";case"password":return"password";default:return e}}}const U={class:"login narrow_content"},x=o("h1",{class:"title"},"Login",-1),S={class:"loginbox"},D=o("br",null,null,-1),W=u("Confirm"),G=u("Cancel"),H={class:"forgotPassword"},M=["href"];function O(s,e,a,A,F,J){const _=n("el-alert"),c=n("CEditItem"),d=n("el-button"),h=v("loading");return i(),y("div",U,[x,s.showError?(i(),m(_,{key:0,class:"tripPrivateAlertBar",title:"Please login to continue.",type:"error",closable:!1,"show-icon":""})):E("",!0),o("form",S,[l(c,{class:"loginUsernameItem",label:"Email",ref:"email",className:"loginUsername",onEnter:s.confirm},null,8,["onEnter"]),l(c,{label:"Password",ref:"password",className:"loginPassword",type:"password",onEnter:s.confirm},null,8,["onEnter"]),D,$((i(),m(d,{class:"loginConfirm",type:"primary",onClick:s.confirm},{default:g(()=>[W]),_:1},8,["onClick"])),[[h,s.loading,void 0,{fullscreen:!0,lock:!0}]]),l(d,{class:"loginCancel",type:"default",onClick:s.cancel},{default:g(()=>[G]),_:1},8,["onClick"])]),o("p",H,[o("a",{href:s.resetLink},"Forgot Password?",8,M)])])}const q=k({data(){return{loading:!1,showError:!1,resetLink:L.password_Reset,loadingBar:B()}},components:{CEditItem:P},methods:{async confirm(){this.$data.loading=!0,this.$data.loadingBar.start();const s=new T({email:t.getVal(this,"email"),password:t.getVal(this,"password")}),e=await b.genPOST("login",f.stringify(s)),a=new I(e);if(a.ID===-1){this.$data.loadingBar.error(),this.$data.loading=!1,this.$message({type:"error",message:"Wrong email or password. Please try again."});return}this.$data.loadingBar.finish(),localStorage.setItem("userobj",f.stringify(a)),this.$data.loading=!1,this.$notify(V.notifConfig("Success","You are now logged in.","success")),await p.paramToNext(new Map,!0)},cancel(){R.back()}},beforeMount(){p.hasNext()&&(this.$data.showError=!0)},mounted(){t.get(t.get(this,"email"),"input").focus()}});var Q=N(q,[["render",O]]);export{Q as default};
