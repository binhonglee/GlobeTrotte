var v=Object.defineProperty;var E=(s,e,a)=>e in s?v(s,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[e]=a;var c=(s,e,a)=>(E(s,typeof e!="symbol"?e+"":e,a),a);import{r as t,o as g,d as $,f as B,g as I,i as r,e as o,w as m,q as N,s as L,h as p,j as P,K as b,x as S,W as f}from"./vendor.1cd2bc54.js";import{C as V,E as n}from"./E.25227042.js";import{C as R}from"./CLink.76dfdee4.js";import{_ as T,a as U,G as h,R as w,H as W,U as q,r as x}from"./index.9d013ab5.js";class A{constructor(e){c(this,"email","");c(this,"password","");e&&(this.email=e.email!==void 0&&e.email!==null?e.email:"",this.password=e.password!==void 0&&e.password!==null?e.password:"")}toJsonKey(e){switch(e){case"email":return"email";case"password":return"password";default:return e}}}const C=s=>(N("data-v-61b9b530"),s=s(),L(),s),G={class:"login narrow_content"},H=C(()=>r("h1",{class:"title"},"Login",-1)),K={class:"narrow_display_window"},M=C(()=>r("br",null,null,-1)),O=p("Confirm"),D=p("Cancel"),F={class:"forgotPassword"},J=p("Forgot Password?");function Y(s,e,a,i,l,d){const y=t("n-alert"),u=t("CEditItem"),_=t("n-button"),k=t("CLink");return g(),$("div",G,[H,s.showError?(g(),B(y,{key:0,class:"tripPrivateAlertBar",title:"Please login to continue.",type:"error"})):I("",!0),r("form",K,[o(u,{class:"loginUsernameItem",label:"Email",ref:"email",className:"loginUsername",onEnter:s.confirm},null,8,["onEnter"]),o(u,{label:"Password",ref:"password",className:"loginPassword",type:"password",onEnter:s.confirm},null,8,["onEnter"]),M,o(_,{class:"loginConfirm left_col",type:"info",onClick:s.confirm,loading:s.loading},{default:m(()=>[O]),_:1},8,["onClick","loading"]),o(_,{class:"loginCancel right_col",type:"default",onClick:s.cancel},{default:m(()=>[D]),_:1},8,["onClick"])]),r("p",F,[o(k,{url:s.resetLink},{default:m(()=>[J]),_:1},8,["url"])])])}const z=P({components:{CEditItem:V,CLink:R,NAlert:b,NButton:S},data(){return{loading:!1,showError:!1,resetLink:U.password_Reset,loadingBar:h.loadingBar()}},beforeMount(){w.hasNext()&&(this.$data.showError=!0)},mounted(){n.get(n.get(this,"email"),"input").focus()},methods:{async confirm(){var i,l,d;this.$data.loading=!0,(i=this.$data.loadingBar)==null||i.start();const s=new A({email:n.getVal(this,"email"),password:n.getVal(this,"password")}),e=await W.genPOST("login",f.stringify(s)),a=new q(e);if(a.ID===-1){(l=this.$data.loadingBar)==null||l.error(),this.$data.loading=!1,this.$message({type:"error",message:"Wrong email or password. Please try again."});return}(d=this.$data.loadingBar)==null||d.finish(),localStorage.setItem("userobj",f.stringify(a)),this.$data.loading=!1,this.$notify(h.notifConfig("Success","You are now logged in.","success")),await w.paramToNext(new Map,!0)},cancel(){x.back()}}});var se=T(z,[["render",Y],["__scopeId","data-v-61b9b530"]]);export{se as default};
