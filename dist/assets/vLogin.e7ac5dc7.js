var E=Object.defineProperty;var $=(s,e,a)=>e in s?E(s,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[e]=a;var l=(s,e,a)=>($(s,typeof e!="symbol"?e+"":e,a),a);import{r as c,A as k,o as d,d as B,f,g as P,i as o,e as m,B as N,w as p,h as _,j as I,W as h}from"./vendor.99a78856.js";import{C as L,E as t}from"./E.34d210c7.js";import{_ as V,a as b,G as w,R as C,H as R,U as T,r as U}from"./index.0627de76.js";class S{constructor(e){l(this,"email","");l(this,"password","");e&&(this.email=e.email!==void 0&&e.email!==null?e.email:"",this.password=e.password!==void 0&&e.password!==null?e.password:"")}toJsonKey(e){switch(e){case"email":return"email";case"password":return"password";default:return e}}}const x={class:"login narrow_content"},D=o("h1",{class:"title"},"Login",-1),W={class:"loginbox"},A=o("br",null,null,-1),G=_("Confirm"),H=_("Cancel"),M={class:"forgotPassword"},O=["href"];function q(s,e,a,r,n,i){const v=c("el-alert"),g=c("CEditItem"),u=c("el-button"),y=k("loading");return d(),B("div",x,[D,s.showError?(d(),f(v,{key:0,class:"tripPrivateAlertBar",title:"Please login to continue.",type:"error",closable:!1,"show-icon":""})):P("",!0),o("form",W,[m(g,{class:"loginUsernameItem",label:"Email",ref:"email",className:"loginUsername",onEnter:s.confirm},null,8,["onEnter"]),m(g,{label:"Password",ref:"password",className:"loginPassword",type:"password",onEnter:s.confirm},null,8,["onEnter"]),A,N((d(),f(u,{class:"loginConfirm",type:"primary",onClick:s.confirm},{default:p(()=>[G]),_:1},8,["onClick"])),[[y,s.loading,void 0,{fullscreen:!0,lock:!0}]]),m(u,{class:"loginCancel",type:"default",onClick:s.cancel},{default:p(()=>[H]),_:1},8,["onClick"])]),o("p",M,[o("a",{href:s.resetLink},"Forgot Password?",8,O)])])}const F=I({components:{CEditItem:L},data(){return{loading:!1,showError:!1,resetLink:b.password_Reset,loadingBar:w.loadingBar()}},beforeMount(){C.hasNext()&&(this.$data.showError=!0)},mounted(){t.get(t.get(this,"email"),"input").focus()},methods:{async confirm(){var r,n,i;this.$data.loading=!0,(r=this.$data.loadingBar)==null||r.start();const s=new S({email:t.getVal(this,"email"),password:t.getVal(this,"password")}),e=await R.genPOST("login",h.stringify(s)),a=new T(e);if(a.ID===-1){(n=this.$data.loadingBar)==null||n.error(),this.$data.loading=!1,this.$message({type:"error",message:"Wrong email or password. Please try again."});return}(i=this.$data.loadingBar)==null||i.finish(),localStorage.setItem("userobj",h.stringify(a)),this.$data.loading=!1,this.$notify(w.notifConfig("Success","You are now logged in.","success")),await C.paramToNext(new Map,!0)},cancel(){U.back()}}});var z=V(F,[["render",q]]);export{z as default};
