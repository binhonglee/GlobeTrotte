var C=Object.defineProperty;var E=(s,e,t)=>e in s?C(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var r=(s,e,t)=>(E(s,typeof e!="symbol"?e+"":e,t),t);import{r as g,E as y,o as h,d as $,i as c,e as i,G as N,f as P,w as p,h as w,j as I,W as _}from"./vendor.8f75e3dd.js";import{_ as k,H as V,U as R,G as D,R as d,a as m,r as T}from"./index.73c2cf5c.js";import{C as U,E as n}from"./E.43e2e6e9.js";class B{constructor(e){r(this,"ID",-1);r(this,"name","");r(this,"email","");r(this,"bio","");r(this,"password","");e&&(this.ID=e.id!==void 0&&e.id!==null?e.id:-1,this.name=e.name!==void 0&&e.name!==null?e.name:"",this.email=e.email!==void 0&&e.email!==null?e.email:"",this.bio=e.bio!==void 0&&e.bio!==null?e.bio:"",this.password=e.password!==void 0&&e.password!==null?e.password:"")}toJsonKey(e){switch(e){case"ID":return"id";case"name":return"name";case"email":return"email";case"bio":return"bio";case"password":return"password";default:return e}}register(e){this.name=e.name,this.email=e.email,this.password=e.password}}const S={class:"new_user narrow_content"},x=c("h1",{class:"title"},"Create Account",-1),G={class:"newUser"},O=c("br",null,null,-1),b=w("Confirm"),A=w("Cancel");function H(s,e,t,o,u,l){const a=g("CEditItem"),f=g("el-button"),v=y("loading");return h(),$("div",S,[x,c("form",G,[i(a,{className:"registrationName",label:"Name",ref:"name",onEnter:s.confirm},null,8,["onEnter"]),i(a,{className:"registrationEmail",label:"Email",ref:"email",onEnter:s.confirm},null,8,["onEnter"]),i(a,{className:"registrationPassword",label:"Password",ref:"password",type:"password",onEnter:s.confirm},null,8,["onEnter"]),i(a,{className:"registrationConfPassword",label:"Confirm Password",ref:"confPassword",type:"password",onEnter:s.confirm},null,8,["onEnter"]),O,N((h(),P(f,{class:"registrationSave",type:"primary",onClick:s.confirm},{default:p(()=>[b]),_:1},8,["onClick"])),[[v,s.loading,void 0,{fullscreen:!0,lock:!0}]]),i(f,{class:"registrationCancel",type:"default",onClick:s.cancel},{default:p(()=>[A]),_:1},8,["onClick"])])])}const K=I({components:{CEditItem:U},data(){return{loading:!1}},mounted(){n.get(n.get(this,"name"),"input").focus()},methods:{async confirm(){if(this.$data.loading=!0,n.getVal(this,"password").localeCompare(n.getVal(this,"confPassword"))){this.$alert("Password does not match.","Fail",{confirmButtonText:"OK"}),this.$data.loading=!1;return}const s=n.getVal(this,"name").trim(),e=n.getVal(this,"email").trim(),t=n.getVal(this,"password").trim();if(s.length<1||e.length<1||t.length<1){this.$data.loading=!1,this.$message({message:"Missing input. Please try again.",type:"error"});return}const o=new B;o.register({name:s,email:e,password:t});const u=await V.genPOST("v2/user",_.stringify(o)),l=new R(u);if(l.ID===-1){this.$data.loading=!1,this.$message({message:"Invalid email. Please try again.",type:"error"});return}localStorage.setItem("userobj",_.stringify(l)),this.$data.loading=!1,this.$notify(D.notifConfig("Success","Your account is created successfully!","success"));let a=d.getNext(this.$route);a===m.Landing&&(a=m.MyAccount),await d.genRedirectTo(d.addParamNext(m.unconfirmed_Email,a))},cancel(){T.back()}}});var J=k(K,[["render",H]]);export{J as default};
