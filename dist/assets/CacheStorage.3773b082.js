class h{static isPWA(){switch("production"){case"production":return window.matchMedia("(display-mode: standalone)").matches;case"development":return!0}return!0}}class d{constructor(e){this.order=e.order,this.key=e.key,this.obj=e.obj}static paramsToRecord(e,n,r){return{order:e,key:n,obj:r}}getOrder(){return this.order}getKey(){return this.key}incrementOrder(){return this.order++,this.order}}function u(o,e){if(e===null)return null;try{const n=JSON.parse(e),r=[];for(const s of n)r.push(new o(s));return r}catch{return null}}class f{constructor(){this.fromStorage=!1,this.completed=null,this.promise=null}}class m{getStorage(){return localStorage.getItem(this.storage)}setStorage(e){localStorage.setItem(this.storage,JSON.stringify(e))}async genObjImpl(e,n,r){const s=new e;if(h.isPWA()){const t=u(n,this.getStorage());if(t!==null){for(const i of t)if(i.getKey()===r)return s.completed=i.getObj(),s.promise=this.genFetch(r),s.fromStorage=!0,s}}return s.completed=await this.genFetch(r),s.promise=null,s}storeObj(e,n,r,s){let t;try{t=u(n,this.getStorage())}catch{t=null}let i=0;if(t!==null){const c=[];for(const[a,l]of t.entries())l.getKey()===r?c.push(a):l.getOrder()>i&&(i=l.getOrder(),c.push(a)),l.incrementOrder();for(const a of c)t.length===1&&(t=[]),t.splice(a,1)}else t=[];t.push(new n(d.paramsToRecord(i,r,s))),this.setStorage(t)}}var g=(o=>(o.TRIP="trip",o.USER="user",o.USERNAME="username",o))(g||{});export{d as C,f as F,h as P,m as a,g as b};
