import{r as a,o as e,c as s,b as i,g as u,e as _,k as h,t as r,d as f,h as m,F as D,f as g,i as y,N as R,l as V,T as n,H as k,j as C,G as o,_ as v,aW as L,R as I}from"./index.aaf24c90.js";import{C as P}from"./CEditTrip.d699c6f1.js";import{C as B}from"./CPlaces.fbf7c696.js";import{C as O}from"./CLink.33d53c95.js";import{C as A}from"./CShare.e0faf1c5.js";import{a as j,C as q,D as F}from"./DataProps.8dd5a3be.js";import{N as G}from"./Alert.fc701ca6.js";import"./Icon.fdedd375.js";import"./Input.8e3eb2ef.js";import"./E.713eaada.js";import"./NaiveUtils.aba419b5.js";import"./Select.ad6958d4.js";const H={key:0,class:"view_trip"},W={class:"narrow_content"},K=m("Only you can see this trip."),z={class:"tripName left_col"},J={key:1,class:"tripDescription"},Q={class:"tripCreatorInfo"},X=m("Author: "),Y={class:"tripUpdatedDate"},Z={class:"tripCreatedDate"},x={class:"tripCities"},tt={class:"viewDays"},et={class:"viewDayCardContent"},it={class:"dayTitle"},at={class:"narrow_content"},st=m("Edit");function rt(t,d,p,w,T,b){const l=a("n-alert"),$=a("CLink"),E=a("n-tag"),M=a("CShare"),U=a("CPlaces"),N=a("n-card"),S=a("n-button");return t.trip!==void 0?(e(),s("div",H,[i("div",W,[t.trip.details.private?(e(),u(l,{key:0,class:"tripPrivateAlertBar",title:"Trip is private",type:"info"},{default:_(()=>[K]),_:1})):h("",!0),i("h2",z,r(t.trip.details.name),1),t.trip.details.description!==""?(e(),s("p",J,r(t.trip.details.description),1)):h("",!0),i("p",Q,[X,f($,{url:"/user/"+t.trip.user.ID},{default:_(()=>[m(r(t.trip.user.name),1)]),_:1},8,["url"])]),i("p",Y,"Last Updated: "+r(t.lastUpdated),1),i("p",Z,"Created on: "+r(t.created),1),i("div",x,[(e(!0),s(D,null,g(t.cities,c=>(e(),u(E,{class:"tripCity",type:"info"},{default:_(()=>[m(r(c),1)]),_:2},1024))),256))]),f(M,{shareURL:t.shareURL},null,8,["shareURL"])]),i("div",tt,[(e(!0),s(D,null,g(t.days,c=>(e(),u(N,{class:"viewDayCard",key:c.ID.valueOf(),"content-style":"padding: 0"},{default:_(()=>[i("div",et,[i("h3",it,"Day "+r(c.dayOf),1),f(U,{propPlaces:c.propPlaces},null,8,["propPlaces"])])]),_:2},1024))),128))]),i("div",at,[t.editable?(e(),u(S,{key:0,class:"enableTripEdit right_col",onClick:t.enableEditMode},{default:_(()=>[st]),_:1},8,["onClick"])):h("",!0)])])):h("",!0)}const ot=y({name:"CViewTrip",components:{CLink:O,CPlaces:B,CShare:A,NAlert:G,NButton:R,NCard:V,NTag:j},props:{trip:{type:n,required:!0},editable:{type:Boolean}},emits:{enableEditMode(){return!0}},data:()=>({days:[],cities:[],shareURL:"",created:"",lastUpdated:""}),beforeMount(){this.$data.cities=[];for(let t of this.$props.trip.details.cities)this.$data.cities.push(q.toString(t));this.$data.days=this.$props.trip.details.days.slice(0).map(t=>new F(t)),this.$data.shareURL=k.getAbsoluteURL(C.trip_View,this.$props.trip.ID.toString()),this.$data.created=o.getDisplayDate(this.$props.trip.timeCreated),this.$data.lastUpdated=o.getDisplayDate(this.$props.trip.lastUpdated)},methods:{enableEditMode(){this.$emit("enableEditMode")}}});var nt=v(ot,[["render",rt],["__scopeId","data-v-5c442736"]]);const dt={class:"trip_info narrow_display_window"},pt={key:0,class:"view_trip_info"},lt={key:1,class:"edit_trip_info"};function ct(t,d,p,w,T,b){const l=a("CViewTrip"),$=a("CEditTrip");return e(),s("div",dt,[t.editMode?(e(),s("div",lt,[f($,{trip:t.dtrip,isNew:!1,onSave:t.save,onCancel:t.cancel},null,8,["trip","onSave","onCancel"])])):(e(),s("div",pt,[f(l,{trip:t.dtrip,editable:t.editable,onEnableEditMode:t.enableEditMode},null,8,["trip","editable","onEnableEditMode"])]))])}const _t=y({name:"CTripInfo",components:{CViewTrip:nt,CEditTrip:P},props:{trip:{type:n,required:!0},editable:{type:Boolean}},data:()=>({editMode:!1,dtrip:new n}),beforeMount(){this.$data.editMode=!1,this.$data.dtrip=this.$props.trip},methods:{async save(t){const d=this.$props.trip;d.details=t;const p=await k.genPOST("v2/trip/"+t.ID,L.stringify(d));p?(this.$data.dtrip=new n(p),this.$data.editMode=!1):this.$alert("Save was unsuccessful. Please try again later.","Fail",{confirmButtonText:"OK"})},cancel(){this.$data.editMode=!1},enableEditMode(){this.$data.editMode=!0}}});var ut=v(_t,[["render",ct]]);const ht={class:"get_view_trip"},ft=i("h1",{class:"title"},"Trip",-1);function mt(t,d,p,w,T,b){const l=a("CTripInfo");return e(),s("div",ht,[ft,t.trip.ID!==-1?(e(),u(l,{key:0,trip:t.trip,editable:t.owner},null,8,["trip","editable"])):h("",!0)])}const $t=y({components:{CTripInfo:ut},data(){return{inputID:"",trip:new n,owner:!1}},async beforeMount(){await this.init()},methods:{async init(){const t=o.paramID();if(t===void 0){this.$data.trip=new n,await I.genRedirectTo(C.trip_Search);return}if(this.$data.inputID=t,this.$data.trip=await o.genTrip(Number(t)),this.$data.trip.ID!==-1){this.$data.owner=o.getIsCurrentUser(this.$data.trip.user.ID.valueOf());return}this.$notify(o.notifConfig("Error","Trip not found.","error")),await I.genRedirectTo(C.trip_Search)}}});var Ut=v($t,[["render",mt]]);export{Ut as default};
