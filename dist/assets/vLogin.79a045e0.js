var E=Object.defineProperty;var N=(a,e,s)=>e in a?E(a,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[e]=s;var c=(a,e,s)=>(N(a,typeof e!="symbol"?e+"":e,s),s);import{r as t,o as f,c as y,g as B,k as $,b as r,d as o,e as m,p as I,a as L,h as _,_ as P,i as S,N as b,j as V,G as R,R as h,H as T,aW as w,be as U,bc as W}from"./index.aaf24c90.js";import{C as A,E as n}from"./E.713eaada.js";import{C as G}from"./CLink.33d53c95.js";import{N as p}from"./NaiveUtils.aba419b5.js";import{N as H}from"./Alert.fc701ca6.js";import"./Input.8e3eb2ef.js";class M{constructor(e){c(this,"email","");c(this,"password","");e&&(this.email=e.email!==void 0&&e.email!==null?e.email:"",this.password=e.password!==void 0&&e.password!==null?e.password:"")}toJsonKey(e){switch(e){case"email":return"email";case"password":return"password";default:return e}}}const C=a=>(I("data-v-678f4aae"),a=a(),L(),a),O={class:"login narrow_content"},q=C(()=>r("h1",{class:"title"},"Login",-1)),x={class:"narrow_display_window"},D=C(()=>r("br",null,null,-1)),F=_("Confirm"),J=_("Cancel"),K={class:"forgotPassword"},Y=_("Forgot Password?");function z(a,e,s,i,l,d){const k=t("n-alert"),u=t("CEditItem"),g=t("n-button"),v=t("CLink");return f(),y("div",O,[q,a.showError?(f(),B(k,{key:0,class:"tripPrivateAlertBar",title:"Please login to continue.",type:"error"})):$("",!0),r("form",x,[o(u,{class:"loginUsernameItem",label:"Email",ref:"email",className:"loginUsername",onEnter:a.confirm},null,8,["onEnter"]),o(u,{label:"Password",ref:"password",className:"loginPassword",type:"password",onEnter:a.confirm},null,8,["onEnter"]),D,o(g,{class:"loginConfirm left_col",type:"info",onClick:a.confirm,loading:a.loading},{default:m(()=>[F]),_:1},8,["onClick","loading"]),o(g,{class:"loginCancel right_col",type:"default",onClick:a.cancel},{default:m(()=>[J]),_:1},8,["onClick"])]),r("p",K,[o(v,{url:a.resetLink},{default:m(()=>[Y]),_:1},8,["url"])])])}const Q=S({components:{CEditItem:A,CLink:G,NAlert:H,NButton:b},data(){return{loading:!1,showError:!1,resetLink:V.password_Reset,loadingBar:R.loadingBar()}},beforeMount(){h.hasNext()&&(this.$data.showError=!0),p.init()},mounted(){n.get(n.get(this,"email"),"input").focus()},methods:{async confirm(){var i,l,d;this.$data.loading=!0,(i=this.$data.loadingBar)==null||i.start();const a=new M({email:n.getVal(this,"email"),password:n.getVal(this,"password")}),e=await T.genPOST("login",w.stringify(a)),s=new U(e);if(s.ID===-1){(l=this.$data.loadingBar)==null||l.error(),this.$data.loading=!1,p.messageError("Wrong email or password. Please try again.");return}(d=this.$data.loadingBar)==null||d.finish(),localStorage.setItem("userobj",w.stringify(s)),this.$data.loading=!1,p.messageSuccess("You are now logged in."),await h.paramToNext(new Map,!0)},cancel(){W.back()}}});var te=P(Q,[["render",z],["__scopeId","data-v-678f4aae"]]);export{te as default};
