import{r as s,o as t,d as a,i,f as p,g as c,y as r,F as b,s as g,w as h,h as v,e as m,j as C,t as S,A as V,C as N,W as j}from"./vendor.8f75e3dd.js";import{C as B}from"./CEditTrip.4501bae1.js";import{C as O}from"./CityUtil.63031d69.js";import{C as P}from"./CPlaces.daf081fa.js";import{T as l,_ as y,H as U,G as _,R as D,a as E}from"./index.73c2cf5c.js";import"./E.43e2e6e9.js";const R={key:0,class:"view_trip"},q={class:"narrow_content"},A={class:"tripName"},F={key:1,class:"tripDescription"},G={class:"tripCreatorInfo"},H=v("Author: "),L=["href"],W={class:"tripCreatedDate"},K={class:"tripUpdatedDate"},z={class:"tripCities"},J={class:"viewDays"},Q={class:"viewDayCardContent"},X={class:"dayTitle"},Y={class:"narrow_content"},Z=v("Edit");function x(e,o,u,$,w,T){const n=s("el-alert"),f=s("n-tag"),I=s("CPlaces"),M=s("n-card"),k=s("n-button");return e.trip!==void 0?(t(),a("div",R,[i("div",q,[e.trip.details.private?(t(),p(n,{key:0,class:"tripPrivateAlertBar",title:"Trip is private",description:"Only you can see this trip.",type:"info",closable:!1,"show-icon":""})):c("",!0),i("h2",A,r(e.trip.details.name),1),e.trip.details.description!==""?(t(),a("p",F,r(e.trip.details.description),1)):c("",!0),i("p",G,[H,i("a",{href:"/user/"+e.trip.user.ID},r(e.trip.user.name),9,L)]),i("p",W,"Created on: "+r(e.trip.timeCreated.toDateString()),1),i("p",K,"Last Updated: "+r(e.trip.lastUpdated.toDateString()),1),i("div",z,[(t(!0),a(b,null,g(e.cities,d=>(t(),p(f,{class:"tripCity",type:"info"},{default:h(()=>[v(r(d),1)]),_:2},1024))),256))])]),i("div",J,[(t(!0),a(b,null,g(e.trip.details.days,d=>(t(),p(M,{class:"viewDayCard",key:d.ID.valueOf(),"content-style":"padding: 0"},{default:h(()=>[i("div",Q,[i("h3",X,"Day "+r(d.dayOf),1),m(I,{places:d.places},null,8,["places"])])]),_:2},1024))),128))]),i("div",Y,[e.editable?(t(),p(k,{key:0,class:"enableTripEdit",onClick:e.enableEditMode},{default:h(()=>[Z]),_:1},8,["onClick"])):c("",!0)])])):c("",!0)}const ee=C({name:"CViewTrip",components:{CPlaces:P,NButton:S,NCard:V,NTag:N},props:{trip:{type:l,required:!0},editable:{type:Boolean}},emits:{enableEditMode(){return!0}},data:()=>({cities:[]}),async beforeMount(){if(this.$data.cities=[],this.$props.trip!==void 0)for(let e of this.$props.trip.details.cities)this.$data.cities.push(O.toString(e))},methods:{enableEditMode(){this.$emit("enableEditMode")}}});var te=y(ee,[["render",x],["__scopeId","data-v-7fe7d9fa"]]);const ie={class:"trip_info"},se={key:0,class:"view_trip_info"},ae={key:1,class:"edit_trip_info"};function re(e,o,u,$,w,T){const n=s("CViewTrip"),f=s("CEditTrip");return t(),a("div",ie,[e.editMode?(t(),a("div",ae,[m(f,{trip:e.trip,isNew:!1,onSave:e.save,onCancel:e.cancel},null,8,["trip","onSave","onCancel"])])):(t(),a("div",se,[m(n,{trip:e.trip,editable:e.editable,onEnableEditMode:e.enableEditMode},null,8,["trip","editable","onEnableEditMode"])]))])}const oe=C({name:"CTripInfo",components:{CViewTrip:te,CEditTrip:B},props:{trip:{type:l,required:!0},editable:{type:Boolean}},data:()=>({editMode:!1}),beforeMount(){this.$data.editMode=!1},methods:{async save(e){const o=this.$props.trip;o.details=e,await U.genPOST("v2/trip/"+e.ID,j.stringify(o))?this.$data.editMode=!1:this.$alert("Save was unsuccessful. Please try again later.","Fail",{confirmButtonText:"OK"})},cancel(){this.$data.editMode=!1},enableEditMode(){this.$data.editMode=!0}}});var ne=y(oe,[["render",re]]);const de={class:"get_view_trip"},pe=i("h1",{class:"title"},"Trip",-1);function ce(e,o,u,$,w,T){const n=s("CTripInfo");return t(),a("div",de,[pe,e.trip.ID!==-1?(t(),p(n,{key:0,trip:e.trip,editable:e.owner},null,8,["trip","editable"])):c("",!0)])}const le=C({components:{CTripInfo:ne},data(){return{inputID:"",trip:new l,owner:!1}},async beforeMount(){await this.init()},methods:{async init(){const e=_.paramID();if(e===void 0){this.$data.trip=new l,await D.genRedirectTo(E.trip_Search);return}if(this.$data.inputID=e,this.$data.trip=await _.genTrip(Number(e)),this.$data.trip.ID!==-1){this.$data.owner=_.getIsCurrentUser(this.$data.trip.user.ID.valueOf());return}this.$notify(_.notifConfig("Error","Trip not found.","error")),await D.genRedirectTo(E.trip_Search)}}});var Ce=y(le,[["render",ce]]);export{Ce as default};
