var N=Object.defineProperty;var y=(o,e,a)=>e in o?N(o,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):o[e]=a;var c=(o,e,a)=>(y(o,typeof e!="symbol"?e+"":e,a),a);import{r as s,o as f,c as B,a as t,h as L,l as $,e as r,w as m,p as b,b as I,i as _,_ as P,d as S,N as T,k as V,G as R,R as h,j as U,aW as w,bd as H,bb as G}from"./index.df8f32b6.js";import{C as W,E as n}from"./E.66cd6ce1.js";import{C as A}from"./CLink.81ee42b8.js";import{N as p}from"./NaiveUtils.465b9ff5.js";import{C as M}from"./CHead.45115d84.js";import{N as O}from"./Alert.33716964.js";import"./Input.33705439.js";class q{constructor(e){c(this,"email","");c(this,"password","");e&&(this.email=e.email!==void 0&&e.email!==null?e.email:"",this.password=e.password!==void 0&&e.password!==null?e.password:"")}toJsonKey(e){switch(e){case"email":return"email";case"password":return"password";default:return e}}}const C=o=>(b("data-v-db068dfa"),o=o(),I(),o),x={class:"login narrow_content"},D=C(()=>r("h1",{class:"title"},"Login",-1)),F={class:"narrow_display_window"},J=C(()=>r("br",null,null,-1)),K=_("Confirm"),Y=_("Cancel"),z={class:"forgotPassword"},Q=_("Forgot Password?");function X(o,e,a,i,l,d){const k=s("CHead"),v=s("n-alert"),u=s("CEditItem"),g=s("n-button"),E=s("CLink");return f(),B("div",x,[t(k,{title:"Login",description:"Login to your GlobeTrotte account."}),D,o.showError?(f(),L(v,{key:0,class:"tripPrivateAlertBar",title:"Please login to continue.",type:"error"})):$("",!0),r("form",F,[t(u,{class:"loginUsernameItem",label:"Email",ref:"email",className:"loginUsername",onEnter:o.confirm},null,8,["onEnter"]),t(u,{label:"Password",ref:"password",className:"loginPassword",type:"password",onEnter:o.confirm},null,8,["onEnter"]),J,t(g,{class:"loginConfirm left_col",type:"info",onClick:o.confirm,loading:o.loading},{default:m(()=>[K]),_:1},8,["onClick","loading"]),t(g,{class:"loginCancel right_col",type:"default",onClick:o.cancel},{default:m(()=>[Y]),_:1},8,["onClick"])]),r("p",z,[t(E,{url:o.resetLink},{default:m(()=>[Q]),_:1},8,["url"])])])}const Z=S({components:{CEditItem:W,CLink:A,NAlert:O,NButton:T,CHead:M},data(){return{loading:!1,showError:!1,resetLink:V.password_Reset,loadingBar:R.loadingBar()}},beforeMount(){h.hasNext()&&(this.$data.showError=!0),p.init()},mounted(){n.get(n.get(this,"email"),"input").focus()},methods:{async confirm(){var i,l,d;this.$data.loading=!0,(i=this.$data.loadingBar)==null||i.start();const o=new q({email:n.getVal(this,"email"),password:n.getVal(this,"password")}),e=await U.genPOST("login",w.stringify(o)),a=new H(e);if(a.ID===-1){(l=this.$data.loadingBar)==null||l.error(),this.$data.loading=!1,p.messageError("Wrong email or password. Please try again.");return}(d=this.$data.loadingBar)==null||d.finish(),localStorage.setItem("userobj",w.stringify(a)),this.$data.loading=!1,p.messageSuccess("You are now logged in."),await h.paramToNext(new Map,!0)},cancel(){G.back()}}});var ie=P(Z,[["render",X],["__scopeId","data-v-db068dfa"]]);export{ie as default};
