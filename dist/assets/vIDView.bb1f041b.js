import{r as s,o as t,d as a,f as p,g as l,i,x as r,F as T,s as g,w as h,h as m,e as v,j as C,W as S}from"./vendor.b89496ae.js";import{C as V}from"./CEditTrip.9bea88c8.js";import{C as j}from"./CityUtil.5044ab31.js";import{C as B}from"./CPlaces.e7afc49d.js";import{T as c,_ as $,H as O,G as _,R as D,a as E}from"./index.c9b3b141.js";import"./E.5e463c1d.js";const P={key:0,class:"view_trip narrow_content"},N={class:"tripName"},U={key:1,class:"tripDescription"},R={class:"tripCreatorInfo"},q=m("Author: "),F=["href"],A={class:"tripCreatedDate"},G={class:"tripUpdatedDate"},H={class:"tripCities"},L={class:"viewDayCardContent"},W={class:"dayTitle"},K=m("Edit");function z(e,o,u,y,b,w){const n=s("el-alert"),f=s("el-tag"),I=s("CPlaces"),M=s("el-card"),k=s("el-button");return e.trip!==void 0?(t(),a("div",P,[e.trip.details.private?(t(),p(n,{key:0,class:"tripPrivateAlertBar",title:"Trip is private",description:"Only you can see this trip.",type:"info",closable:!1,"show-icon":""})):l("",!0),i("h2",N,r(e.trip.details.name),1),e.trip.details.description!==""?(t(),a("p",U,r(e.trip.details.description),1)):l("",!0),i("p",R,[q,i("a",{href:"/user/"+e.trip.user.ID},r(e.trip.user.name),9,F)]),i("p",A,"Created on: "+r(e.trip.timeCreated.toDateString()),1),i("p",G,"Last Updated: "+r(e.trip.lastUpdated.toDateString()),1),i("div",H,[(t(!0),a(T,null,g(e.cities,d=>(t(),p(f,{class:"tripCity"},{default:h(()=>[m(r(d),1)]),_:2},1024))),256))]),(t(!0),a(T,null,g(e.trip.details.days,d=>(t(),p(M,{class:"viewDayCard",key:d.ID.valueOf()},{default:h(()=>[i("div",L,[i("h3",W,"Day "+r(d.dayOf),1),v(I,{places:d.places},null,8,["places"])])]),_:2},1024))),128)),e.editable?(t(),p(k,{key:2,class:"enableTripEdit",onClick:e.enableEditMode},{default:h(()=>[K]),_:1},8,["onClick"])):l("",!0)])):l("",!0)}const J=C({name:"CViewTrip",components:{CPlaces:B},props:{trip:{type:c,required:!0},editable:{type:Boolean}},emits:{enableEditMode(){return!0}},data:()=>({cities:[]}),async beforeMount(){if(this.$data.cities=[],this.$props.trip!==void 0)for(let e of this.$props.trip.details.cities)this.$data.cities.push(j.toString(e))},methods:{enableEditMode(){this.$emit("enableEditMode")}}});var Q=$(J,[["render",z],["__scopeId","data-v-145ace66"]]);const X={class:"trip_info"},Y={key:0,class:"view_trip_info"},Z={key:1,class:"edit_trip_info"};function x(e,o,u,y,b,w){const n=s("CViewTrip"),f=s("CEditTrip");return t(),a("div",X,[e.editMode?(t(),a("div",Z,[v(f,{trip:e.trip,isNew:!1,onSave:e.save,onCancel:e.cancel},null,8,["trip","onSave","onCancel"])])):(t(),a("div",Y,[v(n,{trip:e.trip,editable:e.editable,onEnableEditMode:e.enableEditMode},null,8,["trip","editable","onEnableEditMode"])]))])}const ee=C({name:"CTripInfo",components:{CViewTrip:Q,CEditTrip:V},props:{trip:{type:c,required:!0},editable:{type:Boolean}},data:()=>({editMode:!1}),beforeMount(){this.$data.editMode=!1},methods:{async save(e){const o=this.$props.trip;o.details=e,await O.genPOST("v2/trip/"+e.ID,S.stringify(o))?this.$data.editMode=!1:this.$alert("Save was unsuccessful. Please try again later.","Fail",{confirmButtonText:"OK"})},cancel(){this.$data.editMode=!1},enableEditMode(){this.$data.editMode=!0}}});var te=$(ee,[["render",x]]);const ie={class:"get_view_trip narrow_content"},se=i("h1",{class:"title"},"Trip",-1);function ae(e,o,u,y,b,w){const n=s("CTripInfo");return t(),a("div",ie,[se,e.trip.ID!==-1?(t(),p(n,{key:0,trip:e.trip,editable:e.owner},null,8,["trip","editable"])):l("",!0)])}const re=C({components:{CTripInfo:te},data(){return{inputID:"",trip:new c,owner:!1}},watch:{"$route.path":async function(){await this.init()}},async beforeMount(){await this.init()},methods:{async init(){const e=_.paramID();if(e===void 0){this.$data.trip=new c,await D.genRedirectTo(E.trip_Search);return}if(this.$data.inputID=e,this.$data.trip=await _.genTrip(Number(e)),this.$data.trip.ID!==-1){this.$data.owner=_.getIsCurrentUser(this.$data.trip.user.ID.valueOf());return}this.$notify(_.notifConfig("Error","Trip not found.","error")),await D.genRedirectTo(E.trip_Search)}}});var _e=$(re,[["render",ae]]);export{_e as default};
