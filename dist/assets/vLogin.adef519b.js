var E=Object.defineProperty;var $=(s,e,a)=>e in s?E(s,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[e]=a;var l=(s,e,a)=>($(s,typeof e!="symbol"?e+"":e,a),a);import{r as d,G as k,o as c,d as B,f,g as P,i as o,e as m,H as N,w as p,h as _,j as b,W as h}from"./vendor.b76afd09.js";import{C as I,E as t}from"./E.4def98ad.js";import{_ as L,a as V,G as w,R as C,H as R,U as T,r as U}from"./index.b45d7991.js";class S{constructor(e){l(this,"email","");l(this,"password","");e&&(this.email=e.email!==void 0&&e.email!==null?e.email:"",this.password=e.password!==void 0&&e.password!==null?e.password:"")}toJsonKey(e){switch(e){case"email":return"email";case"password":return"password";default:return e}}}const x={class:"login narrow_content"},D=o("h1",{class:"title"},"Login",-1),G={class:"loginbox"},H=o("br",null,null,-1),W=_("Confirm"),M=_("Cancel"),O={class:"forgotPassword"},q=["href"];function A(s,e,a,r,n,i){const v=d("el-alert"),g=d("CEditItem"),u=d("el-button"),y=k("loading");return c(),B("div",x,[D,s.showError?(c(),f(v,{key:0,class:"tripPrivateAlertBar",title:"Please login to continue.",type:"error",closable:!1,"show-icon":""})):P("",!0),o("form",G,[m(g,{class:"loginUsernameItem",label:"Email",ref:"email",className:"loginUsername",onEnter:s.confirm},null,8,["onEnter"]),m(g,{label:"Password",ref:"password",className:"loginPassword",type:"password",onEnter:s.confirm},null,8,["onEnter"]),H,N((c(),f(u,{class:"loginConfirm",type:"primary",onClick:s.confirm},{default:p(()=>[W]),_:1},8,["onClick"])),[[y,s.loading,void 0,{fullscreen:!0,lock:!0}]]),m(u,{class:"loginCancel",type:"default",onClick:s.cancel},{default:p(()=>[M]),_:1},8,["onClick"])]),o("p",O,[o("a",{href:s.resetLink},"Forgot Password?",8,q)])])}const F=b({components:{CEditItem:I},data(){return{loading:!1,showError:!1,resetLink:V.password_Reset,loadingBar:w.loadingBar()}},beforeMount(){C.hasNext()&&(this.$data.showError=!0)},mounted(){t.get(t.get(this,"email"),"input").focus()},methods:{async confirm(){var r,n,i;this.$data.loading=!0,(r=this.$data.loadingBar)==null||r.start();const s=new S({email:t.getVal(this,"email"),password:t.getVal(this,"password")}),e=await R.genPOST("login",h.stringify(s)),a=new T(e);if(a.ID===-1){(n=this.$data.loadingBar)==null||n.error(),this.$data.loading=!1,this.$message({type:"error",message:"Wrong email or password. Please try again."});return}(i=this.$data.loadingBar)==null||i.finish(),localStorage.setItem("userobj",h.stringify(a)),this.$data.loading=!1,this.$notify(w.notifConfig("Success","You are now logged in.","success")),await C.paramToNext(new Map,!0)},cancel(){U.back()}}});var z=L(F,[["render",A]]);export{z as default};
