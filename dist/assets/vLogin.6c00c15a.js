var v=Object.defineProperty;var y=(a,e,o)=>e in a?v(a,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):a[e]=o;var c=(a,e,o)=>(y(a,typeof e!="symbol"?e+"":e,o),o);import{d as B,aX as L,N as $,g as I,G as f,R as w,f as P,aS as b,b3 as S,r as t,o as h,c as U,a as s,k as T,q as V,e as r,w as m,j as p,p as R,b as H,_ as G}from"./index.0d9bf95c.js";import{C as q,E as n}from"./CEditItem.2ae3176c.js";import{C as A}from"./CLink.dd524343.js";import{U as M}from"./UserObj.4e69ea7a.js";import{N as u}from"./NaiveUtils.6dca6660.js";import{C as O}from"./CHead.e683163e.js";import"./Input.2dd53aad.js";import"./TripObj.ec2b71ae.js";class W{constructor(e){c(this,"email","");c(this,"password","");e&&(this.email=e.email!==void 0&&e.email!==null?e.email:"",this.password=e.password!==void 0&&e.password!==null?e.password:"")}toJsonKey(e){switch(e){case"email":return"email";case"password":return"password";default:return e}}}const x=B({components:{CEditItem:q,CLink:A,NAlert:L,NButton:$,CHead:O},data(){return{loading:!1,showError:!1,resetLink:I.password_Reset,loadingBar:f.loadingBar()}},beforeMount(){w.hasNext()&&(this.$data.showError=!0),u.init()},mounted(){n.get(n.get(this,"email"),"input").focus()},methods:{async confirm(){var i,l,d;this.$data.loading=!0,(i=this.$data.loadingBar)==null||i.start();const a=new W({email:n.getVal(this,"email"),password:n.getVal(this,"password")}),e=await P.genPOST("login",b.stringify(a));if(new M(e).ID===-1){(l=this.$data.loadingBar)==null||l.error(),this.$data.loading=!1,u.messageError("Wrong email or password. Please try again.");return}await f.genCurrentUser(),(d=this.$data.loadingBar)==null||d.finish(),this.$data.loading=!1,u.messageSuccess("You are now logged in."),await w.paramToNext(new Map,!0)},cancel(){S.back()}}}),C=a=>(R("data-v-2195b5d3"),a=a(),H(),a),D={class:"login narrow_content"},F=C(()=>r("h1",{class:"title"},"Login",-1)),J={class:"narrow_display_window"},K=C(()=>r("br",null,null,-1)),X={class:"forgotPassword"};function Y(a,e,o,i,l,d){const k=t("CHead"),E=t("n-alert"),g=t("CEditItem"),_=t("n-button"),N=t("CLink");return h(),U("div",D,[s(k,{title:"Login",description:"Login to your GlobeTrotte account."}),F,a.showError?(h(),T(E,{key:0,class:"tripPrivateAlertBar",title:"Please login to continue.",type:"error"})):V("",!0),r("form",J,[s(g,{class:"loginUsernameItem",label:"Email",ref:"email",className:"loginUsername",onEnter:a.confirm},null,8,["onEnter"]),s(g,{label:"Password",ref:"password",className:"loginPassword",type:"password",onEnter:a.confirm},null,8,["onEnter"]),K,s(_,{class:"loginConfirm left_col",type:"info",onClick:a.confirm,loading:a.loading},{default:m(()=>[p("Confirm")]),_:1},8,["onClick","loading"]),s(_,{class:"loginCancel right_col",type:"default",onClick:a.cancel},{default:m(()=>[p("Cancel")]),_:1},8,["onClick"])]),r("p",X,[s(N,{url:a.resetLink},{default:m(()=>[p("Forgot Password?")]),_:1},8,["url"])])])}const ne=G(x,[["render",Y],["__scopeId","data-v-2195b5d3"]]);export{ne as default};
