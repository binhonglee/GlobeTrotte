var k=Object.defineProperty;var E=(s,e,a)=>e in s?k(s,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[e]=a;var c=(s,e,a)=>(E(s,typeof e!="symbol"?e+"":e,a),a);import{r as t,o as g,d as $,f as B,g as I,i as r,e as o,w as m,t as N,v as L,h as p,j as P,M as b,z as S,W as f}from"./vendor.834a3fba.js";import{C as V,E as n}from"./E.906537a2.js";import{C as R}from"./CLink.edfdc9f8.js";import{_ as T,a as U,G as h,R as w,H as M,U as W,r as A}from"./index.e48dfa1b.js";class G{constructor(e){c(this,"email","");c(this,"password","");e&&(this.email=e.email!==void 0&&e.email!==null?e.email:"",this.password=e.password!==void 0&&e.password!==null?e.password:"")}toJsonKey(e){switch(e){case"email":return"email";case"password":return"password";default:return e}}}const C=s=>(N("data-v-61b9b530"),s=s(),L(),s),H={class:"login narrow_content"},O=C(()=>r("h1",{class:"title"},"Login",-1)),q={class:"narrow_display_window"},x=C(()=>r("br",null,null,-1)),z=p("Confirm"),D=p("Cancel"),F={class:"forgotPassword"},J=p("Forgot Password?");function K(s,e,a,i,l,d){const v=t("n-alert"),u=t("CEditItem"),_=t("n-button"),y=t("CLink");return g(),$("div",H,[O,s.showError?(g(),B(v,{key:0,class:"tripPrivateAlertBar",title:"Please login to continue.",type:"error"})):I("",!0),r("form",q,[o(u,{class:"loginUsernameItem",label:"Email",ref:"email",className:"loginUsername",onEnter:s.confirm},null,8,["onEnter"]),o(u,{label:"Password",ref:"password",className:"loginPassword",type:"password",onEnter:s.confirm},null,8,["onEnter"]),x,o(_,{class:"loginConfirm left_col",type:"info",onClick:s.confirm,loading:s.loading},{default:m(()=>[z]),_:1},8,["onClick","loading"]),o(_,{class:"loginCancel right_col",type:"default",onClick:s.cancel},{default:m(()=>[D]),_:1},8,["onClick"])]),r("p",F,[o(y,{url:s.resetLink},{default:m(()=>[J]),_:1},8,["url"])])])}const Y=P({components:{CEditItem:V,CLink:R,NAlert:b,NButton:S},data(){return{loading:!1,showError:!1,resetLink:U.password_Reset,loadingBar:h.loadingBar()}},beforeMount(){w.hasNext()&&(this.$data.showError=!0)},mounted(){n.get(n.get(this,"email"),"input").focus()},methods:{async confirm(){var i,l,d;this.$data.loading=!0,(i=this.$data.loadingBar)==null||i.start();const s=new G({email:n.getVal(this,"email"),password:n.getVal(this,"password")}),e=await M.genPOST("login",f.stringify(s)),a=new W(e);if(a.ID===-1){(l=this.$data.loadingBar)==null||l.error(),this.$data.loading=!1,this.$message({type:"error",message:"Wrong email or password. Please try again."});return}(d=this.$data.loadingBar)==null||d.finish(),localStorage.setItem("userobj",f.stringify(a)),this.$data.loading=!1,this.$notify(h.notifConfig("Success","You are now logged in.","success")),await w.paramToNext(new Map,!0)},cancel(){A.back()}}});var se=T(Y,[["render",K],["__scopeId","data-v-61b9b530"]]);export{se as default};
