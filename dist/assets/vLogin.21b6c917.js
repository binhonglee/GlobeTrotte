import{d as N,aX as v,N as y,g as B,G as u,R as g,f as L,aS as $,b1 as I,r as s,o as f,c as P,a,j as b,q as S,e as n,w as d,p as U,b as T,k as m,_ as V}from"./index.f6031db9.js";import{C as R,E as t}from"./CEditItem.22aba648.js";import{C as H}from"./CLink.aed05e91.js";import{U as G}from"./UserObj.f89f1b9f.js";import{N as c}from"./NaiveUtils.c7e89fb4.js";import{C as q}from"./CHead.c5e88900.js";import"./Input.aa3a5b86.js";import"./TripObj.a755d029.js";class A{constructor(o){this.email="",this.password="",o&&(this.email=o.email!==void 0&&o.email!==null?o.email:"",this.password=o.password!==void 0&&o.password!==null?o.password:"")}toJsonKey(o){switch(o){case"email":return"email";case"password":return"password";default:return o}}}const M=N({components:{CEditItem:R,CLink:H,NAlert:v,NButton:y,CHead:q},data(){return{loading:!1,showError:!1,resetLink:B.password_Reset,loadingBar:u.loadingBar()}},beforeMount(){g.hasNext()&&(this.$data.showError=!0),c.init()},mounted(){t.get(t.get(this,"email"),"input").focus()},methods:{async confirm(){var r,i,l;this.$data.loading=!0,(r=this.$data.loadingBar)==null||r.start();const e=new A({email:t.getVal(this,"email"),password:t.getVal(this,"password")}),o=await L.genPOST("login",$.stringify(e));if(new G(o).ID===-1){(i=this.$data.loadingBar)==null||i.error(),this.$data.loading=!1,c.messageError("Wrong email or password. Please try again.");return}await u.genCurrentUser(),(l=this.$data.loadingBar)==null||l.finish(),this.$data.loading=!1,c.messageSuccess("You are now logged in."),await g.paramToNext(new Map,!0)},cancel(){I.back()}}}),h=e=>(U("data-v-2195b5d3"),e=e(),T(),e),O={class:"login narrow_content"},W=h(()=>n("h1",{class:"title"},"Login",-1)),x={class:"narrow_display_window"},D=h(()=>n("br",null,null,-1)),F=m("Confirm"),J=m("Cancel"),K={class:"forgotPassword"},X=m("Forgot Password?");function Y(e,o,w,r,i,l){const C=s("CHead"),k=s("n-alert"),p=s("CEditItem"),_=s("n-button"),E=s("CLink");return f(),P("div",O,[a(C,{title:"Login",description:"Login to your GlobeTrotte account."}),W,e.showError?(f(),b(k,{key:0,class:"tripPrivateAlertBar",title:"Please login to continue.",type:"error"})):S("",!0),n("form",x,[a(p,{class:"loginUsernameItem",label:"Email",ref:"email",className:"loginUsername",onEnter:e.confirm},null,8,["onEnter"]),a(p,{label:"Password",ref:"password",className:"loginPassword",type:"password",onEnter:e.confirm},null,8,["onEnter"]),D,a(_,{class:"loginConfirm left_col",type:"info",onClick:e.confirm,loading:e.loading},{default:d(()=>[F]),_:1},8,["onClick","loading"]),a(_,{class:"loginCancel right_col",type:"default",onClick:e.cancel},{default:d(()=>[J]),_:1},8,["onClick"])]),n("p",K,[a(E,{url:e.resetLink},{default:d(()=>[X]),_:1},8,["url"])])])}const te=V(M,[["render",Y],["__scopeId","data-v-2195b5d3"]]);export{te as default};
