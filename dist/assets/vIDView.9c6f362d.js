import{r as s,o as e,d as a,i,f as l,w as _,g as u,z as r,e as h,h as f,F as T,s as D,j as v,I as N,t as S,A as V,C as j,W as B}from"./vendor.1f9c1f67.js";import{C as O}from"./CEditTrip.04bb7b93.js";import{C as L}from"./CPlaces.bf3bbe53.js";import{C as R}from"./CLink.dc413554.js";import{C as U,D as A}from"./DataProps.691205bd.js";import{T as n,_ as $,H as q,G as m,R as g,a as I}from"./index.bdc640f9.js";import"./E.5edccef9.js";const F={key:0,class:"view_trip"},G={class:"narrow_content"},H=f("Only you can see this trip."),W={class:"tripName"},z={key:1,class:"tripDescription"},K={class:"tripCreatorInfo"},J=f("Author: "),Q={class:"tripCreatedDate"},X={class:"tripUpdatedDate"},Y={class:"tripCities"},Z={class:"viewDays"},x={class:"viewDayCardContent"},tt={class:"dayTitle"},et={class:"narrow_content"},it=f("Edit");function st(t,o,d,y,b,w){const p=s("n-alert"),C=s("CLink"),E=s("n-tag"),k=s("CPlaces"),M=s("n-card"),P=s("n-button");return t.trip!==void 0?(e(),a("div",F,[i("div",G,[t.trip.details.private?(e(),l(p,{key:0,class:"tripPrivateAlertBar",title:"Trip is private",type:"info"},{default:_(()=>[H]),_:1})):u("",!0),i("h2",W,r(t.trip.details.name),1),t.trip.details.description!==""?(e(),a("p",z,r(t.trip.details.description),1)):u("",!0),i("p",K,[J,h(C,{url:"/user/"+t.trip.user.ID},{default:_(()=>[f(r(t.trip.user.name),1)]),_:1},8,["url"])]),i("p",Q,"Created on: "+r(t.trip.timeCreated.toDateString()),1),i("p",X,"Last Updated: "+r(t.trip.lastUpdated.toDateString()),1),i("div",Y,[(e(!0),a(T,null,D(t.cities,c=>(e(),l(E,{class:"tripCity",type:"info"},{default:_(()=>[f(r(c),1)]),_:2},1024))),256))])]),i("div",Z,[(e(!0),a(T,null,D(t.days,c=>(e(),l(M,{class:"viewDayCard",key:c.ID.valueOf(),"content-style":"padding: 0"},{default:_(()=>[i("div",x,[i("h3",tt,"Day "+r(c.dayOf),1),h(k,{propPlaces:c.propPlaces},null,8,["propPlaces"])])]),_:2},1024))),128))]),i("div",et,[t.editable?(e(),l(P,{key:0,class:"enableTripEdit",onClick:t.enableEditMode},{default:_(()=>[it]),_:1},8,["onClick"])):u("",!0)])])):u("",!0)}const at=v({name:"CViewTrip",components:{CLink:R,CPlaces:L,NAlert:N,NButton:S,NCard:V,NTag:j},props:{trip:{type:n,required:!0},editable:{type:Boolean}},emits:{enableEditMode(){return!0}},data:()=>({days:[],cities:[]}),beforeMount(){if(this.$data.cities=[],this.$props.trip!==void 0){for(let t of this.$props.trip.details.cities)this.$data.cities.push(U.toString(t));this.$data.days=this.$props.trip.details.days.slice(0).map(t=>new A(t))}},methods:{enableEditMode(){this.$emit("enableEditMode")}}});var rt=$(at,[["render",st],["__scopeId","data-v-222a4516"]]);const nt={class:"trip_info"},ot={key:0,class:"view_trip_info"},dt={key:1,class:"edit_trip_info"};function pt(t,o,d,y,b,w){const p=s("CViewTrip"),C=s("CEditTrip");return e(),a("div",nt,[t.editMode?(e(),a("div",dt,[h(C,{trip:t.dtrip,isNew:!1,onSave:t.save,onCancel:t.cancel},null,8,["trip","onSave","onCancel"])])):(e(),a("div",ot,[h(p,{trip:t.dtrip,editable:t.editable,onEnableEditMode:t.enableEditMode},null,8,["trip","editable","onEnableEditMode"])]))])}const ct=v({name:"CTripInfo",components:{CViewTrip:rt,CEditTrip:O},props:{trip:{type:n,required:!0},editable:{type:Boolean}},data:()=>({editMode:!1,dtrip:new n}),beforeMount(){this.$data.editMode=!1,this.$data.dtrip=this.$props.trip},methods:{async save(t){const o=this.$props.trip;o.details=t;const d=await q.genPOST("v2/trip/"+t.ID,B.stringify(o));d?(this.$data.dtrip=new n(d),this.$data.editMode=!1):this.$alert("Save was unsuccessful. Please try again later.","Fail",{confirmButtonText:"OK"})},cancel(){this.$data.editMode=!1},enableEditMode(){this.$data.editMode=!0}}});var lt=$(ct,[["render",pt]]);const _t={class:"get_view_trip"},ut=i("h1",{class:"title"},"Trip",-1);function ft(t,o,d,y,b,w){const p=s("CTripInfo");return e(),a("div",_t,[ut,t.trip.ID!==-1?(e(),l(p,{key:0,trip:t.trip,editable:t.owner},null,8,["trip","editable"])):u("",!0)])}const ht=v({components:{CTripInfo:lt},data(){return{inputID:"",trip:new n,owner:!1}},async beforeMount(){await this.init()},methods:{async init(){const t=m.paramID();if(t===void 0){this.$data.trip=new n,await g.genRedirectTo(I.trip_Search);return}if(this.$data.inputID=t,this.$data.trip=await m.genTrip(Number(t)),this.$data.trip.ID!==-1){this.$data.owner=m.getIsCurrentUser(this.$data.trip.user.ID.valueOf());return}this.$notify(m.notifConfig("Error","Trip not found.","error")),await g.genRedirectTo(I.trip_Search)}}});var Tt=$(ht,[["render",ft]]);export{Tt as default};
