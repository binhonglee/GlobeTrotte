import{C as B}from"./CHead.9e0f6942.js";import{r as n,o as i,c as o,e as a,a as e,F as b,g as I,w as c,p as L,b as N,d as C,m as M,q as A,_ as $,h as _,l as g,t as l,i as u,a_ as S,N as j,T as h,j as R,k,G as w,aV as q,R as U}from"./index.aad00f9d.js";import{N as H,C as F}from"./CPlaces.ff16d74f.js";import{C as G,T as K}from"./CEditTrip.1f42f1a4.js";import{C as W}from"./CLink.c58718fb.js";import{C as z}from"./CShare.5b9528f3.js";import{N as J,D as Q}from"./DataProps.d8775459.js";import{N as y,a as X}from"./NaiveUtils.b9dd3ae8.js";import{s as Y}from"./TripUtil.2f6761e7.js";import"./Input.3492633e.js";import"./CEditItem.c1307365.js";import"./CacheStorage.3773b082.js";import"./Select.f91fb16d.js";const E=t=>(L("data-v-19df97e0"),t=t(),N(),t),Z={class:"loading_trip_info narrow_display_window"},tt={class:"narrow_content"},et={class:"row"},at=E(()=>a("p",{class:"tripCreatorInfo"},"Author:",-1)),it={class:"row"},st=E(()=>a("p",{class:"tripUpdatedDate"},"Last Updated:",-1)),nt={class:"row"},dt=E(()=>a("p",{class:"tripCreatedDate"},"Created on:",-1)),ot={class:"loadingDays"};function rt(t,d,r,D,T,x){const s=n("n-skeleton"),p=n("n-divider"),m=n("n-card");return i(),o("div",Z,[a("div",tt,[e(s,{height:"40px"}),e(s,{text:""}),a("div",et,[at,e(s,{class:"inline_text",text:"",width:"30%"})]),a("div",it,[st,e(s,{class:"inline_text",text:"",width:"30%"})]),a("div",nt,[dt,e(s,{class:"inline_text",text:"",width:"30%"})]),e(s,{class:"cities",height:"28px",width:"200px"}),e(s,{class:"share",height:"35px",width:"75px"})]),a("div",ot,[(i(),o(b,null,I(3,v=>e(m,{class:"loadingDayCard",key:v,"content-style":"padding: 0"},{default:c(()=>[e(s,{class:"loadingDayTitle",height:"20px"}),e(p),e(s,{class:"loadingDayText",text:"",row:2}),e(p),e(s,{class:"loadingDayText lastLoadingDayText",text:"",row:2})]),_:2},1024)),64))])])}const pt=C({name:"CLoadingTripInfo",components:{NCard:M,NDivider:A,NSkeleton:H}});var lt=$(pt,[["render",rt],["__scopeId","data-v-19df97e0"]]);const ct={key:0,class:"view_trip"},_t={class:"narrow_content"},ht=u("Only you can see this trip."),ut={class:"tripName left_col"},mt={key:1,class:"tripDescription"},vt={class:"tripCreatorInfo"},ft=u("Author: "),gt={class:"tripUpdatedDate"},wt={class:"tripCreatedDate"},yt={class:"tripCities"},Ct={class:"viewDays"},$t={class:"viewDayCardContent"},Dt={class:"dayTitle"},Tt={class:"narrow_content enableTripEdit"},xt=u("Edit");function bt(t,d,r,D,T,x){const s=n("n-alert"),p=n("CLink"),m=n("n-tag"),v=n("CShare"),O=n("CPlaces"),V=n("n-card"),P=n("n-button");return t.trip!==void 0?(i(),o("div",ct,[a("div",_t,[t.trip.details.private?(i(),_(s,{key:0,class:"tripPrivateAlertBar",title:"Trip is private",type:"info"},{default:c(()=>[ht]),_:1})):g("",!0),a("h2",ut,l(t.trip.details.name),1),t.trip.details.description!==""?(i(),o("p",mt,l(t.trip.details.description),1)):g("",!0),a("p",vt,[ft,e(p,{url:"/user/"+t.trip.user.username},{default:c(()=>[u(l(t.trip.user.name),1)]),_:1},8,["url"])]),a("p",gt,"Last Updated: "+l(t.lastUpdated),1),a("p",wt,"Created on: "+l(t.created),1),a("div",yt,[(i(!0),o(b,null,I(t.cities,f=>(i(),_(m,{class:"tripCity",type:"info"},{default:c(()=>[u(l(f),1)]),_:2},1024))),256))]),e(v,{shareURL:t.shareURL},null,8,["shareURL"])]),a("div",Ct,[(i(!0),o(b,null,I(t.days,f=>(i(),_(V,{class:"viewDayCard",key:f.ID.valueOf(),"content-style":"padding: 0"},{default:c(()=>[a("div",$t,[a("h3",Dt,"Day "+l(f.dayOf),1),e(O,{propPlaces:f.propPlaces},null,8,["propPlaces"])])]),_:2},1024))),128))]),a("div",Tt,[t.editable?(i(),_(P,{key:0,class:"editTripButton right_col",onClick:t.enableEditMode},{default:c(()=>[xt]),_:1},8,["onClick"])):g("",!0)])])):g("",!0)}const It=C({name:"CViewTrip",components:{CLink:W,CPlaces:F,CShare:z,NAlert:S,NButton:j,NCard:M,NTag:J},props:{trip:{type:h,required:!0},editable:{type:Boolean}},emits:{enableEditMode(){return!0}},data:()=>({days:[],cities:[],shareURL:"",created:"",lastUpdated:""}),beforeMount(){this.$data.cities=[];for(let t of this.$props.trip.details.cities)this.$data.cities.push(t.display.valueOf()+", "+t.iso2.valueOf());this.$data.days=this.$props.trip.details.days.slice(0).map(t=>new Q(t)),this.$data.shareURL=R.getAbsoluteURL(k.trip_View,this.$props.trip.ID.toString()),this.$data.created=w.getDisplayDate(this.$props.trip.timeCreated),this.$data.lastUpdated=w.getDisplayDate(this.$props.trip.lastUpdated)},methods:{enableEditMode(){this.$emit("enableEditMode")}}});var kt=$(It,[["render",bt],["__scopeId","data-v-22d4136e"]]);const Et={class:"trip_info narrow_display_window"},Ut={key:0,class:"view_trip_info"},Lt={key:1,class:"edit_trip_info"};function Nt(t,d,r,D,T,x){const s=n("CViewTrip"),p=n("CEditTrip");return i(),o("div",Et,[t.editMode?(i(),o("div",Lt,[e(p,{trip:t.dtrip,isNew:!1,onSave:t.save,onCancel:t.cancel},null,8,["trip","onSave","onCancel"])])):(i(),o("div",Ut,[e(s,{trip:t.dtrip,editable:t.editable,onEnableEditMode:t.enableEditMode},null,8,["trip","editable","onEnableEditMode"])]))])}const Mt=C({name:"CTripInfo",components:{CViewTrip:kt,CEditTrip:G},props:{trip:{type:h,required:!0},editable:{type:Boolean}},data:()=>({editMode:!1,dtrip:new h}),beforeMount(){this.$data.editMode=!1,this.$data.dtrip=this.$props.trip,y.init()},methods:{async save(t){const d=this.$props.trip;d.details=t;const r=await R.genPOST("v2/trip/"+t.ID,q.stringify(d));r?(this.$data.dtrip=new h(r),this.$data.editMode=!1):y.dialogError({title:"Error",content:"Save was unsuccessful. Please try again later.",positiveText:"OK"})},cancel(){this.$data.editMode=!1},enableEditMode(){this.$data.editMode=!0}}});var St=$(Mt,[["render",Nt]]);const Rt=t=>(L("data-v-33332509"),t=t(),N(),t),Ot={class:"get_view_trip"},Vt={key:0,class:"narrow_content tapToUpdate"},Pt=u("Press here to view latest version of this profile."),Bt=Rt(()=>a("h1",{class:"title"},"Trip",-1));function At(t,d,r,D,T,x){const s=n("CHead"),p=n("n-alert"),m=n("CLoadingTripInfo"),v=n("CTripInfo");return i(),o("div",Ot,[e(s,{title:t.trip.details.name.valueOf(),description:t.trip.details.description.valueOf(),type:"article"},null,8,["title","description"]),t.updated!==null?(i(),o("div",Vt,[e(p,{title:"There's an update!",type:"warning",onClick:t.update},{default:c(()=>[Pt]),_:1},8,["onClick"])])):g("",!0),Bt,t.trip.ID===-1?(i(),_(m,{key:1})):(i(),_(v,{key:2,trip:t.trip,editable:t.owner},null,8,["trip","editable"]))])}const jt=C({components:{CHead:B,CLoadingTripInfo:lt,CTripInfo:St,NAlert:S},data(){return{inputID:"",trip:new h,updated:null,owner:!1}},beforeMount(){y.init()},async mounted(){await this.init()},methods:{async init(){const t=w.paramID();if(t===void 0){this.$data.trip=new h,await U.genRedirectTo(k.trip_Search);return}this.$data.inputID=t;const d=await K.genObj(t);if(d.completed!==null&&(this.$data.trip=d.completed),d.promise!==null){const r=await d.promise;r!==null&&!Y(r,this.$data.trip)&&(this.$data.updated=r)}if(this.$data.trip.ID!==-1){this.$data.owner=w.getIsCurrentUser(this.$data.trip.user.ID.valueOf());return}y.notifyTrigger("Error","Trip not found.",X.ERROR),await U.genRedirectTo(k.trip_Search)},update(){this.$data.updated!==null&&(this.$data.trip=this.$data.updated),this.$data.updated=null}}});var ee=$(jt,[["render",At],["__scopeId","data-v-33332509"]]);export{ee as default};
