var y=Object.defineProperty;var E=(s,e,o)=>e in s?y(s,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):s[e]=o;var c=(s,e,o)=>(E(s,typeof e!="symbol"?e+"":e,o),o);import{r as t,o as g,d as $,f as B,g as I,i as n,e as a,w as m,q as L,s as N,h as p,j as P,K as b,x as S,W as f}from"./vendor.7e867dc2.js";import{C as V,E as r}from"./E.32200074.js";import{C as R}from"./CLink.d8c52d9c.js";import{_ as T,a as U,G as h,R as w,H as x,U as W,r as q}from"./index.7963d8ee.js";class A{constructor(e){c(this,"email","");c(this,"password","");e&&(this.email=e.email!==void 0&&e.email!==null?e.email:"",this.password=e.password!==void 0&&e.password!==null?e.password:"")}toJsonKey(e){switch(e){case"email":return"email";case"password":return"password";default:return e}}}const C=s=>(L("data-v-61b9b530"),s=s(),N(),s),G={class:"login narrow_content"},H=C(()=>n("h1",{class:"title"},"Login",-1)),K={class:"narrow_display_window"},M=C(()=>n("br",null,null,-1)),O=p("Confirm"),j=p("Cancel"),D={class:"forgotPassword"},F=p("Forgot Password?");function J(s,e,o,i,l,d){const k=t("n-alert"),u=t("CEditItem"),_=t("n-button"),v=t("CLink");return g(),$("div",G,[H,s.showError?(g(),B(k,{key:0,class:"tripPrivateAlertBar",title:"Please login to continue.",type:"error"})):I("",!0),n("form",K,[a(u,{class:"loginUsernameItem",label:"Email",ref:"email",className:"loginUsername",onEnter:s.confirm},null,8,["onEnter"]),a(u,{label:"Password",ref:"password",className:"loginPassword",type:"password",onEnter:s.confirm},null,8,["onEnter"]),M,a(_,{class:"loginConfirm left_col",type:"info",onClick:s.confirm,loading:s.loading},{default:m(()=>[O]),_:1},8,["onClick","loading"]),a(_,{class:"loginCancel right_col",type:"default",onClick:s.cancel},{default:m(()=>[j]),_:1},8,["onClick"])]),n("p",D,[a(v,{url:s.resetLink},{default:m(()=>[F]),_:1},8,["url"])])])}const Y=P({components:{CEditItem:V,CLink:R,NAlert:b,NButton:S},data(){return{loading:!1,showError:!1,resetLink:U.password_Reset,loadingBar:h.loadingBar()}},beforeMount(){w.hasNext()&&(this.$data.showError=!0)},mounted(){r.get(r.get(this,"email"),"input").focus()},methods:{async confirm(){var i,l,d;this.$data.loading=!0,(i=this.$data.loadingBar)==null||i.start();const s=new A({email:r.getVal(this,"email"),password:r.getVal(this,"password")}),e=await x.genPOST("login",f.stringify(s)),o=new W(e);if(o.ID===-1){(l=this.$data.loadingBar)==null||l.error(),this.$data.loading=!1,this.$message({type:"error",message:"Wrong email or password. Please try again."});return}(d=this.$data.loadingBar)==null||d.finish(),localStorage.setItem("userobj",f.stringify(o)),this.$data.loading=!1,this.$notify(h.notifConfig("Success","You are now logged in.","success")),await w.paramToNext(new Map,!0)},cancel(){q.back()}}});var se=T(Y,[["render",J],["__scopeId","data-v-61b9b530"]]);export{se as default};
