import{C as V}from"./CHead.f280bebb.js";import{r as o,o as s,c as n,e as i,a as e,F as I,g as k,w as l,p as P,b as B,d as y,m as U,q as A,_ as w,h as _,l as C,t as d,i as $,a$ as q,N as H,T as h,j as M,k as E,G as m,aW as j,R as L}from"./index.332ea37a.js";import{N as x,C as F}from"./CPlaces.709fde2e.js";import{C as G}from"./CEditTrip.b1532e70.js";import{C as W}from"./CLink.b580a7a9.js";import{C as K}from"./CShare.631942e4.js";import{N as z,C as J,D as Q}from"./DataProps.f815496d.js";import{N as v,a as X}from"./NaiveUtils.e348e6ea.js";import"./Input.de5362c6.js";import"./E.9c0db437.js";import"./Select.306ce2ad.js";const N=t=>(P("data-v-da09f6ba"),t=t(),B(),t),Y={class:"loading_trip_info narrow_display_window"},Z={class:"narrow_content"},tt={class:"row"},et=N(()=>i("p",{class:"tripCreatorInfo"},"Author:",-1)),it={class:"row"},at=N(()=>i("p",{class:"tripUpdatedDate"},"Last Updated:",-1)),st={class:"row"},ot=N(()=>i("p",{class:"tripCreatedDate"},"Created on:",-1)),nt={class:"loadingDays"};function rt(t,p,c,g,T,D){const a=o("n-skeleton"),r=o("n-divider"),u=o("n-card");return s(),n("div",Y,[i("div",Z,[e(a,{height:"40px"}),e(a,{text:""}),i("div",tt,[et,e(a,{class:"inline_text",text:"",width:"30%"})]),i("div",it,[at,e(a,{class:"inline_text",text:"",width:"30%"})]),i("div",st,[ot,e(a,{class:"inline_text",text:"",width:"30%"})]),e(a,{class:"cities",height:"28px",width:"200px"}),e(a,{class:"share",height:"35px",width:"75px"})]),i("div",nt,[(s(),n(I,null,k(3,b=>e(u,{class:"loadingDayCard",key:b,"content-style":"padding: 0"},{default:l(()=>[e(a,{class:"loadingDayTitle",height:"20px"}),e(r),e(a,{class:"loadingDayText",text:"",row:2}),e(r),e(a,{class:"loadingDayText lastLoadingDayText",text:"",row:2})]),_:2},1024)),64))])])}const dt=y({name:"CLoadingTripInfo",components:{NCard:U,NDivider:A,NSkeleton:x}});var pt=w(dt,[["render",rt],["__scopeId","data-v-da09f6ba"]]);const ct={key:0,class:"view_trip"},lt={class:"narrow_content"},_t=$("Only you can see this trip."),ht={class:"tripName left_col"},ut={key:1,class:"tripDescription"},ft={class:"tripCreatorInfo"},mt=$("Author: "),$t={class:"tripUpdatedDate"},Ct={class:"tripCreatedDate"},vt={class:"tripCities"},yt={class:"viewDays"},wt={class:"viewDayCardContent"},gt={class:"dayTitle"},Tt={class:"narrow_content enableTripEdit"},Dt=$("Edit");function bt(t,p,c,g,T,D){const a=o("n-alert"),r=o("CLink"),u=o("n-tag"),b=o("CShare"),S=o("CPlaces"),R=o("n-card"),O=o("n-button");return t.trip!==void 0?(s(),n("div",ct,[i("div",lt,[t.trip.details.private?(s(),_(a,{key:0,class:"tripPrivateAlertBar",title:"Trip is private",type:"info"},{default:l(()=>[_t]),_:1})):C("",!0),i("h2",ht,d(t.trip.details.name),1),t.trip.details.description!==""?(s(),n("p",ut,d(t.trip.details.description),1)):C("",!0),i("p",ft,[mt,e(r,{url:"/user/"+t.trip.user.username},{default:l(()=>[$(d(t.trip.user.name),1)]),_:1},8,["url"])]),i("p",$t,"Last Updated: "+d(t.lastUpdated),1),i("p",Ct,"Created on: "+d(t.created),1),i("div",vt,[(s(!0),n(I,null,k(t.cities,f=>(s(),_(u,{class:"tripCity",type:"info"},{default:l(()=>[$(d(f),1)]),_:2},1024))),256))]),e(b,{shareURL:t.shareURL},null,8,["shareURL"])]),i("div",yt,[(s(!0),n(I,null,k(t.days,f=>(s(),_(R,{class:"viewDayCard",key:f.ID.valueOf(),"content-style":"padding: 0"},{default:l(()=>[i("div",wt,[i("h3",gt,"Day "+d(f.dayOf),1),e(S,{propPlaces:f.propPlaces},null,8,["propPlaces"])])]),_:2},1024))),128))]),i("div",Tt,[t.editable?(s(),_(O,{key:0,class:"editTripButton right_col",onClick:t.enableEditMode},{default:l(()=>[Dt]),_:1},8,["onClick"])):C("",!0)])])):C("",!0)}const It=y({name:"CViewTrip",components:{CLink:W,CPlaces:F,CShare:K,NAlert:q,NButton:H,NCard:U,NTag:z},props:{trip:{type:h,required:!0},editable:{type:Boolean}},emits:{enableEditMode(){return!0}},data:()=>({days:[],cities:[],shareURL:"",created:"",lastUpdated:""}),beforeMount(){this.$data.cities=[];for(let t of this.$props.trip.details.cities)this.$data.cities.push(J.toString(t));this.$data.days=this.$props.trip.details.days.slice(0).map(t=>new Q(t)),this.$data.shareURL=M.getAbsoluteURL(E.trip_View,this.$props.trip.ID.toString()),this.$data.created=m.getDisplayDate(this.$props.trip.timeCreated),this.$data.lastUpdated=m.getDisplayDate(this.$props.trip.lastUpdated)},methods:{enableEditMode(){this.$emit("enableEditMode")}}});var kt=w(It,[["render",bt],["__scopeId","data-v-1779312a"]]);const Et={class:"trip_info narrow_display_window"},Nt={key:0,class:"view_trip_info"},Lt={key:1,class:"edit_trip_info"};function Ut(t,p,c,g,T,D){const a=o("CViewTrip"),r=o("CEditTrip");return s(),n("div",Et,[t.editMode?(s(),n("div",Lt,[e(r,{trip:t.dtrip,isNew:!1,onSave:t.save,onCancel:t.cancel},null,8,["trip","onSave","onCancel"])])):(s(),n("div",Nt,[e(a,{trip:t.dtrip,editable:t.editable,onEnableEditMode:t.enableEditMode},null,8,["trip","editable","onEnableEditMode"])]))])}const Mt=y({name:"CTripInfo",components:{CViewTrip:kt,CEditTrip:G},props:{trip:{type:h,required:!0},editable:{type:Boolean}},data:()=>({editMode:!1,dtrip:new h}),beforeMount(){this.$data.editMode=!1,this.$data.dtrip=this.$props.trip,v.init()},methods:{async save(t){const p=this.$props.trip;p.details=t;const c=await M.genPOST("v2/trip/"+t.ID,j.stringify(p));c?(this.$data.dtrip=new h(c),this.$data.editMode=!1):v.dialogError({title:"Error",content:"Save was unsuccessful. Please try again later.",positiveText:"OK"})},cancel(){this.$data.editMode=!1},enableEditMode(){this.$data.editMode=!0}}});var St=w(Mt,[["render",Ut]]);const Rt={class:"get_view_trip"},Ot=i("h1",{class:"title"},"Trip",-1);function Vt(t,p,c,g,T,D){const a=o("CHead"),r=o("CLoadingTripInfo"),u=o("CTripInfo");return s(),n("div",Rt,[e(a,{title:t.trip.details.name.valueOf(),description:t.trip.details.description.valueOf(),type:"article"},null,8,["title","description"]),Ot,t.trip.ID===-1?(s(),_(r,{key:0})):(s(),_(u,{key:1,trip:t.trip,editable:t.owner},null,8,["trip","editable"]))])}const Pt=y({components:{CHead:V,CLoadingTripInfo:pt,CTripInfo:St},data(){return{inputID:"",trip:new h,owner:!1}},beforeMount(){v.init()},async mounted(){await this.init()},methods:{async init(){const t=m.paramID();if(t===void 0){this.$data.trip=new h,await L.genRedirectTo(E.trip_Search);return}if(this.$data.inputID=t,this.$data.trip=await m.genTrip(Number(t)),this.$data.trip.ID!==-1){this.$data.owner=m.getIsCurrentUser(this.$data.trip.user.ID.valueOf());return}v.notifyTrigger("Error","Trip not found.",X.ERROR),await L.genRedirectTo(E.trip_Search)}}});var Jt=w(Pt,[["render",Vt]]);export{Jt as default};
