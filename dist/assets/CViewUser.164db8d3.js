import{a as $}from"./CPlaces.a47b838a.js";import{C as L}from"./CShare.0ed777e5.js";import{C as U,a as E}from"./CLoadingTripPreviewCard.f2401070.js";import{r as a,o as t,c as s,e as f,t as h,l as r,h as l,w as i,i as n,a as o,F as m,g as _,p as N,b as P,d as R,N as B,q as S,bf as b,G as A,R as I,k as g,j as V,_ as D}from"./index.7eb2ba00.js";import{T as O}from"./TripUtil.cf3da4e6.js";import{N as q}from"./Alert.54d61180.js";const G=e=>(N("data-v-cf9cf05c"),e=e(),P(),e),j={class:"view_user"},F={class:"userInfo narrow_content"},M={key:0,class:"userName left_col"},z={key:1,class:"userBio"},H={class:"externalLink"},J={key:3,class:"userInfoButtonGroups"},K=n("Logout"),Q=n("Edit"),W={key:0,class:"viewUserTrips"},X=G(()=>f("h2",null,"Trips",-1)),Y={key:2,class:"createTripAlertDiv"},Z=n("Seems like you have not shared any of your own trips."),x=n("Create New Trip");function ee(e,d,p,se,re,ae){const y=a("CExternalLink"),C=a("CShare"),u=a("n-button"),v=a("n-divider"),k=a("CLoadingTripPreviewCard"),w=a("CTripPreviewCard"),T=a("n-alert");return t(),s("div",j,[f("div",F,[e.showName?(t(),s("h2",M,h(e.user.details.name),1)):r("",!0),e.user.details.bio!==""?(t(),s("p",z,h(e.user.details.bio),1)):r("",!0),f("div",H,[e.user.details.link!==""?(t(),l(y,{key:0,underline:"hover",url:e.user.details.link.valueOf()},{default:i(()=>[n(h(e.user.details.link),1)]),_:1},8,["url"])):r("",!0)]),e.self?(t(),l(C,{key:2,shareURL:e.shareURL,onClick:e.onShare},null,8,["shareURL","onClick"])):r("",!0),e.self?(t(),s("div",J,[o(u,{class:"myAccountLogout left_col",type:"error",onClick:e.logout},{default:i(()=>[K]),_:1},8,["onClick"]),o(u,{class:"myAccountEdit right_col",type:"default",ref:"edit",onClick:e.toggleEdit},{default:i(()=>[Q]),_:1},8,["onClick"])])):r("",!0)]),o(v,{class:"viewUserDivider"}),e.loading||e.self||!e.tripsEmpty?(t(),s("div",W,[X,e.loading?(t(),s(m,{key:0},_(5,c=>o(k,{key:c,wide:!0,"limit-height":!1})),64)):(t(!0),s(m,{key:1},_(e.trips,c=>(t(),l(w,{trip:c,wide:!0,"limit-height":!1},null,8,["trip"]))),256)),e.self&&e.tripsEmpty?(t(),s("div",Y,[o(T,{class:"createTripAlert",type:"default","show-icon":!1},{default:i(()=>[Z,e.confirmed?(t(),l(u,{key:0,class:"createTripButton",type:"info",onClick:e.newTrip,size:"large"},{default:i(()=>[x]),_:1},8,["onClick"])):r("",!0)]),_:1})])):r("",!0)])):r("",!0)])}const te=R({name:"CViewUser",components:{CExternalLink:$,CShare:L,CTripPreviewCard:U,NAlert:q,NButton:B,NDivider:S,CLoadingTripPreviewCard:E},props:{user:{type:b,required:!0},showName:{type:Boolean,default:!0},self:{type:Boolean,default:!1},confirmed:{type:Boolean,default:!1}},emits:{logout(){return!0},toggleEdit(){return!0}},data:()=>({trips:[],lastPopulated:[],tripsEmpty:!0,loading:!0,shareURL:""}),async beforeMount(){await this.genPopulateTrips()},async beforeUpdate(){await this.genPopulateTrips()},methods:{compareArray(e,d){if(e.length!==d.length)return!1;for(let p in e)if(e[p]!==d[p])return!1;return!0},async genPopulateTrips(){if(this.$data.loading=!0,this.compareArray(this.$data.lastPopulated,this.$props.user.trips)){this.$data.loading=!1;return}this.$data.trips=await Promise.all(this.$props.user.trips.map(async e=>await A.genTrip(e.ID.valueOf()))),O.sortTripsMostRecentlyUpdated(this.$data.trips),this.$data.tripsEmpty=this.$data.trips.length<=0,this.$data.lastPopulated=this.$props.user.trips,this.$data.loading=!1},logout(){this.$emit("logout")},toggleEdit(){this.$emit("toggleEdit")},async newTrip(){await I.genRedirectTo(g.trip_New)},onShare(){let e=this.$props.user.details.username.valueOf();e===""&&(e=this.$props.user.details.ID.toString()),this.$data.shareURL=V.getAbsoluteURL(g.User,e)}}});var ue=D(te,[["render",ee],["__scopeId","data-v-cf9cf05c"]]);export{ue as C};
